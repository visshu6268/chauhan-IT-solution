var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.Word=function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=80)}([function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return a}));var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var r=function(){return(r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function s(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{a(i.next(e))}catch(e){r(e)}}function c(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((i=i.apply(e,t||[])).next())}))}function c(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function c(c){return function(a){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;r&&(r=0,c[0]&&(s=0)),s;)try{if(n=1,i&&(o=2&c[0]?i.return:c[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,c[1])).done)return o;switch(i=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,i=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){s=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){s.label=c[1];break}if(6===c[0]&&s.label<o[1]){s.label=o[1],o=c;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(c);break}o[2]&&s.ops.pop(),s.trys.pop();continue}c=t.call(e,s)}catch(e){c=[6,e],i=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,a])}}}function a(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}Object.create,Object.create},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.O=0]="msoulscat_ES_EWAJS",e[e._=1]="msoulscat_ES_EWAJSGrid",e[e.A=6]="msoulscat_ES_EWAJSChart",e[e.P=202]="msoulscat_MSOSP_FileMenuCommands",e[e.U=220]="msoulscat_MSOSP_AddInCommands",e[e.R=225]="msoulscat_MSOSP_OTelJS",e[e.F=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.N=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.H=301]="msoulscat_Wac_WordViewer",e[e.J=306]="msoulscat_Wac_BrowserGeneral",e[e.B=320]="msoulscat_Wac_TaskPane",e[e.K=339]="msoulscat_Wac_OneNoteGeneral",e[e.Z=340]="msoulscat_Wac_Ribbon",e[e.X=356]="msoulscat_Wac_WacFeedback",e[e.$=379]="msoulscat_Wac_WopiPendingApplication",e[e.Y=383]="msoulscat_Wac_Telemetry",e[e.ee=391]="msoulscat_Wac_WacCatchUpActivities",e[e.te=394]="msoulscat_Wac_Dictation",e[e.ne=395]="msoulscat_Wac_OneNoteSync",e[e.ie=700]="msoulscat_Wac_VisioApp",e[e.oe=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.re=800]="msoulscat_Wac_PptAnimation",e[e.se=833]="msoulscat_Wac_PptLive",e[e.ce=834]="msoulscat_Wac_PptMWeb",e[e.ue=835]="msoulscat_Wac_PptGc2General",e[e.de=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.fe=837]="msoulscat_Wac_PptGc2Operation",e[e.le=844]="msoulscat_Wac_PptDataSync",e[e.he=848]="msoulscat_Wac_PptFluidRuntime",e[e.pe=815]="msoulscat_Wac_PptShape",e[e.ve=817]="msoulscat_Wac_PptSession",e[e.be=830]="msoulscat_Wac_PptSlideshow",e[e.me=822]="msoulscat_Wac_PptView",e[e.we=846]="msoulscat_Wac_PptVideos",e[e.Oe=1303]="msoulscat_Uci_Insights",e[e.ge=2300]="msoulscat_Wac_VersionHistory",e[e.je=302]="msoulscat_Wac_WordPresence",e[e.Se=3e3]="msoulscat_Wac_OAuth",e[e.Ie=3005]="msoulscat_Wac_WordVersionHistory",e[e._e=3006]="msoulscat_Wac_LivePersonaCard",e[e.Te=3012]="msoulscat_Wac_CatchUpFlyout",e[e.ye=3016]="msoulscat_Wac_WordDesigner",e[e.Ce=3021]="msoulscat_Wac_ModernFontPicker",e[e.Ae=3027]="msoulscat_Wac_UnifiedUiHost",e[e.Pe=3033]="msoulscat_Wac_EquationTools",e[e.Ee=1401]="msoulscat_Osf_Latency",e[e.Ue=1402]="msoulscat_Osf_Notification",e[e.We=1403]="msoulscat_Osf_Runtime",e[e.Re=3041]="msoulscat_Wac_AiMaker",e[e.Fe=3043]="msoulscat_Wac_AiRewrite",e[e.ke=3044]="msoulscat_Wac_AiInsert",e[e.Ne=3047]="msoulscat_Wac_AiSummarize",e[e.Me=3048]="msoulscat_Wac_CopilotCompose",e[e.xe=3049]="msoulscat_Wac_Skittles",e[e.De=3050]="msoulscat_Wac_CopilotChat",e[e.Ve=3051]="msoulscat_Wac_Syntex",e[e.He=3052]="msoulscat_Wac_WireGraph",e[e.Je=3053]="msoulscat_Wac_CshCopilot",e[e.Be=3054]="msoulscat_Wac_CopilotComposeLaunchpad",e[e.Le=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.ze=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.Ge=3057]="msoulscat_Wac_CopilotCursor"}(i||(i={}))},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(i||(i={}))},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.BrowserEvent="BrowserEvent",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.PageChanged="PageChanged",e.ZoomChanged="ZoomChanged",e.ContentRefreshBegin="ContentRefreshBegin",e.ContentRefreshEnd="ContentRefreshEnd",e.AppClosed="UI_Close",e.UserEdit="Edit_Notification",e.FileRename="File_Rename",e.FileShare="UI_Sharing",e.ShowFileVersions="UI_FileVersions",e.UIWorkflow="UI_Workflow",e.IsDisabled="IsDisabled",e.AccessibilityLoopComplete="App_AccessibilityLoopComplete",e.Unloaded="Unloaded",e.Disposed="Disposed",e.SwitchMode="App_SwitchMode",e.DocumentReboot="DocReboot",e.WopiInfoFromUrl="WopiInfoFromUrl",e.DavUrlFromIds="DavUrlFromIds",e.ModeSwitched="ModeSwitched",e.CreateNewDocument="App_CreateNewDocument",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.SetOverlayContent="SetOverlayContent",e.MoveToFolder="MoveToFolder",e.SharedFilePicker="SharedFilePicker"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return a})),n.d(t,"j",(function(){return u})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return v}));var i=n(7),o="/we/",r="wordeditorframe.aspx",s=o+r,c="wordeditorstartsession.ashx",a="/wv/",u="wordviewerframe.aspx",d=a+u;function f(e){return e.indexOf("word-edit")>-1||e.toLowerCase().indexOf(r)>0}function l(e){return e.toLowerCase().indexOf(u)>0}function h(e,t){void 0===t&&(t=!1);var n=e;return n=(n=n.replace(new RegExp("word-edit","i"),"word-view")).replace(new RegExp(s,"i"),d),t&&(n=Object(i.b)(n,"WordEditorFailedToLoad","1")),n}function p(e){var t=e;return(t=t.replace(new RegExp("word-view","i"),"word-edit")).replace(new RegExp(d,"i"),s)}function v(e){var t,n;if(!e)return{AppMode:"Unknown",AppModeExtended:"Unknown"};var o=e.appUrl,r=f(o),s=e.appContext.isUnifiedRead,a=(null===(t=e.bootParams)||void 0===t?void 0:t.isNewFile)?e.bootParams.isNewFile:Object(i.p)(o,"new"),u=!!(null===(n=e.ui)||void 0===n?void 0:n.uiEmbed)&&e.ui.uiEmbed,d=!e.wopi||e.wopi&&!s;return r?a?d||function(e){return e.toLowerCase().indexOf(c)>0}(o)?{AppMode:"Unified",AppModeExtended:"UNIFIED_NEW"}:{AppMode:"Edit",AppModeExtended:"EDIT_NEW"}:s?{AppMode:"Unified",AppModeExtended:"UNIFIED_READ"}:{AppMode:"Unified",AppModeExtended:"UNIFIED_EDIT"}:u?{AppMode:"View",AppModeExtended:"EMBED_VIEW"}:{AppMode:"View",AppModeExtended:"VIEW"}}},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"t",(function(){return r})),n.d(t,"s",(function(){return s})),n.d(t,"n",(function(){return c})),n.d(t,"o",(function(){return a})),n.d(t,"m",(function(){return u})),n.d(t,"u",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return v})),n.d(t,"q",(function(){return b})),n.d(t,"d",(function(){return m})),n.d(t,"k",(function(){return w})),n.d(t,"b",(function(){return O})),n.d(t,"r",(function(){return g})),n.d(t,"w",(function(){return j})),n.d(t,"j",(function(){return S})),n.d(t,"v",(function(){return I})),n.d(t,"p",(function(){return _})),n.d(t,"l",(function(){return T})),n.d(t,"g",(function(){return y}));var i=["eurppc"],o="AppSettingsHandler.ashx",r="RemoteUls.ashx",s="RemoteTelemetry.ashx";function c(e){return 8===e.toLowerCase().indexOf("ffc")}function a(e){return 8===e.toLowerCase().indexOf("ppc")}function u(e){var t=e.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return t&&t[1]?t[1]:"public"}function d(e,t){if(!t||-1===i.indexOf(t.toLowerCase()))return e;var n=e.match(/(^http[s]:\/\/)((?!word)\w*[-])?(.*)/i);return n?"".concat(n[1]).concat(t,"-").concat(n[3]):e}function f(e){var t=e.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}function l(e,t){var n=e.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!n)throw new Error("Invalid URL");var i=n[2];if(void 0===t)return i;if(t<0)throw new Error("subDomainParts should be at least 1");return i.split(".").slice(-(t+1)).join(".")}function h(e){return e+r}function p(e,t){return e+s+(t?"?usid="+t:"")}function v(e,t,n){n&&(e[t.toLowerCase()]=n)}function b(e,t){e[t.toLowerCase()]=""}function m(e,t,n){var i=[];for(var o in n)n[o]&&i.push(o+"="+n[o]);return e+t+(i.length>0?"?"+i.join("&"):"")}function w(e,t){var n=e.toLowerCase(),i=t.toLowerCase(),o=n.indexOf("&"+i+"=");if(-1===o&&(o=n.indexOf("?"+i+"=")),-1===o)return"";var r=o+(t.length+2),s=e.indexOf("&",r);return e.substring(r,-1===s?void 0:s)}function O(e,t,n,i){if(!n)return e;var o=e,r=o.indexOf("?"),s="&";r===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?s="":-1===r&&(s="?");var c=t.toLowerCase()+"=",a=new RegExp("\\W"+c,"i").exec(o);if("?"!==s&&a){if(i){var u=a.index+1,d=o.indexOf("&",u);o=o.substring(0,u)+c+n+(-1===d?"":o.substring(d))}return o}return o.concat(s,c,n)}function g(e){var t={},n=e.indexOf("?");return-1===n||n===e.length-1||e.substring(n+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(e){if(e){var n=e.indexOf("=");-1!==n&&n!==e.length-1&&(t[e.substring(0,n).toLowerCase()]=e.substring(n+1))}})),t}function j(e,t){if(!e)return e;var n=e,i=n.indexOf("?"),o=t.toLowerCase()+"=",r=n.toLowerCase().indexOf(o,i);if(r>=0){var s=n.indexOf("&",r);return"&"===(n=n.substring(0,r)+(-1===s?"":n.substring(s+1))).slice(-1)&&(n=n.slice(0,-1)),n}return e}function S(e){if(!e)return"";var t=-1===e.indexOf("#")?e.length:e.indexOf("#"),n=e.lastIndexOf("/",t);if(-1!==n&&n+1===e.indexOf("://")+"://".length)return"";n+=1;var i=e.indexOf("?");if(-1!==(i=i>=t?-1:i)&&n>i)return"";var o=-1===i?t:i;return n>=o?"":e.substring(n,o)}function I(e){var t=new RegExp("(c[1-5])h?(-)");return e.replace(t,"$1h$2")}function _(e,t,n){var i=new RegExp("[?&]"+t+"=("+(n||"1")+")\\b","i"),o=e.match(i);return!(!o||n&&o[1]!==n)}function T(e,t){var n=w(e,t);return n?decodeURI(n):n}function y(e){return e?e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0]:""}},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.qe="App_AccessibilityLoopComplete",e.Ke="Wac_ActionComplete",e.Ze="WacInitialize_Ready",e.Xe="Wac_AppFailed",e.$e="Wac_AppBootState",e.Qe="Wac_AppCompleted",e.Ye="BrowserEvent",e.et="UI_Close",e.tt="App_CloseTab",e.nt="UI_Conversation",e.it="UI_CopyAndEdit",e.ot="App_CreateNewDocument",e.rt="Wac_AppDataSavedStatus",e.st="UI_Download",e.ct="UI_Edit",e.ut="Error",e.dt="UI_FileEmbed",e.ft="UI_FileProperties",e.lt="File_Rename",e.ht="File_RenameFailed",e.pt="UI_FileVersions",e.vt="StateChanged",e.bt="App_IsFrameTrusted",e.wt="GetAccessToken",e.Ot="App_GetAuthToken",e.gt="App_GetCustomAuthConfig",e.jt="App_GetHostKeyValue",e.St="App_WopiInfoFromUrl",e.It="App_DavUrlFromIds",e._t="App_LoadingStatus",e.Tt="App_SwitchMode",e.yt="App_MoveToFolder",e.Ct="UI_OpenInMobileApp",e.At="UI_OpenInBrowser",e.Pt="UI_OpenInClient",e.Et="PageChanged",e.Ut="App_PushCommentContext",e.Wt="App_PushState",e.Rt="App_DocReboot",e.Ft="UI_RedeemForCommenting",e.kt="App_RefreshSessionInfo",e.Nt="UI_ReplyWithChanges",e.Mt="UI_ReportAbuse",e.xt="App_FilePicker",e.Dt="UI_SaveStatus",e.Vt="WopiSession_Complete_Ack",e.Ht="SetOverlayContent",e.Jt="UI_Sharing",e.Bt="UI_ShareForm",e.Lt="UI_SignIn",e.zt="App_StoreHostKeyValue",e.Gt="App_Unloaded",e.qt="App_UlsLog",e.Kt="Wac_UnloadingApp",e.Zt="App_UpdateBootComplete",e.Xt="PageCount",e.$t="UI_CheckUserAccessAndGrantPermissions",e.Qt="User_Activity",e.Yt="Edit_Notification",e.en="UI_Workflow",e.tn="ZoomChanged",e.nn="CAAEMessage",e.in="Excel_HostFrameCacheSave",e.on="Excel_HostFrameCacheEvict",e.rn="Excel_RegenerateFileBundle",e.sn="App_SwitchToWacFrame",e.cn="App_SaveSSRData",e.an="App_PurgeDataInHostCache",e.un="App_SaveHostRenderingV2Data",e.dn="App_SaveHostUtilsData",e.fn="AcquireOAuthTokenTeams",e.ln="App_SwitchNotebook",e.hn="FailedBoot_CheckFileInfo",e.pn="GetTeamsUsers",e.vn="SendTeamsUserMention",e.bn="NavigateBackToHost",e.mn="App_GetClientUrlComplete",e.wn="App_GetWebUrlComplete",e.On="App_CopyLinkComplete",e.gn="App_SendConversationId",e.jn="CloseTeamsConversation",e.Sn="PageLoaded",e.In="Visio_BRS",e._n="Visio_SendLicenseInfo",e.Tn="Visio_Consumption_CLTComplete",e.yn="Visio_SwitchMode_FromViewFrame",e.Cn="Visio_ModeSwitch_ToHost_Ack",e.An="Visio_UpdateEditUrl",e.Pn="Visio_PageViewLoaded",e.En="Visio_ActiveAppFrameLoadFailed",e.Un="Visio_DisposeBkgFrame",e.Wn="Visio_ReadyToReceiveDocData",e.Rn="Visio_DocReboot_HostNav",e.Fn="Visio_SwitchToVisioFrame",e.kn="WacAppPerfMetric",e.Nn="App_ModifyURLState",e.Mn="App_WacTokenAck",e.xn="App_InitEnd",e.Dn="App_SplashScreenShown",e.Vn="App_SetWacFlightValue"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));var i=n(0);function o(e){if(e){var t=e.lastIndexOf(".");if(-1!==t)return e.substring(t+1).toLowerCase()}return""}function r(e){if(!e)return"";var t=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(Object.getPrototypeOf(e));return JSON.stringify(e,Object(i.e)(Object(i.e)([],t,!0),n,!0))}},,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return l})),function(e){e[e.Firefox=0]="Firefox",e[e.Opera=1]="Opera",e[e.IE=2]="IE",e[e.Edge=3]="Edge",e[e.Chrome=4]="Chrome",e[e.Safari=5]="Safari",e[e.TeamsElectron=6]="TeamsElectron",e[e.Unknown=7]="Unknown"}(i||(i={}));var o=window.navigator,r=o?o.userAgent:void 0;function s(){if(r){if(r.indexOf("Firefox")>-1)return i.Firefox;if(r.indexOf("Opera")>-1||r.indexOf("OPR")>-1)return i.Opera;if(r.indexOf("Trident")>-1)return i.IE;if(r.indexOf("Electron")>-1&&r.indexOf("Teams")>-1)return i.TeamsElectron;if(r.indexOf("Edg")>-1)return i.Edge;if(r.indexOf("Chrome")>-1)return i.Chrome;if(r.indexOf("Safari")>-1)return i.Safari}return i.Unknown}function c(){try{return!!r&&r.indexOf("iPad")>=0||!!r&&r.indexOf("Macintosh")>=0&&h()&&!(r&&r.indexOf("iPhone")>=0)||!!r&&r.indexOf("Android")>=0||h()}catch(e){return!1}}function a(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(e){return!1}}function u(){return s()===i.IE&&!(s()===i.IE&&null!=document.documentMode&&void 0!==document.documentMode&&document.documentMode>=11)}function d(){return s()===i.IE}function f(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(e){return!1}}function l(){try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){return!1}}function h(){return!!o&&o.maxTouchPoints>0}},,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.AppInitError="AppInitError",e.ApiDisabledError="ApiDisabledError",e.CannotLoadFirstPage="CannotLoadFirstPage",e.InvalidWopiInfo="InvalidWopiInfo",e.TimeoutWacReady="TimeoutWacReady",e.WacFailed="WacFailed"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return h}));var i=n(7),o=n(41),r=n(42),s=n(19),c=n(43),a=n(44),u="Word";function d(e,t){var n=t?"?usid="+t:"";return e+i.s+n}function f(e,t){return d(h(e),t)}function l(e,t,n,f,l,p){void 0===p&&(p=!1),e.SessionInformation.IsCore&&(e.SessionInformation.HideViewerToolbar=!0),function(e,t){var n=e.SessionInformation;if(n.WdParams||(n.WdParams={}),!n.WdParams.wd){t.substring(1).split("&").filter((function(e){if(0===e.indexOf("wd")){var t=e.split("=");t[0].length>2&&(n.WdParams[t[0]]=t[1])}}));var i=e.RebootOverrideData;i&&i.previousSessionId&&(n.WdParams.wdprevioussession=i.previousSessionId)}}(e,window.location.search);var v=l||new o.a(u,n),b=h(e.ApplicationUrl);return{container:e.Container,sessionInformation:e.SessionInformation,applicationUrl:e.ApplicationUrl,wopiPrecheckInfo:e.WopiPrecheckInfo,applicationCustomSettings:e.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:e.Diagnostics,ClientDiagnostics:Object(r.c)(),AppInitDiagnostics:{officeSessionId:t,officeBootstrapperVersion:Object(s.a)(),hostName:e.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:e.FnOnInitializeSuccess,fnOnInitializeFailure:e.FnOnInitializeFailure,sessionId:t,applicationBasePath:b,remoteTelemetryUrl:d(b,t),wopiInfo:e.WopiInfo,forceSingleStepBoot:p,isCreateNew:e.WopiPrecheckInfo.IsNewFile||Object(i.p)(e.ApplicationUrl,"new"),featureManager:f||Object(c.a)(e.FnIsFeatureEnabled,n),Hn:v,newFileTemplateSource:e.NewFileTemplateSource,rebootOverrideData:e.RebootOverrideData,pageStateObserver:new a.a(n,!0),canSupportConsumption:!1}}function h(e){var t=e.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!t)throw new Error("Invalid URL");return t[1]}},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.Jn="BootstrapperMaxUlsHeartbeatTime",e.Bn="BootstrapperNoCompleteWarning1Time",e.Ln="BootstrapperNoCompleteWarning2Time",e.zn="RemoteUlsETag",e.Gn="RemoteUlsSuppressions",e.qn="BootstrapperSettingsFetchPeriod",e.Kn="timestamp",e.Zn="BootstrapperUlsHeartbeatIntervalMs",e.Xn="BootstrapperUlsHeartBeatIsEnabled",e.$n="BootstrapperUlsUploadCadenceMs",e.Qn="WordConsumptionViewToEditRedirectIsEnabled",e.Yn="RequestedCallThrottlingDefaultToViewMinimumValue",e.ei="BulsEndpointUrl",e.ti="EnableCommonHostDiagnosticsParams",e.ni="EnableICNForWord",e.ii="EnableModernEmbedViewForPowerPoint",e.oi="EnableModernEmbedViewInOneUpForPowerPoint",e.ri="EnableModernEmbedViewForPowerPointGlobalAppUrl",e.si="EnableModernReadingViewForPowerPoint",e.ci="EnableDefaultToModernForPowerPoint",e.di="ShouldLogJsApiKpisForWord",e.fi="WordSwitchToViewInTeamsJsapiV1Enabled",e.li="EnableWordSessionRefreshTelemetry",e.hi="PowerPointUseEssDCHint",e.pi="ModernEmbedViewBootstrapperFeatureGatesForPowerPoint",e.vi="ModernReadingViewBootstrapperFeatureGatesForPowerPoint",e.bi="ModernEmbedViewForPowerPointEnabledPercentage",e.mi="PowerPointESSCookieLookbackThresholdHour",e.wi="PowerPointSetESSCookieLookbackExpEnabled",e.Oi="ExcelForceViewOnlyInTeamsJsapiV1"}(i||(i={}))},function(e,t,n){"use strict";function i(){return window.performance.now()}function o(){return Math.round(window.performance.now()+window.performance.timeOrigin)}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.gi="Ack",e.ji="WacInitialize_Ready_Ack",e.Si="Wac_BeforeUnloadApp",e.Ii="Blur_Focus",e._i="Wac_AppFailed_Ack",e.Ti="Wac_AppCompleted_Ack",e.yi="WopiStartSession_Complete",e.Ci="WopiPendingSession_Complete",e.Ai="Host_AccessibilityLoopComplete",e.bt="Host_IsFrameTrusted",e.Pi="Grab_Focus",e.Ei="HostCacheDiagnostic",e.Ui="Host_KeyValue",e.Wi="JsApiDiagnostics",e.yt="Host_MoveToFolder",e.Ri="PageChanged_Ack",e.Fi="App_PopState",e.ki="Host_SendChannelId",e.Ni="Host_SendConversationId",e.Mi="GetTeamsUsers_Reply",e.xi="SendTeamsUserMention_Reply",e.Di="Host_BackButtonPressed",e.Vi="Host_GetClientUrl",e.Hi="Host_GetWebUrl",e.Ji="File_Rename",e.xt="Host_FilePicker",e.Bi="PostAccessToken",e.Li="Host_SetAuthToken",e.zi="Host_SetCustomAuthConfig",e.Gi="App_PushCommentContext",e.qi="CanEmbed",e.Ki="Host_RefreshSessionInfo",e.Zi="CheckUserAccessAndGrantPermissions_Result",e.Xi="Host_WopiInfoFromUrl",e.$i="Host_DavUrlFromIds",e.Qi="SetCurrentPage",e.Yi="SetZoomLevel",e.eo="WopiPendingSession_Fail",e.to="SetOverlayContent",e.no="WopiPendingApplicationComplete_Received",e.io="Host_SwitchMode",e.oo="Host_Unload",e.ro="PageCount_Ack",e.so="ZoomChanged_Ack",e.co="Host_ShareUI",e.ao="Host_Telemetry",e.uo="Visio_ConsumptionCLTComplete_Ack",e.do="Visio_SwitchMode_FromHF_Ack",e.fo="Visio_SwitchMode_FromHostFrame",e.lo="Visio_FallbackToLegacySwitch",e.ho="Visio_DocumentData",e.po="Host_PostWacToken"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c}));var i,o=365;function r(e,t){var n=s(e);return"true"===n||"false"!==n&&t}function s(e){if(!e)return"";var t=""+document.cookie,n=new RegExp("(?:^|; )"+e+"=([^;]*)"),i=t.match(n);return!i||i.length<2?"":i[1]}function c(e,t,n,r,s){void 0===r&&(r=i.none);var a=e+"="+t,u="",d=new Date;d.setTime(d.getTime()+864e5*o);var f=new Date;f.setTime(f.getTime()+864e5*n),f>d&&(f=d),f&&(u=";expires="+f.toUTCString());var l=a+u+";SameSite="+i[r];return document.cookie=s?l+"; Secure":l,!(!document.cookie||-1===document.cookie.indexOf(a))||r===i.none&&c(e,t,n,i.doNotSet,s)}!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));var i={BUILD_NUMBER:"###VERSION###",BUILD_NUMBER_MINOR:-1};function o(e){if(e&&(i.BUILD_NUMBER=e,e.includes("."))){var t=e.split(".");i.BUILD_NUMBER_MINOR=parseInt((t[0]||"").concat((t[1]||"").padStart(3,"0")),10)}}function r(){try{return i.BUILD_NUMBER}catch(e){return i.BUILD_NUMBER}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return l}));var i=n(1),o=n(2),r=n(16),s=n(8),c=n(17),a=n(9),u=!1,d=!1;function f(){u=!1}function l(e,t,n,a,f,l,p){if(t.ULS.vo(595714433,i.a.$,o.a.Info,"Starting disposing the application. unloadApp:".concat(e,"; disposed:").concat(u,"; unloading:").concat(d)),u||d&&e)t.ULS.vo(595714908,i.a.$,o.a.Info,"Application is already disposed or unloading");else{var v,b={logger:t,postMessenger:n,innerApplicationFrame:a,onDisposed:f,onFrameRemoved:l,unloadTimeoutInMs:p||1e3,forceAppUnload:!1,disposeStartTime:Object(r.a)(),appUnloadTimedOut:!1};if(e&&a)return d=!0,b.forceAppUnload=!0,(v=b).forceAppUnloadStartTime=Object(r.a)(),v.logger.ULS.vo(595855490,i.a.$,o.a.Info,"Sending postmessage to unload app"),v.logger.ULS.flush(),v.postMessenger.registerMessagePayloadHandler(s.a.Gt,(function(e){return function(e,t){e.forceAppUnloadEndTime=Object(r.a)(),e.appUnloadedMessageValues=t,e.logger.ULS.vo(595855491,i.a.$,o.a.Info,"AppUnloaded received from app"),h(e)}(v,e)})),v.postMessenger.sendPostMessage(v.innerApplicationFrame,c.a.oo,{}),void window.setTimeout((function(){return function(e){!d&&u||(e.appUnloadTimedOut=!0,e.logger.ULS.vo(595855492,i.a.$,o.a.Info,"ApplicationUnload timed out, forcing dispose"),h(e))}(v)}),v.unloadTimeoutInMs);h(b)}}function h(e){if(!u)try{u=!0,d=!1,function(e){e.innerApplicationFrame&&(e.innerApplicationFrame.src="about:blank",window.setTimeout((function(){e.innerApplicationFrame&&e.innerApplicationFrame.parentElement&&e.innerApplicationFrame.parentElement.removeChild(e.innerApplicationFrame),e.onFrameRemoved&&e.onFrameRemoved()}),0))}(e),function(e){var t={disposeStartTime:e.disposeStartTime,disposeEndTime:Object(r.a)(),forceAppUnload:e.forceAppUnload,appUnloadTimedOut:e.appUnloadTimedOut};if(e.forceAppUnloadStartTime&&(t.appUnloadStartTime=e.forceAppUnloadStartTime),e.forceAppUnloadEndTime&&(t.appUnloadEndTime=e.forceAppUnloadEndTime),e.appUnloadedMessageValues){var n=e.appUnloadedMessageValues,s=Number(n.hostMessageReceived);e.forceAppUnloadStartTime&&!isNaN(s)&&(t.hostToAppPostMessageLatency=s-e.forceAppUnloadStartTime);var c=Number(n.appMessageSent);!isNaN(c)&&e.forceAppUnloadEndTime&&(t.appToHostPostMessageLatency=e.forceAppUnloadEndTime-c);var a=Number(n.appUnloadStart),u=Number(n.appUnloadEnd);if(isNaN(a)||isNaN(u)||(t.appUnloadLatency=u-a),n.serverTimings){var d=n.serverTimings;for(var f in d)t["st-"+f.toString()]=d[f]}}e.logger.ULS.vo(595855436,i.a.$,o.a.Info,"App disposed "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(e),e.onDisposed&&e.onDisposed()}catch(t){e.logger.ULS.vo(595714434,i.a.$,o.a.Error,"Error disposing: ".concat(Object(a.b)(t)))}}},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.bo="EnterpriseTemplates",e.mo="ExcelAdaptiveLayoutDownload",e.wo="ExcelLandingPageOfflineTelemetry",e.Oo="ExcelLandingPageObserverRetry",e.jo="H2StaticContent",e.So="HashedUrl",e.Io="ODCShareLinkPreload",e._o="OfficeComExcelJsApiV2",e.To="OfficeComPptJsApiV2",e.yo="OfficeComUiHost",e.Co="OfficeComWordJsApiV2",e.Ao="OfficeHwaUiHost",e.Po="OfficeUnifiedUiHostTeams",e.Eo="WordViewToUnifiedRead",e.Uo="PowerPointEarlySessionStart"}(i||(i={}))},,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.Wo="ClassicViewModePreference"}(i||(i={}))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return p}));var i=n(8),o=n(1),r=n(2),s=n(9),c=n(17),a=n(45),u=n(19),d=n(3),f=n(20),l=n(14),h=function(){function e(e,t,n,u,l){var h=this;this.Ro={},this.Fo=function(){h.ko.registerMessagePayloadHandler(i.a.Rt,h.No),h.ko.registerMessagePayloadHandler(i.a.St,h.Mo),h.ko.registerMessagePayloadHandler(i.a.It,h.xo),h.ko.registerMessagePayloadHandler(i.a.Ot,h.Do),h.ko.registerMessagePayloadHandler(i.a.Jt,h.Vo),h.ko.registerMessagePayloadHandler(i.a.gt,h.Ho),h.ko.registerMessagePayloadHandler(i.a.yt,h.Jo),h.ko.registerMessagePayloadHandler(i.a.xt,h.Bo)},this.Lo=function(e,t){var n=h.Ro[e];if(n)try{n(t||{})}catch(e){h.zo.ULS.vo(593773706,o.a.$,r.a.Error,"Handler error: ".concat(Object(s.b)(e)))}},this.No=function(e){e.previousSessionId=h.Go,h.Lo(d.a.DocumentReboot,e)},this.Mo=function(e){h.Lo(d.a.WopiInfoFromUrl,e)},this.xo=function(e){h.Lo(d.a.DavUrlFromIds,e)},this.Do=function(e){Promise?h.qo.isResourceTrustedForMessage(e).then((function(t){t?h.Lo(d.a.GetAuthToken,e):h.ko.sendPostMessage(h.Ko,c.a.Li,{AuthToken:"",Error:"accessDenied",RequestId:e.RequestId,IdentityType:e.IdentityType})}),(function(){h.ko.sendPostMessage(h.Ko,c.a.Li,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:e.RequestId,IdentityType:e.IdentityType})})):h.ko.sendPostMessage(h.Ko,c.a.Li,{AuthToken:"",Error:'"Promise" does not exist natively in browser',RequestId:e.RequestId,IdentityType:e.IdentityType})},this.Vo=function(e){h.Lo(d.a.FileShare,e)},this.Ho=function(e){h.Lo(d.a.GetCustomAuthConfig,e)},this.Jo=function(e){h.Lo(d.a.MoveToFolder,e)},this.Bo=function(e){h.Lo(d.a.SharedFilePicker,e)},this.Go=e,this.zo=t,this.Ko=l.innerApplicationFrame,this.ko=n,this.Zo=u,this.qo=new a.a(t),this.Fo(),Object(f.b)()}return e.prototype.GetApplicationType=function(){return l.a},e.prototype.GetVersion=function(){return Object(u.a)()},e.prototype.GetSessionId=function(){return this.Go},e.prototype.RegisterEventHandler=function(e,t){switch(e){case d.a.Unloaded:case d.a.Disposed:case d.a.DocumentReboot:case d.a.WopiInfoFromUrl:case d.a.DavUrlFromIds:case d.a.GetAuthToken:case d.a.GetCustomAuthConfig:case d.a.MoveToFolder:case d.a.SharedFilePicker:case d.a.SetOverlayContent:case d.a.FileShare:if(this.Ro[e])throw new Error("Duplicate registration");this.Ro[e]=t;break;default:this.ko.registerMessagePayloadHandler(e,t)}},e.prototype.RemoveEventHandler=function(e,t){switch(e){case d.a.Unloaded:case d.a.Disposed:case d.a.DocumentReboot:case d.a.FileShare:case d.a.WopiInfoFromUrl:case d.a.DavUrlFromIds:case d.a.GetAuthToken:case d.a.GetCustomAuthConfig:case d.a.MoveToFolder:case d.a.SharedFilePicker:case d.a.SetOverlayContent:if(this.Ro[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Ro[e];break;default:this.ko.removeMessageHandler(e)}},e.prototype.RegisterErrorHandler=function(e){},e.prototype.RemoveErrorHandler=function(e){},e.prototype.PostCommand=function(e,t){this.ko.postMessageForCommand(this.Ko,e,t)},e.prototype.Dispose=function(e,t){var n=this;Object(f.a)(e||!1,this.zo,this.ko,this.Ko,(function(){delete n.Ko,n.Zo(),n.ko.dispose(),n.Lo(d.a.Unloaded,{})}),(function(){try{n.Lo(d.a.Disposed,{}),n.Ro={}}catch(e){n.zo.ULS.vo(589108815,o.a.$,r.a.Error,"onFrameRemoved error: ".concat(Object(s.b)(e)))}}),t)},e}();function p(e,t,n,i,o){return new h(e,t,n,i,o)}},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.Unknown="UNKNOWN",e.Initialized="INITIALIZED",e.Prebooted="PREBOOTED",e.Booting="BOOTING",e.Booted="BOOTED",e.Failed="FAILED",e.Disposing="DISPOSING",e.Disposed="DISPOSED"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(7);function o(e,t){return void 0===e&&(e=!1),{shouldPreconnect:function(e){return r&&(!t||t(e))},preconnect:function(t){return function(e){var t=document.createElement("link");t.rel="preconnect",t.href=e,t.crossOrigin="anonymous",document.head.appendChild(t)}(e?Object(i.v)(t):t)}}}var r=!0},function(e,t,n){"use strict";n.d(t,"a",(function(){return K}));var i=n(0),o=n(1),r=n(2),s=n(7),c=n(19),a=n(55),u=n(56),d=n(16),f=n(64),l=n(8),h=n(15),p=n(21),v=n(9),b=n(42),m=n(17),w=n(63),O=n(20),g=n(13),j=n(14);function S(e,t){t&&t.Diagnostics&&Object.keys(t.Diagnostics).forEach((function(n){return e[n]=t.Diagnostics[n]}))}function I(e,t,n){t.ULS.vo(596459999,o.a.$,n,"SessionTraces: "+JSON.stringify(e))}function _(e,t){t.stop();var n=t.getVisibilityChangeEvents();null!=n&&n.length>0&&(e.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,e.SessionTraces.tabSwitchDiagnostics=JSON.stringify(n)),t.dispose()}function T(e,t,n){try{var a=function(e,t){var n=Object(i.a)({},t);delete n.UserId,delete n.OwnerId,delete n.SiteId,delete n.WebId,delete n.Upn,delete n.TenantId,delete n.UiHostTabId,delete n.OriginalWdParam,delete n.WdParams;var o=n,r=t.WdParams?JSON.parse(JSON.stringify(t.WdParams).toLowerCase()):{};o.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){r[e]&&(o.WdParams[e]=r[e])}));var c=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;return o.WdParams.wdprevioussession&&!c.test(o.WdParams.wdprevioussession)&&delete o.WdParams.wdprevioussession,o.WdParams.wdpreviouscorrelation&&!c.test(o.WdParams.wdpreviouscorrelation)&&delete o.WdParams.wdpreviouscorrelation,o.UiEmbedMode=Object(s.p)(e,"uiembed"),o.UiHostName=Object(s.k)(e,"uih")||"N/A",o.HostDomain=location?location.hostname:"",o}(t.applicationUrl,t.sessionInformation);a.Build=Object(c.a)(),a.Region=Object(s.m)(t.applicationUrl);var u=Object(i.a)({},t.rebootOverrideData);delete u.ackExpected,delete u["ui-language"],delete u.wdUserSession,delete u.rebootMode,delete u.documentUrl,a.RebootOverride=u;var d=t.diagnostics.HostInitDiagnostics;d&&(e.ULS.vo(596444238,o.a.$,r.a.Info,"HostInitDiagnostics: "+JSON.stringify(t.diagnostics.HostInitDiagnostics)),a.SessionOrigin=d.entryPoint),n&&e.ULS.vo(595937313,o.a.$,r.a.Info,JSON.stringify(n));var f=t.wopiInfo;f&&f.AccessToken&&f.AccessTokenExpiry||e.ULS.vo(595894553,o.a.$,r.a.Warning,"There are some missing parameters"),f&&(f.AccessToken&&(a.AccessTokenLength=f.AccessToken.length),a.AccessTokenExpiry=f.AccessTokenExpiry,f.WacToken&&(a.WacTokenLength=f.WacToken.length)),"Microsoft Teams"===t.sessionInformation.HostName&&e.ULS.vo(507122579,o.a.$,r.a.Important,"".concat("Word"," setting Force View only for Teams WXP Files session.")),a.JsApiVersion="v1",e.ULS.vo(596444237,o.a.$,r.a.Info,JSON.stringify({session:a,client:t.diagnostics.ClientDiagnostics}))}catch(t){e.ULS.vo(558155802,o.a.$,r.a.Error,"Failed to log initialization info: ".concat(Object(v.b)(t)))}}var y,C=n(57),A=n(43),P=n(11),E=n(18),U=n(4),W=n(24);function R(e,t,n){void 0===n&&(n=!1);var o=e.applicationUrl,r={};if("Microsoft Teams"===e.sessionInformation.HostName&&(r.fvo="1",e.Hn.getValue(h.a.fi,!1)&&(r.readOnly="1")),r.jsApi="1",r.jsapiver="v1",n&&(r.NewSession="1"),r.corrid=e.sessionId,r.usid=e.sessionId,r.sftc="1",e.applicationCustomSettings&&e.applicationCustomSettings.IsCore&&(r.core="1"),e.sessionInformation.HideViewerToolbar&&(r.hvt="1"),e.sessionInformation.DisableFocusOnBoot&&(r.disableFocusOnBoot="1"),e.sessionInformation.HighContrastMode&&(r.hcm=encodeURIComponent(e.sessionInformation.HighContrastMode)),e.sessionInformation.SupportsAtMentions&&(r.sams="1"),e.sessionInformation.SupportsAccessibilityLoop&&(r.accloop="1"),e.sessionInformation.SupportsDocReboot){var c=e.sessionInformation.SupportsDocReboot;r.sdr=!0===c?"1":c.toString()}return e.sessionInformation.SupportsCreateNewDocument&&(r.scnd="1"),e.sessionInformation.SupportsAuthToken&&(r.sat="1"),e.sessionInformation.SupportsCustomAuthConfig&&(r.cac="1"),e.sessionInformation.SupportsMoveToFolder&&(r.mtf="1"),e.sessionInformation.SupportsCommonFilePicker&&(r.sfp="1"),e.sessionInformation.OpenLinksInNewWindow&&(r.onw="1"),e.sessionInformation.UseDarkTheme&&(r.udt="1"),(e.sessionInformation.HideHeader||"DocGen"===e.sessionInformation.ContentAssemblyMode||"Templatization"===e.sessionInformation.ContentAssemblyMode||"ContentAssemblyEdit"===e.sessionInformation.ContentAssemblyMode||"ContentAssemblyView"===e.sessionInformation.ContentAssemblyMode)&&(r.hhdr="1"),e.sessionInformation.HideAppLauncherInHeader&&(r.halh="1"),e.sessionInformation.HideChatInHeader&&(r.hch="1"),e.sessionInformation.HideMeInHeader&&(r.hmh="1"),e.sessionInformation.HideSearchInHeader&&(r.hsh="1"),e.sessionInformation.HideWorkflowInHeader&&(r.hwfh="1"),e.sessionInformation.HideSettingsInHeader&&(r.hsth="1"),e.sessionInformation.ShowAppIconInHeader&&(r.sih="1"),e.sessionInformation.UseNeutralColorInHeader&&(r.unh="1"),e.sessionInformation.HideBreadCrumbInViewer&&(r.hbcv="1"),e.sessionInformation.HideTitleInViewer&&(r.htv="1"),e.sessionInformation.HideWACOneDriveFileLocationPicker&&(r.hodflp="1"),e.sessionInformation.NoBrowserModalDialogs&&(r.nbmd="1"),e.applicationCustomSettings&&e.applicationCustomSettings.FixDiagnosticsJson&&(r.fixdiag="1"),(e.wopiPrecheckInfo.ReadOnly||t.bootFlowType===y.wordViewToUnifiedReadRedirect)&&(r.readOnly="1"),"DocGen"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.sessionInformation.ContentAssemblyMode||(r.readOnly="1"),t.bootFlowType===y.wordViewToUnifiedReadRedirect&&(r.cons="1"),e.canSupportConsumption&&(r.csc="1"),e.sessionInformation.UIEmbed&&(r.uiEmbed="1"),e.sessionInformation.IsSynthetic&&(r.syn="1"),e.sessionInformation.SupportsDirectDownload&&(r.sdd="1"),e.sessionInformation.SupportsDirectPrint&&(r.sdp="1"),e.sessionInformation.UiHostIntegrationType&&(r.uihit=encodeURIComponent(e.sessionInformation.UiHostIntegrationType)),e.sessionInformation.MetaUiHostVersion&&(r.muv=encodeURIComponent(e.sessionInformation.MetaUiHostVersion)),e.applicationCustomSettings&&e.applicationCustomSettings.InAppDocumentPreview&&(r.InAppDocPreview="1"),t.isSingleStepBoot?(t.bootFlowType===y.unifiedSingleFlush&&(e.isCreateNew||(r.instantedit="1",r.wopicomplete="1")),r.wdRedirectionReason=t.bootFlowType):(r.instantedit="1",r.fileSrc=encodeURIComponent(e.sessionInformation.HostName),r.pmOrigin=encodeURIComponent(Object(s.i)(window.location.href)),e.isCreateNew&&(r.new="1",e.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(r.wdTpl="fromhost"))),e.wopiPrecheckInfo.PreseededSessionKey&&(r.preseededSessionKey=encodeURIComponent(e.wopiPrecheckInfo.PreseededSessionKey)),e.wopiPrecheckInfo.PreseededWacSessionId&&(r.preseededWacSessionId=encodeURIComponent(e.wopiPrecheckInfo.PreseededWacSessionId)),e.wopiPrecheckInfo.RequestedCallThrottling&&(r.rct=e.wopiPrecheckInfo.RequestedCallThrottling),e.wopiPrecheckInfo.ClientThrottlingProtection&&(r.ctp=e.wopiPrecheckInfo.ClientThrottlingProtection),e.applicationCustomSettings&&e.applicationCustomSettings.additionalApplicationParameters&&(r=Object(i.a)(Object(i.a)({},e.applicationCustomSettings.additionalApplicationParameters),r)),e.rebootOverrideData&&e.rebootOverrideData.queryOverrides&&(r=Object(i.a)(Object(i.a)({},r),e.rebootOverrideData.queryOverrides)),function(e,t,n,o,r){var c=Object(s.r)(e);("teams"===c.uih&&"UnifiedUiHostTeams"!==t.UiHostIntegrationType&&"TeamsModern"!==t.UiHostIntegrationType||"owa"===c.uih)&&(c.hhdr="1");var a=e.indexOf("?"),u=-1===a?e.concat("?"):e.substring(0,a+1);t.UiLocale&&(c.ui=encodeURIComponent(t.UiLocale)),t.DataLocale&&(c.rs=encodeURIComponent(t.DataLocale)),t.HostSessionId&&(c.hid=encodeURIComponent(t.HostSessionId)),t.DisableChat&&(c.dchat="1"),t.SessionContext&&(c.sc=encodeURIComponent(t.SessionContext)),n&&n.WopiSrc&&(c.wopisrc=encodeURIComponent(n.WopiSrc)),t.CookieCompliant&&(c.mscc="1"),o&&(o.entryPoint&&(c.wdorigin=encodeURI(o.entryPoint)),o.userClickTime&&(c.wdhostclicktime=o.userClickTime.toString())),c=Object(i.a)(Object(i.a)(Object(i.a)({},c),t.WdParams),r);var d={};for(var f in c)d[f.toLowerCase()]=c[f];var l=[];for(var f in d)d[f]&&l.push(f.concat("=",d[f]));return u.concat(l.join("&"))}(o,e.sessionInformation,e.wopiInfo,e.diagnostics.HostInitDiagnostics,r)}function F(e){return e.AccessTokenExpiry?e.AccessTokenExpiry.getTime().toString():"0"}!function(e){e.bootWithoutWopiInfo="",e.unifiedSingleFlush="Unified_SingleFlush",e.unifiedIrmEnabled="Unified_IrmEnabled",e.unifiedViewActionUrl="Unified_ViewActionUrl",e.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",e.forceSingleStepBoot="Force_SingleStepBoot",e.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",e.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",e.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(y||(y={}));var k,N=n(40),M=((k={})[N.a.blurFocus]=m.a.Ii,k[N.a.continueAccessibilityLoop]=m.a.Ai,k[N.a.grabFocus]=m.a.Pi,k[N.a.moveToFolder]=m.a.yt,k[N.a.popState]=m.a.Fi,k[N.a.rename]=m.a.Ji,k[N.a.sendAccessToken]=m.a.Bi,k[N.a.sendAuthToken]=m.a.Li,k[N.a.sendCustomAuthConfig]=m.a.zi,k[N.a.sendEmbeddedViewUrl]=m.a.qi,k[N.a.sendSessionInfo]=m.a.Ki,k[N.a.sendUserAccessAndPermissions]=m.a.Zi,k[N.a.sendWopiInfo]=m.a.Xi,k[N.a.sendDavUrl]=m.a.$i,k[N.a.completeSharedFilePicker]=m.a.xt,k[N.a.switchMode]=m.a.io,k[N.a.signalShared]=m.a.co,k),x=function(){function e(e,t){var n,c,a=this;if(this.Xo=!1,this.Ro={},this.$o="",this.Qo="",this.Yo=!1,this.er=!1,this.tr=!1,this.nr=!1,this.ir=[],this.or=!0,this.rr=function(e,t,n){if(e){var i={MessageId:m.a.gi,CorrelationId:n,SendTime:Object(d.a)()};a.zo.ULS.vo(595732176,o.a.$,r.a.Info,"Sending Ack back"),e.postMessage(JSON.stringify(i),t)}else a.zo.ULS.vo(595736136,o.a.$,r.a.Info,"Missing target to send Ack back")},this.sr=function(e){var t,n=!1,c=!0,u="",d=!1;if(a.Ko&&a.Ko.contentWindow&&(n=!0,c=e.source===a.Ko.contentWindow),e.origin&&!(d=(u=Object(s.h)(e.origin,2).toLowerCase())===a.Qo)&&a.cr&&(u=Object(s.h)(e.origin).toLowerCase(),d=a.cr.includes(u)),!a.er&&(!a.tr||d&&c)||a.zo.ULS.vo(595730526,o.a.$,r.a.Info,"Window is available: ".concat(n,", window is valid: ").concat(c,", origin is valid: ").concat(d,", expected origin: ").concat(a.Qo,", actual origin: ").concat(u)),d&&(!a.Yo||c)){var f;try{f=JSON.parse(e.data)}catch(e){return void a.zo.ULS.vo(596464282,o.a.$,r.a.Info,"Failed to parse event data: ".concat(Object(v.b)(e),"."))}var h=f.MessageId;if(h){if(a.zo.ULS.vo(595714715,o.a.$,r.a.Info,"Received messageId: ".concat(h,", correlation: ").concat(f.CorrelationId)),h!==l.a.Qe&&h!==l.a._t||a.ar(e.origin),a.nr&&h===l.a.kn)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[f.Values.name]=f.Values.time);f.Values&&f.Values.ackExpected&&a.rr(e.source,e.origin,f.CorrelationId);var p=a.Ro[h];if(!p)return a.zo.ULS.vo(596464289,o.a.$,r.a.Info,"No handler found for message id: ".concat(h)),void(a.or&&h===l.a.Ot&&(a.ir.push(f),a.zo.ULS.vo(543207888,o.a.$,r.a.Info,"Kept for later process: ".concat(h))));a.zo.ULS.vo(596464288,o.a.$,r.a.Info,"Processing message: ".concat(h)),h===l.a.Jt&&(f.Values=Object(i.a)(Object(i.a)({},f.Values||{}),{sendTimeAsClickTime:f.SendTime}));try{p(f.Values||{})}catch(e){a.zo.ULS.vo(593773704,o.a.$,r.a.Error,"Handler error: ".concat(Object(v.b)(e)))}a.or&&h===l.a.Qe&&a.ur()}else(a.er||a.tr)&&a.zo.ULS.vo(595730520,o.a.$,r.a.Info,"Could not find message id")}},this.ur=function(){a.or=!1,a.ir.forEach((function(e){var t=e.MessageId,n=a.Ro[t];if(n){a.zo.ULS.vo(543207890,o.a.$,r.a.Info,"Processing message after boot complete: ".concat(t));try{n(e.Values||{})}catch(e){a.zo.ULS.vo(543207891,o.a.$,r.a.Error,"Handler error: ".concat(Object(v.b)(e)))}}else a.zo.ULS.vo(543207889,o.a.$,r.a.Info,"No handler found after boot complete: ".concat(t))})),a.ir=[]},this.dr=function(e,t,n){e.postMessage(t,n)},this.ar=function(e){var t=e.toLowerCase();a.$o&&a.$o!==t&&a.zo.ULS.vo(596128131,o.a.$,r.a.Warning,"Updating origin: [".concat(Object(s.g)(a.$o),"]->[").concat(Object(s.g)(t),"]")),a.$o=t,a.Qo=Object(s.h)(t,2),a.er=Object(s.n)(t),a.tr=Object(s.o)(t)},!e)throw new Error("Missing origin for PostMessageHandler");this.er=Object(s.n)(e),this.tr=Object(s.o)(e),this.zo=t,this.ar(e),this.nr=!!(null===(c=null===(n=window.location)||void 0===n?void 0:n.search)||void 0===c?void 0:c.match(/wdpa=1/gi))||"1"===Object(E.b)("EnableMetricLogging")}return e.prototype.registerMessagePayloadHandler=function(e,t){if(this.Ro[e])throw new Error("Duplicate registration!");this.Ro[e]=t},e.prototype.removeMessageHandler=function(e){delete this.Ro[e]},e.prototype.sendPostMessage=function(e,t,n){if(e&&e.contentWindow){this.zo.ULS.vo(596464334,o.a.$,r.a.Info,"Sending message: "+t);var i={MessageId:t,SendTime:Object(d.a)(),Values:n};this.dr(e.contentWindow,JSON.stringify(i),this.$o)}else this.zo.ULS.vo(595948308,o.a.$,r.a.Info,"Missing target for SendPostMessage")},e.prototype.activate=function(e,t){this.Ko=e,this.Yo=!!t,this.Xo||(window.addEventListener("message",this.sr,!1),this.Xo=!0)},e.prototype.postMessageForCommand=function(e,t,n){var i=M[t];i?(this.zo.ULS.vo(595702598,o.a.$,r.a.Info,"Sending message ".concat(i," for command ").concat(t)),this.sendPostMessage(e,i,n)):this.zo.ULS.vo(595702599,o.a.$,r.a.Warning,"No mapping for command ".concat(t))},e.prototype.dispose=function(){this.Ro={},this.Xo&&(window.removeEventListener("message",this.sr,!1),this.Xo=!1)},e}(),D=n(58),V=n(59),H=n(60),J=n(61),B=n(62),L=function(){function e(e,t,n,i,c,a){var f=this;if(this.lr=!1,this.hr=function(e,t){f.pr.officeFrameCreateTime=Object(d.a)(),f.vr.frameCreateStartTime=f.pr.officeFrameCreateTime;var n=f.br.applicationCustomSettings&&f.br.applicationCustomSettings.appFrameName;f.Ko=function(e,t,n,i,o,r,c){return function(e,t,n,i){Object(C.b)(e,i);var o=t.ownerDocument,r=o.createElement("form");for(var s in r.id="office_form",r.name="office_form",r.action=n,r.target=e.name,r.method="POST",i){var c=o.createElement("input");c.type="hidden",c.name=s,c.value=i[s],r.appendChild(c)}return t.appendChild(r),r.submit(),e}(function(e,t,n){var i=e.ownerDocument.createElement("iframe");i.name=n||"WebApplicationFrame",i.id="WebApplicationFrame",i.src="",i.title="Office Online Frame",i.width="100%",i.height="100%",i.marginWidth="0",i.marginHeight="0",i.style.left="0",i.style.top="0",i.style.right="0",i.style.bottom="0",i.style.display="block",i.style.position="absolute",i.style.backgroundColor="transparent",i.style.border="none",i.frameBorder="0",i.setAttribute("allowfullscreen","true"),i.setAttribute("allowTransparency","true");var o=Object(s.i)(t);return i.setAttribute("allow","microphone ".concat(o,"; autoplay ").concat(o,"; camera ").concat(o,"; clipboard-read ").concat(o,"; clipboard-write ").concat(o,"; keyboard-map ").concat(o,"; display-capture ").concat(o)),e.appendChild(i),i}(e,t,c),e,t,n)}(f.br.container,e,t,f.br.featureManager,f.zo,f.br.sessionId,n),f.ko.activate(f.Ko)},this.mr=function(e){f.ko.registerMessagePayloadHandler(l.a.Qe,f.wr),f.ko.registerMessagePayloadHandler(l.a.Xe,f.Or),f.gr=window.setTimeout(f.jr,15e3),f.Sr=new D.a(e,f.br.Hn,f.zo,(function(){Object(u.c)(f.br.remoteTelemetryUrl,j.a,"bootTimeout")}))},this.Ir=function(e){var t=e.flightKey,n=e.flightValue;f.zo.ULS.vo(507343133,o.a.Ae,r.a.Info,"storeWacFlightKeyValue ".concat(t,": ").concat(n));try{Object(V.b)(e)}catch(e){f.zo.ULS.vo(507340380,o.a.Ae,r.a.Error,"Handler error: ".concat(Object(v.b)(e)))}},this._r=function(e){var t=e&&e.state?e.state:"unknown";f.zo.ULS.vo(595714271,o.a.$,r.a.Info,"WAC Boot App state:[".concat(t,"]"))},this.Tr=function(e){var t=Object(C.f)(f.zo);f.zo.ULS.vo(595653903,o.a.$,r.a.Info,"Top frame is trusted: ".concat(t)),f.yr(m.a.bt,{isTopFrameTrusted:t})},this.Cr=function(e){var t=Object(H.b)(e&&e.overlayContent);f.zo.ULS.vo(587487432,o.a.$,r.a.Info,"Overlay content: ".concat(t)),f.yr(m.a.to,void 0)},this.wr=function(e){if(f.zo.ULS.vo(595986314,o.a.$,r.a.Info,"Received wac complete message"),f.zo.ULS.flush(),window.clearTimeout(f.gr),f.Sr&&f.Sr.stop(),f.lr)f.zo.ULS.vo(596444234,o.a.$,r.a.Info,"Received multiple wac complete or failure messages");else{f.lr=!0,f.yr(m.a.Ti,{}),S(f.pr,e);var t=f.Ar();f.Pr(t),f.br.Hn.getValue(h.a.ti,!1)&&(f.br.diagnostics.HostInitDiagnostics||(f.br.diagnostics.HostInitDiagnostics={}),Object(b.a)(f.br.diagnostics.HostInitDiagnostics)),f.Er(f.br.diagnostics)}},this.Ur=function(){f.zo.ULS.vo(579342464,o.a.$,r.a.Info,"Received close tab message");try{window.close()}catch(e){f.zo.ULS.vo(579213188,o.a.$,r.a.Warning,"Failed to close the browser tab")}},this.Ar=function(){return{innerApplicationFrame:f.Ko}},this.Or=function(e){if(f.zo.ULS.vo(595986315,o.a.$,r.a.Error,"Received wac failed message"),f.zo.ULS.flush(),window.clearTimeout(f.gr),f.Sr&&f.Sr.stop(),f.lr)f.zo.ULS.vo(596444235,o.a.$,r.a.Info,"Received multiple wac complete or failure messages");else{f.lr=!0,f.yr(m.a._i,{});var t={errorType:g.a.WacFailed,errorObject:{}};e&&(t.errorObject=e.Error,f.vr.error=t),f.Wr(t)}},this.Rr=function(e){var t=e.hostKey;f.zo.ULS.vo(574433173,o.a.$,r.a.Info,"GetHostKeyValue ".concat(t));var n=Object(J.b)(e);null!=n&&f.yr(m.a.Ui,{hostKey:t,hostValue:n})},this.Fr=function(e){var t=e.hostKey,n=e.hostValue;f.zo.ULS.vo(574433174,o.a.$,r.a.Info,"storeHostKeyValue ".concat(t,": ").concat(n)),Object(B.b)(e)},this.jr=function(){f.lr||f.zo.ULS.vo(596444236,o.a.$,r.a.Warning,"Timeout. SessionTraces:"+JSON.stringify(f.vr))},this.Er=function(e){f.yr(m.a.Wi,{HostInitializeDiagnostics:e.HostInitDiagnostics,ClientDiagnostics:e.ClientDiagnostics})},this.yr=function(e,t){f.Ko&&f.Ko.contentWindow?f.ko.sendPostMessage(f.Ko,e,t):f.zo.ULS.vo(595955718,o.a.$,r.a.Info,"Attempted to send postmessage: "+e)},void 0===t)throw new TypeError("bootFlowInfo");if(t.isSingleStepBoot&&void 0===e.wopiInfo)throw new TypeError("wopiInfo");this.br=e,this.kr=t,this.zo=n,this.ko=i,this.Pr=c,this.Wr=a,this.pr=e.diagnostics.AppInitDiagnostics,this.vr=e.diagnostics.SessionTraces,this.vr.wopiInitializeTime=Object(d.a)()}return e.prototype.Boot=function(){this.zo.ULS.vo(596444241,o.a.$,r.a.Info,"Initializing WAC frame");var e=R(this.br,this.kr,!0),t=function(e,t){var n={};if(e.wopiInfo&&(n[C.a.Nr]=e.wopiInfo.AccessToken,n[C.a.Mr]=F(e.wopiInfo),e.wopiInfo.WacToken&&(n[C.a.xr]=e.wopiInfo.WacToken)),e.wopiPrecheckInfo.BundleInfo&&e.wopiPrecheckInfo.BundleInfo.Url&&e.wopiPrecheckInfo.BundleInfo.Url.length>0)if(n[C.a.Dr]=e.wopiPrecheckInfo.BundleInfo.Url,null!=e.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==e.wopiPrecheckInfo.BundleInfo.BundleStaleness){var i=e.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();t.ULS.vo(593503580,o.a.$,r.a.Info,"Content bundle staleness - "+i),n[C.a.Vr]=i}else t.ULS.vo(593503581,o.a.$,r.a.Info,"Content bundle staleness does not exist");if(e.wopiPrecheckInfo.FileGetUrl&&(n[C.a.Hr]=e.wopiPrecheckInfo.FileGetUrl),e.wopiPrecheckInfo.CustomFontCatalogUrl&&(n[C.a.Jr]=e.wopiPrecheckInfo.CustomFontCatalogUrl),e.wopiPrecheckInfo.FileName){var s=Object(v.a)(e.wopiPrecheckInfo.FileName);s&&(n[C.a.Br]=s),n[C.a.Lr]=e.wopiPrecheckInfo.FileName}e.newFileTemplateSource&&e.newFileTemplateSource.FileSize?n[C.a.zr]=e.newFileTemplateSource.FileSize.toString():e.wopiPrecheckInfo.FileSize&&(n[C.a.zr]=e.wopiPrecheckInfo.FileSize.toString()),e.sessionInformation.UserId&&(n[C.a.Gr]=e.sessionInformation.UserId),e.sessionInformation.OwnerId&&(n[C.a.qr]=e.sessionInformation.OwnerId),e.sessionInformation.SessionContext&&(n[C.a.Kr]=e.sessionInformation.SessionContext),void 0!==e.sessionInformation.SupportsZipIt&&(n[C.a.Zr]=e.sessionInformation.SupportsZipIt.toString()),e.diagnostics.HostInitDiagnostics&&(n[C.a.Xr]=JSON.stringify({HostInitializeDiagnostics:e.diagnostics.HostInitDiagnostics,ClientDiagnostics:e.diagnostics.ClientDiagnostics})),n[C.a.$r]=Object(A.b)(e.featureManager,e.sessionInformation.WdParams),e.applicationCustomSettings&&e.applicationCustomSettings.HostUIControls&&(n[C.a.Qr]=JSON.stringify(e.applicationCustomSettings.HostUIControls)),n[C.a.Yr]=String(window.devicePixelRatio>1.24),n[C.a.es]=String(Object(P.e)()),n[C.a.ts]=e.sessionInformation.HostName;var a=e.newFileTemplateSource;a&&a.FileGetUrl&&(n[C.a.ns]=a.FileGetUrl),a&&a.DocUniqueId?n[C.a.os]=a.DocUniqueId:e.wopiPrecheckInfo.DocUniqueId&&(n[C.a.os]=e.wopiPrecheckInfo.DocUniqueId),a&&a.ETag?n[C.a.ss]=a.ETag:e.wopiPrecheckInfo.ETag&&(n[C.a.ss]=e.wopiPrecheckInfo.ETag),"Templatization"!==e.sessionInformation.ContentAssemblyMode&&"DocGen"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyEdit"!==e.sessionInformation.ContentAssemblyMode&&"ContentAssemblyView"!==e.sessionInformation.ContentAssemblyMode||(n[C.a.cs]="1"),e.sessionInformation.ContentAssemblyMode&&(n[C.a.as]=e.sessionInformation.ContentAssemblyMode);var u=e.sessionInformation.Meeting;u&&(u.id&&(n[C.a.us]=u.id),u.title&&(n[C.a.ds]=u.title),u.type&&(n[C.a.fs]=u.type),u.scheduledStartTime&&(n[C.a.ls]=u.scheduledStartTime),u.scheduledEndTime&&(n[C.a.ls]=u.scheduledEndTime),u.joinUrl&&(n[C.a.hs]=encodeURIComponent(u.joinUrl)),u.organizerId&&(n[C.a.ps]=u.organizerId),u.isPresenter&&(n[C.a.vs]=u.isPresenter.toString()),u.isMeetingTeamsRoom&&(n[C.a.bs]=u.isMeetingTeamsRoom.toString()));var d=e.sessionInformation.OwlVersion;d&&(n[C.a.ms]=d);var f=e.sessionInformation.OwlRollout;f&&(n[C.a.ws]=f),n[C.a.Os]=Object(c.a)();var l=e.sessionInformation.TraceParent;if(l){n[C.a.gs]=l;var h=e.sessionInformation.TraceState;h&&(n[C.a.js]=h)}return n}(this.br,this.zo);if(this.ko.registerMessagePayloadHandler(l.a.$e,this._r),this.ko.registerMessagePayloadHandler(l.a.tt,this.Ur),this.br.sessionInformation.SupportsFrameTrustCheck||this.ko.registerMessagePayloadHandler(l.a.bt,this.Tr),this.ko.registerMessagePayloadHandler(l.a.Ht,this.Cr),this.ko.registerMessagePayloadHandler(l.a.jt,this.Rr),this.ko.registerMessagePayloadHandler(l.a.zt,this.Fr),this.ko.registerMessagePayloadHandler(l.a.Vn,this.Ir),this.kr.ignoreWacFramePostMessages||this.mr(Object(s.n)(e)),this.hr(e,t),this.kr.ignoreWacFramePostMessages){var n=this.Ar();this.Pr(n)}return this.zo.ULS.vo(595661019,o.a.$,r.a.Info,"Created Wac Frame"),this.Ko},e}(),z=function(){function e(e,t,n,i,a,u,f){var h=this;this.Ss=!1,this.Is=!1,this._s=!1,this.Ts=null,this.ys=!0,this.Cs=!1,this.As=!1,this.Ps=function(){h.zo.ULS.vo(596444231,o.a.$,r.a.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout(h.Es,5e3),h.ko.registerMessagePayloadHandler(l.a.Ze,h.Us),h.ko.registerMessagePayloadHandler(l.a.Vt,h.Ws);var e=new L(h.br,h.kr,h.zo,h.ko,h.Pr,h.Wr);h.Ko=e.Boot(),h.Rs&&h.Rs(h.Ko)},this.Fs=function(){var e={ParallelizeStartSession:h.ys,WacFrameIsLoaded:h.Ss,WacAcceptsStartSessionComplete:h.Cs};h.zo.ULS.vo(596444232,o.a.$,r.a.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(e)),!h.ys||h.Ss&&!h.Cs?h.Ss&&h.ks():h.Ns()},this.Ms=function(){h.zo.ULS.vo(596444233,o.a.$,r.a.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),h.br.wopiInfo=h.xs;var e=new L(h.br,h.kr,h.zo,h.ko,h.Pr,h.Wr);h.Ko=e.Boot(),h.Rs(h.Ko)},this.Ds=function(e){h.Ss?(h.zo.ULS.vo(595968481,o.a.$,r.a.Warning,"Fail called and wacframe is able to accept postmessages"),h.Vs(e)):(h.zo.ULS.vo(595968482,o.a.$,r.a.Warning,"Fail was called on the session prior to WacReady."),h.Ts=e)},this.Vs=function(e){h.zo.ULS.vo(596444189,o.a.$,r.a.Warning,"Fail called, sending the failure postmessage to IFrame"),h.yr(m.a.eo,e)},this.Hs=function(){h.zo.ULS.vo(596444190,o.a.$,r.a.Warning,"Fail called during single step boot, calling host failure callback..."),h.Wr({errorType:g.a.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},this.Es=function(){h.Ss||(h.zo.ULS.vo(596444191,o.a.$,r.a.Warning,"Timeout Wac Ready"),h.Wr({errorType:g.a.TimeoutWacReady,errorObject:void 0}))},this.Js=function(){h._s||(h.vr.timeoutCompleteOrFail=Object(d.a)(),h.zo.ULS.vo(596444192,o.a.$,r.a.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(h.vr)))},this.Bs=function(e,t,n){h.As||(h.zo.ULS.vo(596444193,o.a.$,r.a.Info,"SessionCompletion timed out with no ack."),h.Ls(e,t,n+1))},this.Us=function(e){if(h.vr.readyMessageReceiveTime=Object(d.a)(),h.yr(m.a.ji,{}),h.Ss)h.zo.ULS.vo(596444194,o.a.$,r.a.Info,"Received multiple ready messages - frame is already loaded.");else{h.Ss=!0,h.Cs=e&&e.CanAcceptStartSessionComplete;var t={AcceptStartSessionComplete:h.Cs,ParallelizeStartSession:h.ys,StartSessionResponseAvailable:!!h.zs,WopiInfoAvailable:!!h.xs};h.zo.ULS.vo(596444195,o.a.$,r.a.Info,"HandleWacReadyMessage - "+JSON.stringify(t)),h._s&&(h.Ts?h.Vs(h.Ts):h.yr(m.a.no,{})),h.ys&&h.Cs?h.zs&&h.Gs():h.xs&&h.ks(),S(h.pr,e)}},this.Ws=function(e){h.As=!0,h.vr.sessionCompleteAckReceivedTime=Object(d.a)()},this.yr=function(e,t){h.ko.sendPostMessage(h.Ko,e,t)},this.qs=function(e,t){h.Ls(e,t,1)},this.Ls=function(e,t,n){if(n>3)h.zo.ULS.vo(596444224,o.a.$,r.a.Error,"Attempted to call complete, but received no ack from the frame. Time: ".concat(Object(d.a)()));else{h.zo.ULS.vo(596444225,o.a.$,r.a.Info,"Sending completion message to frame. Attempt number: ".concat(n,", Time: ").concat(Object(d.a)()));var i=Object(d.a)();1===n&&(h.zs&&h.zs.Diagnostics&&(h.zs.Diagnostics.completeMessageCreateTime=i),h.vr.completeMessageCreateTime=i),t.Diagnostics.completeMessageSendTime=i,h.vr.completeMessageSendTime=i,h.yr(e,t),window.setTimeout((function(){return h.Bs(e,t,n)}),1e3)}},this.Ns=function(){h.zo.ULS.vo(596444226,o.a.$,r.a.Info,"Making parallelized startSession request.");var e=h.Ks(h.xs),t="access_token="+encodeURIComponent(h.xs.AccessToken)+"&access_token_ttl="+encodeURIComponent(F(h.xs));h.vr.startSessionStartTime=Object(d.a)(),Object(w.a)(e,t,{"Content-Type":"application/x-www-form-urlencoded"},h.Zs)},this.Zs=function(e){if(h.vr.startSessionCompleteTime=Object(d.a)(),h.vr.startSessionResponseStatus=e.status,h.zs={StartSessionResponse:{RequestStatus:e.status,ResponseText:e.responseText},Diagnostics:{wopiPendingInitializeTime:h.vr.wopiPendingInitializeTime,wopiPendingCompleteTime:h.vr.wopiPendingCompleteTime,startSessionStartTime:h.vr.startSessionStartTime,startSessionCompleteTime:h.vr.startSessionCompleteTime,readyMessageReceiveTime:h.vr.readyMessageReceiveTime}},h.zo.ULS.vo(596444227,o.a.$,r.a.Info,"StartSession request completed with status code: ".concat(h.zs.StartSessionResponse.RequestStatus,", Time: ").concat(Object(d.a)())),h.Ss&&h.Cs)h.Gs();else{var t={WacFrameIsLoaded:h.Ss,InitializeCompleted:h.Is};h.zo.ULS.vo(596444228,o.a.$,r.a.Info,"StartSessionCompleted not called - "+JSON.stringify(t))}},this.ks=function(){if(!h.Is){h.Is=!0,h.zo.ULS.vo(596444229,o.a.$,r.a.Info,"Sending wopi info to the frame.");var e={WopiDetails:{WopiSrc:h.xs.WopiSrc,AccessToken:h.xs.AccessToken,AccessTokenTtl:F(h.xs)},Diagnostics:{wopiPendingInitializeTime:h.vr.wopiPendingInitializeTime,wopiPendingCompleteTime:h.vr.wopiPendingCompleteTime,readyMessageReceiveTime:h.vr.readyMessageReceiveTime}};h.xs.WacToken&&(e.WopiDetails.WacToken=h.xs.WacToken),h.qs(m.a.Ci,e)}},this.Gs=function(){200===h.zs.StartSessionResponse.RequestStatus?h.Is||(h.Is=!0,h.qs(m.a.yi,h.zs)):h.ks()},this.Ks=function(e){var t=h.br.applicationBasePath+U.h,n=R(h.br,h.kr,!1);return t+="?"+n.substring(n.indexOf("?")+1),t=Object(s.b)(t,"WOPISrc",encodeURIComponent(e.WopiSrc)),t=Object(s.b)(t,"build",encodeURIComponent(Object(c.a)())),t=Object(s.b)(t,"WacUserType",encodeURIComponent("WOPI")),h.br.wopiPrecheckInfo.FileGetUrl&&(t=Object(s.b)(t,"fileGetUrlPresent","1")),t},this.Xs=function(e){if(h.br.isCreateNew){if(!e||!e.NewFilePath)return void h.zo.ULS.vo(596444230,o.a.$,r.a.Info,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",e.NewFilePath),e.UpdatedPageTitle&&(document.title=e.UpdatedPageTitle)}},this.br=e,this.kr=t,this.pr=e.diagnostics.AppInitDiagnostics,this.zo=n,this.ko=i,this.Pr=u,this.Wr=f,Promise&&(this.$s=new Promise((function(e){return h.Rs=e}))),this.vr=e.diagnostics.SessionTraces,this.vr.wopiPendingInitializeTime=Object(d.a)(),this.Qs=a,Object(O.b)(),window.setTimeout(this.Js,5e3)}return e.prototype.Complete=function(e,t){if(this._s)this.zo.ULS.vo(596444184,o.a.$,r.a.Warning,"Complete called after Complete/Fail already called");else{this.zo.ULS.vo(596444185,o.a.$,r.a.Info,"Complete called."),this.br.diagnostics.HostInitDiagnostics&&(this.br.diagnostics.HostInitDiagnostics.hostCompleteCallTime=Object(d.a)()),this._s=!0,this.xs=e,this.vr.wopiPendingCompleteTime=Object(d.a)();try{this.kr.isSingleStepBoot?this.Ms():this.Fs(),this.Ss&&this.yr(m.a.no,{}),this.Xs(t)}catch(e){this.zo.ULS.vo(596444186,o.a.$,r.a.Error,"Unexpected script error: ".concat(Object(v.b)(e))),Object(u.c)(this.br.remoteTelemetryUrl,j.a,"bootException")}finally{this.zo.ULS.flush()}}},e.prototype.Fail=function(e){this._s?this.zo.ULS.vo(596444187,o.a.$,r.a.Warning,"Fail called after Complete/Fail already called"):(this.zo.ULS.vo(596444188,o.a.$,r.a.Warning,"Fail called. Reason: "+(e?JSON.stringify(e):"N/A")),this._s=!0,this.kr.isSingleStepBoot?this.Hs():this.Ds(e),this.zo.ULS.flush())},e.prototype.Dispose=function(e,t,n){var i=this;Object(O.a)(e||!1,this.zo,this.ko,this.Ko,(function(){delete i.Ko,t&&t(),i.Qs(),i.ko.dispose()}),void 0,n)},e.prototype.PostWacToken=function(e,t,n){!function(e,t,n,i,s,c){var a=Object(d.a)();i.ULS.vo(507774684,o.a.$,r.a.Important,"postWacToken flow initiated");var u=function(){c&&c.flush&&c.flush()};s?s.then((function(s){var f=function(){return n.sendPostMessage(s,m.a.po,{wacToken:e,postWacTokenStart:t})};f();var h=window.setInterval(f,100);n.registerMessagePayloadHandler(l.a.Mn,(function(e){i.ULS.vo(507597019,o.a.$,r.a.Info,"postWacToken flow completed in ".concat(Object(d.a)()-a," ms")),window.clearInterval(h),window.clearTimeout(p),c&&(c.PostWacTokenResult="success",c.PostWacTokenEndTime=Object(d.a)(),e&&void 0!==e.TokenAlreadySet&&(c.TokenAlreadySet=e.TokenAlreadySet),u())}));var p=window.setTimeout((function(){i.ULS.vo(507597018,o.a.$,r.a.Warning,"postWacToken flow timed out after ".concat(6e4," ms")),window.clearInterval(h),c&&(c.PostWacTokenResult="timeout",c.PostWacTokenEndTime=Object(d.a)(),u())}),6e4)})).catch((function(e){i.ULS.vo(507873094,o.a.$,r.a.Warning,"This should never reject, error: ".concat(Object(v.b)(e))),c&&(c.PostWacTokenResult="Unexpected JSAPI V1 error",c.PostWacTokenEndTime=Object(d.a)(),u())})):(i.ULS.vo(507846862,o.a.$,r.a.Warning,"`Promise` does not exist natively for this browser."),c&&(c.PostWacTokenResult="JSAPI V1 error: Promise not supported in browser",c.PostWacTokenEndTime=Object(d.a)(),u()))}(e,t,this.ko,this.zo,this.$s,n)},e.prototype.Boot=function(){this.kr.isSingleStepBoot||this.Ps(),this.zo.ULS.flush()},e}(),G=function(){function e(e,t,n,i,s,c,a){var u=this;this.Ys=!1,this.ec=!1,this.tc=!1,this.nc=function(e,t){u.ko.sendPostMessage(e,m.a.Ei,{HostCacheLoadTime:t})},this.ic=function(e,t,n,i){if(u.zo.ULS.vo(595989254,o.a.H,r.a.Info,"Kick off OptimizationView"),!u.br.applicationCustomSettings||!u.br.applicationCustomSettings.ForceAccessibilityMode)if(e.Url){var s=t.ownerDocument;if(s){u.oc=s.createElement("div"),u.oc.id="FirstPageContainer",u.oc.style.left="0",u.oc.style.textAlign="center",u.oc.style.width="1px",u.oc.style.bottom="0",u.oc.style.zIndex="900",u.oc.style.height="1px",u.oc.style.position="absolute",u.oc.style.padding="0 29px",u.oc.style.right="0",u.oc.style.overflow="auto",u.oc.style.marginLeft="auto",u.oc.style.marginRight="auto",u.oc.style.maxWidth="100%",u.rc?u.oc.style.top="0":u.oc.style.top="90px",t.appendChild(u.oc);var c=s.createElement("img");c.id="FirstPageImage",c.style.marginTop="11px",c.style.marginBottom="11px",c.style.maxWidth="100%",c.style.border="solid 1px #d2d5d8",c.draggable=!1,c.onload=function(){u.zo.ULS.vo(595989255,o.a.H,r.a.Info,"OptimizationView Loaded"),u.oc.style.width="",u.oc.style.height="",n()},c.onerror=function(e){i({errorType:g.a.CannotLoadFirstPage,errorObject:"string"==typeof e?e:e.returnValue})},c.src=e.Url.replace("{0}","p1.img"),u.oc.appendChild(c)}}else u.zo.ULS.vo(595722645,o.a.H,r.a.Info,"Missing Url in provided Bundle Info, from host: "+u.br.sessionInformation.HostName)},this.cc=function(){if(!u.ec&&u.Ys&&(!u.rc||u.uc&&u.dc&&u.fc)){u.ko.removeMessageHandler(l.a.Xt),u.ko.removeMessageHandler(l.a.Et),u.ko.removeMessageHandler(l.a.tn);var e={isCore:u.rc,pageCount:u.dc,currentPage:u.uc,zoomLevel:u.fc,innerApplicationFrame:u.Ko};u.Pr(e),u.zo.ULS.vo(595989256,o.a.H,r.a.Info,"Word Viewer Initialize Complete"),u.ec=!0,u.zo.ULS.flush()}},this.lc=function(e){u.zo.ULS.vo(595986312,o.a.H,r.a.Info,"SuccessCallbackProxy called"),u.Ko=e.innerApplicationFrame,u.hc&&u.nc(u.Ko,u.hc),u.pc();var t=u.pr.documentLoadedTime;t&&u.hc&&u.hc<t?(u.pr.documentLoadedTime=u.hc,u.pr.documentLoadedFromWopiPrecheckInfo=!0,u.zo.ULS.vo(595994572,o.a.H,r.a.Info,"First page load from cache was faster")):u.pr.documentLoadedFromWopiPrecheckInfo=!1,u.vc(),u.Ys=!0,u.zo.ULS.vo(595986313,o.a.H,r.a.Info,"WordViewerInitializer received wac complete message"),u.cc(),u.zo.ULS.flush()},this.bc=function(e){u.zo.ULS.vo(595972122,o.a.H,r.a.Error,"FailureCallbackProxy called"),u.ec=!0,u.Wr(e)},this.pc=function(){u.oc&&u.oc.parentElement&&u.oc.parentElement.removeChild(u.oc)},this.mc=function(){if(!u.ec){u.vr.timeoutAppInitialize=Object(d.a)();var e="Didn't receive app initialize post messages. {'appComplete': "+u.Ys+", 'currentPage': "+(void 0!==u.uc)+", 'zoomLevel': "+(void 0!==u.fc)+", 'pageCount': "+(void 0!==u.dc)+"}";u.zo.ULS.vo(596120771,o.a.H,r.a.Warning,e)}},this.wc=function(e){if(!e||"number"!=typeof e.pageCount)throw new TypeError("values: PageCount not found");u.dc=e.pageCount,u.yr(m.a.ro,{}),u.cc()},this.Oc=function(e){if(!e||"number"!=typeof e.newPage)throw new TypeError("values: CurrentPage not found");u.uc=e.newPage,u.yr(m.a.Ri,{}),u.cc()},this.gc=function(e){if(!e||"number"!=typeof e.newLevel)throw new TypeError("values: ZoomLevel not found");u.fc=e.newLevel,u.yr(m.a.so,{}),u.cc()},this.vc=function(){u.uc&&u.yr(m.a.Ri,{}),u.dc&&u.yr(m.a.ro,{}),u.fc&&u.yr(m.a.so,{})},this.yr=function(e,t){u.Ko&&u.Ko.contentWindow?u.ko.sendPostMessage(u.Ko,e,t):u.zo.ULS.vo(595955717,o.a.H,r.a.Info,"Attempted to send WordViewer postmessage: "+e)},this.br=e,this.pr=e.diagnostics.AppInitDiagnostics,this.zo=n,this.ko=i,this.vr=e.diagnostics.SessionTraces,this.Qs=s;var f=window.navigator.userAgent;f.indexOf("Mobi")>=0&&f.indexOf("iPad")<0&&(this.tc=!0),this.Pr=c,this.Wr=a,this.jc=this.tc?c:this.lc,this.Sc=this.tc?a:this.bc,this.rc=!(!this.br.applicationCustomSettings||!this.br.applicationCustomSettings.IsCore),this.br.sessionInformation&&this.br.sessionInformation.WdParams&&(this.br.applicationCustomSettings&&this.br.applicationCustomSettings.ForceAccessibilityMode?this.br.sessionInformation.WdParams.wdAccPdf="1":this.rc&&(this.br.sessionInformation.WdParams.wdAccPdf="0")),this.Ic=new z(this.br,t,n,i,s,this.jc,this.Sc)}return e.prototype.Complete=function(e){this.br.diagnostics.HostInitDiagnostics&&(this.br.diagnostics.HostInitDiagnostics.hostCompleteCallTime=Object(d.a)()),this.Ic.Complete(e)},e.prototype.Fail=function(e){this.Ic.Fail(e)},e.prototype.Dispose=function(e,t,n){var i=this;Object(O.a)(e||!1,this.zo,this.ko,this.Ko,(function(){delete i.Ko,t&&t(),i.Qs(),i.ko.dispose()}),void 0,n)},e.prototype.PostWacToken=function(e,t,n){this.Ic.PostWacToken(e,t,n)},e.prototype.Boot=function(){var e=this;if(this.tc)this.zo.ULS.vo(595932544,o.a.H,r.a.Info,"Mobile Endpoint detected, skipping first page viewer optimization");else if(this.br.sessionInformation&&this.br.sessionInformation.WdParams&&"1"===this.br.sessionInformation.WdParams.wdignorefpo)this.zo.ULS.vo(507561551,o.a.H,r.a.Info,"wdignorefpo request detected, skipping first page viewer optimization");else{this.zo.ULS.vo(595989253,o.a.H,r.a.Info,"Boot WordViewer"),this.ko.registerMessagePayloadHandler(l.a.Xt,this.wc),this.ko.registerMessagePayloadHandler(l.a.Et,this.Oc),this.ko.registerMessagePayloadHandler(l.a.tn,this.gc);var t=this.br.rebootOverrideData;t&&t.reason&&"translate"===t.reason.toLowerCase()?this.zo.ULS.vo(591209105,o.a.H,r.a.Info,"Skip first page optimization"):this.br.wopiPrecheckInfo.BundleInfo?this.ic(this.br.wopiPrecheckInfo.BundleInfo,this.br.container,(function(){e.hc=Object(d.a)(),e.zo.ULS.vo(595998873,o.a.H,r.a.Info,"FirstPageFromHostLoadTime: "+e.hc),e.pr.documentLoadedTime=e.pr.documentLoadedTime||e.hc,e.Ko&&e.Ko.contentWindow&&e.nc(e.Ko,e.hc)}),(function(t){e.pc(),e.zo.ULS.vo(595994571,o.a.H,r.a.Warning,"Cannot load first page from cache"),e.pr.errorObject=t})):this.zo.ULS.vo(596121033,o.a.H,r.a.Warning,"Missing Bundle Info"),window.setTimeout(this.mc,6e4)}},e}(),q=function(){function e(){var e=this;if(this._c=[],this.Ro=[],this.Tc=function(){var t={visibility:document.visibilityState,time:Object(d.a)(),initialState:!1};e._c.push(t);for(var n=0,i=e.Ro;n<i.length;n++){var o=i[n];o&&o(t)}},"hidden"===document.visibilityState){var t={visibility:document.visibilityState,time:Object(d.a)(),initialState:!0};this._c.push(t)}document.addEventListener("visibilitychange",this.Tc)}return e.prototype.registerEventHandler=function(e){this.Ro.push(e)},e.prototype.removeEventHandler=function(e){if(e){var t=this.Ro.indexOf(e);this.Ro.splice(t,1)}},e.prototype.stop=function(){document.removeEventListener("visibilitychange",this.Tc)},e.prototype.getVisibilityChangeEvents=function(){return this._c},e.prototype.dispose=function(){this.stop(),this.Ro=[],this._c=[]},e}(),K=function(){function e(e,t){var n=this;this.yc=function(e,t){return window.setInterval((function(){n.Prefetch({BootstrapperUrl:e}),t.ULS.vo(595895774,o.a.$,r.a.Info,"Prefetching "+Object(s.j)(e))}),36e5)},this.Cc=e,this.Ac=t}return e.prototype.GetVersion=function(){return Object(c.a)()},e.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},e.prototype.Prefetch=function(e){if(null!=e&&void 0!==e){var t=document.createElement("link");t.rel="prefetch";var n=e.BootstrapperUrl;".js"!==n.toString().slice(-3)&&(n+=".js"),t.href=n;var i=document.getElementsByTagName("head")[0];null!=i&&void 0!==i&&i.appendChild(t)}},e.prototype.InitializeWopiPending=function(e,t,n,i,c,m){var w,O,S,C,A,R=!1;try{n?S=n:(S=(w=Object(a.a)())[0],C=w[1]),Object(u.c)(Object(j.d)(e.ApplicationUrl,S),j.a,"init");var F,k=Object(d.a)();!function(e){if(void 0===e)throw new TypeError("initParams");var t=e.Container;if(void 0===t||void 0===t.appendChild)throw new TypeError("Container");var n=e.SessionInformation;if(void 0===n||void 0===n.HostName||void 0===n.HostSessionId||void 0===n.UserId)throw new TypeError("SessionInformation");var i=e.ApplicationUrl;if(void 0===i||"string"!=typeof i)throw new TypeError("ApplicationUrl");var o=e.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===e.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===e.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(e),e.ApplicationUrl=Object(s.u)(e.ApplicationUrl,Object(s.k)(e.ApplicationUrl,"region")),e.ApplicationUrl=Object(s.w)(e.ApplicationUrl,"region"),function(e){var t,n=e.RebootOverrideData;n&&(t=n.mode)&&("view"===(t=t.toLowerCase())&&Object(U.b)(e.ApplicationUrl)?e.ApplicationUrl=Object(U.d)(e.ApplicationUrl):"edit"===t&&Object(U.c)(e.ApplicationUrl)&&(e.ApplicationUrl=Object(U.e)(e.ApplicationUrl)))}(e),O=t||Object(f.a)({remoteUlsEndpoint:Object(j.b)(e.ApplicationUrl)+s.t,sessionId:S}),A=Object(j.c)(e,S,O,c,m,this.Ac.forceSingleStepBoot),m||(A.Hn.addSettingsChangeListener(O.settingsChangeHandler),A.Hn.initializePeriodicFetch(A.applicationBasePath,S)),A.diagnostics.HostInitDiagnostics&&(A.diagnostics.HostInitDiagnostics.hostInitializeCallTime=k),T(O,A,C),R=!0;var N=e.BootstrapperUrl;N&&(F=this.yc(N,O));var M=function(){A.Hn.dispose(),A.pageStateObserver.dispose(),window.clearInterval(F)},D=Object(s.i)(e.ApplicationUrl),V=i||new x(D,O),H=new q,J=function(e,t){var n={isSingleStepBoot:e.forceSingleStepBoot,bootFlowType:e.forceSingleStepBoot?y.forceSingleStepBoot:y.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(e.forceSingleStepBoot||(n=function(e,t){var n=e.applicationUrl,i=Object(U.b)(n),c=Object(U.c)(n),a=Object(s.p)(n,"uiembed"),u=Object(s.p)(n,"embed");return t.ULS.vo(595640900,o.a.$,r.a.Info,"gotUiEmbedUrl:".concat(a,", gotEditUrl:").concat(i,", gotViewUrl:").concat(c)),!i&&e.wopiPrecheckInfo.IrmEnabled?{isSingleStepBoot:!0,bootFlowType:a?y.wordUiEmbedIrmEnabledEarlyRedirect:y.unifiedIrmEnabled,ignoreWacFramePostMessages:!1}:(e.canSupportConsumption=e.Hn.getValue(h.a.Qn,!1)&&e.featureManager.isFeatureEnabled(p.a.Eo)&&!a&&!u&&(e.isCreateNew&&!e.wopiInfo||"docx"===Object(v.a)(e.wopiPrecheckInfo.FileName))&&Object(b.d)(e.sessionInformation.HostName)&&!(e.sessionInformation.WdParams&&"1"===e.sessionInformation.WdParams.wdEmbedFS),e.canSupportConsumption&&c&&!Object(E.a)(W.a.Wo,!1)&&!Object(b.e)(e.wopiPrecheckInfo.RequestedCallThrottling,e.Hn.getValue(h.a.Yn,"Major"))?{isSingleStepBoot:!0,bootFlowType:y.wordViewToUnifiedReadRedirect,ignoreWacFramePostMessages:!1}:i?(t.ULS.vo(575980770,o.a.$,r.a.Info,"readOnly:".concat(e.wopiPrecheckInfo.ReadOnly)),e.wopiPrecheckInfo.ReadOnly&&a?{isSingleStepBoot:!0,bootFlowType:y.wordUiEmbedReadOnlyEarlyRedirect,ignoreWacFramePostMessages:!1}:!function(e){return e.Hn.getValue(h.a.ni,!1)?null==e.wopiInfo||null==e.wopiInfo.WopiSrc||""===e.wopiInfo.WopiSrc:null==e.wopiInfo}(e)||Object(P.d)()?{isSingleStepBoot:!0,bootFlowType:y.unifiedSingleFlush,ignoreWacFramePostMessages:!1}:{isSingleStepBoot:!1,bootFlowType:y.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1}):{isSingleStepBoot:!0,bootFlowType:c?y.unifiedViewActionUrl:y.unifiedNotEditOrViewActionUrl,ignoreWacFramePostMessages:!c})}(e,t)),n.isSingleStepBoot){var i={singleStepBootIsRequired:!0,singleStepBootReason:n.bootFlowType,irmEnabled:e.wopiPrecheckInfo.IrmEnabled,readOnly:e.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:n.ignoreWacFramePostMessages};t.ULS.vo(596444182,o.a.$,i.irmEnabled?r.a.Warning:r.a.Info,JSON.stringify(i))}else t.ULS.vo(596444183,o.a.$,r.a.Info,"Received input valid for two step flow");return n}(A,O),B=function(e,t,n,i,s,c,a){return function(d){var f=e.diagnostics;_(f,i),I(f.SessionTraces,n,r.a.Info);var l=X(f);n.ULS.vo(596448985,o.a.$,r.a.Info,JSON.stringify(l)),Object(u.c)(e.remoteTelemetryUrl,j.a,"bootSuccess");var h=a(e.sessionId,n,t,s,d);try{c(h,l)}catch(e){n.ULS.vo(595719171,o.a.$,r.a.Error,"Exception thrown from host's success callback: ".concat(Object(v.b)(e)))}Object(b.g)("word",n),Z(n)}}(A,V,O,H,M,e.FnOnInitializeSuccess,this.Cc),L=function(e,t,n,i){return function(s){var c=e.diagnostics;_(c,n),I(c.SessionTraces,t,r.a.Warning);var a=X(c);t.ULS.vo(596448986,o.a.$,r.a.Error,JSON.stringify({error:s,appInitDiagnostics:a})),Object(u.c)(e.remoteTelemetryUrl,j.a,"bootFailure");try{i(s,a)}catch(e){t.ULS.vo(595719172,o.a.$,r.a.Error,"Exception thrown from host's failure callback: ".concat(Object(v.b)(e)))}Object(b.g)("word",t),Z(t)}}(A,O,H,e.FnOnInitializeFailure);e.FnOnAppModeSwitched&&V.registerMessagePayloadHandler(l.a.Tt,e.FnOnAppModeSwitched);var K=A.Hn.getValue(h.a.fi,!1)&&"Microsoft Teams"===e.SessionInformation.HostName;if(K||this.Ac.useViewerInitializer||J.bootFlowType===y.unifiedViewActionUrl||J.bootFlowType===y.wordUiEmbedReadOnlyEarlyRedirect||J.bootFlowType===y.wordUiEmbedIrmEnabledEarlyRedirect){!this.Ac.useViewerInitializer&&e.FnOnAppModeSwitched&&e.FnOnAppModeSwitched({NewMode:"view"}),(J.bootFlowType===y.wordUiEmbedReadOnlyEarlyRedirect||K)&&(A.applicationUrl=Object(U.d)(A.applicationUrl,!0)),A.sessionInformation.HideViewerToolbar&&(A.applicationCustomSettings?A.applicationCustomSettings.IsCore=!0:A.applicationCustomSettings={IsCore:!0},delete A.sessionInformation.HideViewerToolbar);var $=new G(A,J,O,V,M,B,L);return $.Boot(),$}J.bootFlowType===y.wordViewToUnifiedReadRedirect&&(O.ULS.vo(578324612,o.a.$,r.a.Info,"Redirecting Viewer request to unified read"),A.applicationUrl=Object(U.e)(A.applicationUrl)),e.WopiPrecheckInfo.ReadOnly&&e.FnOnAppModeSwitched&&e.FnOnAppModeSwitched({NewMode:"view"});var Q=Object(s.k)(A.applicationUrl,"uih");if(N&&this.Ac.preconnector&&this.Ac.preconnector.shouldPreconnect(Q)&&this.Ac.preconnector.preconnect(N),N&&this.Ac.preloader&&this.Ac.preloader.shouldPreload(A.applicationUrl))try{var Y=N;A.featureManager.isFeatureEnabled(p.a.jo)&&(O.ULS.vo(595645891,o.a.$,r.a.Info,"HTTP2 preload enabled"),Y=Object(s.v)(N));var ee=A.sessionInformation.UiLocale;ee||(ee=decodeURIComponent(Object(s.k)(A.applicationUrl,"ui"))),this.Ac.preloader.preload(Y,ee,O,A.featureManager)}catch(e){O.ULS.vo(595943884,o.a.$,r.a.Error,"Error preloading")}var te=new z(A,J,O,V,M,B,L);return te.Boot(),te}catch(t){return O&&(O.ULS.vo(596459925,o.a.$,r.a.Error,"".concat(g.a.AppInitError,": ").concat(Object(v.b)(t))),R||T(O,A||Object(j.c)(e,S,O,c,m,this.Ac.forceSingleStepBoot),C),O.ULS.flushOnClose()),void(e&&(e.ApplicationUrl&&Object(u.c)(Object(j.d)(e.ApplicationUrl,S),j.a,"bootException"),e.FnOnInitializeFailure&&e.FnOnInitializeFailure({errorType:g.a.AppInitError,errorObject:t})))}},e}();function Z(e){e.ULS.vo(590914655,o.a.$,r.a.Info,"Time spent logging: ".concat(e.getTimeSpentLogging()))}function X(e){return Object(i.a)(Object(i.a)(Object(i.a)({},e.AppInitDiagnostics),e.HostInitDiagnostics),{SessionTraces:e.SessionTraces})}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(0),o=n(8),r=n(17),s=n(1),c=n(2),a=n(28),u=n(3),d=n(13),f=function(e){function t(t,n,i,r,s){var c=e.call(this,t,n,i,r,s)||this;return c.Pc=function(e){var t={errorType:e.errorType,errorObject:e.errorObject};if(!t.errorType||!t.errorObject)throw new TypeError("Error object is missing errorType or errorObject");c.Ec&&c.Ec(t)},c.Uc=function(e){c.fc=e.newLevel,c.Lo(u.a.ZoomChanged,e)},c.Wc=function(e){c.Rc=e.newPage,c.Lo(u.a.PageChanged,e)},c.Fc=function(e){c.kc=e.isDisabled,c.Lo(u.a.IsDisabled,e)},c.Ko=s.innerApplicationFrame,c.ko=i,c.zo=n,c.Ro={},c.rc=s.isCore,c.Rc=s.currentPage,c.fc=s.zoomLevel,c.dc=s.pageCount,c.kc=!c.rc,c.ko.registerMessagePayloadHandler(o.a.tn,c.Uc),c.ko.registerMessagePayloadHandler(o.a.Et,c.Wc),c.ko.registerMessagePayloadHandler(o.a.vt,c.Fc),c.ko.registerMessagePayloadHandler(o.a.ut,c.Pc),c}return Object(i.c)(t,e),t.prototype.SetCurrentPage=function(e){var t=this;this.kc?this.Pc({errorType:d.a.ApiDisabledError,errorObject:{isCoreMode:this.rc}}):(this.Nc=e,this.ko.sendPostMessage(this.Ko,r.a.Qi,{newPage:this.Nc}),window.setTimeout((function(){t.Nc!==t.Rc&&t.zo.ULS.vo(596444179,s.a.H,c.a.Info,'Did not receive the page change update. {"RequestedPage": '+t.Nc+', "CurrentPage": '+t.Rc+"}")}),5e3))},t.prototype.GetPageCount=function(){return this.kc&&this.Pc({errorType:d.a.ApiDisabledError,errorObject:{isCoreMode:this.rc}}),this.dc},t.prototype.GetCurrentPage=function(){return this.kc&&this.Pc({errorType:d.a.ApiDisabledError,errorObject:{isCoreMode:this.rc}}),this.Rc},t.prototype.SetZoomLevel=function(e){var t=this;this.kc?this.Pc({errorType:d.a.ApiDisabledError,errorObject:{isCoreMode:this.rc}}):(this.Mc=Number(e.toFixed(2)),this.ko.sendPostMessage(this.Ko,r.a.Yi,{newLevel:this.Mc}),window.setTimeout((function(){t.Mc!==t.fc&&t.zo.ULS.vo(596444180,s.a.H,c.a.Info,'Did not receive the zoom change update. {"RequestedZoom": '+t.Mc+', "CurrentZoom": '+t.fc+"}")}),5e3))},t.prototype.GetZoomLevel=function(){return this.kc&&this.Pc({errorType:d.a.ApiDisabledError,errorObject:{isCoreMode:this.rc}}),this.fc},t.prototype.GetIsDisabled=function(){return this.kc},t.prototype.GetApplicationType=function(){return"Word Viewer"},t.prototype.RegisterEventHandler=function(e,t){switch(e){case u.a.ZoomChanged:case u.a.PageChanged:case u.a.IsDisabled:if(this.Ro[e])throw new Error("Duplicate registration");this.Ro[e]=t;break;default:this.ko.registerMessagePayloadHandler(e,t)}},t.prototype.RemoveEventHandler=function(e,t){switch(e){case u.a.ZoomChanged:case u.a.PageChanged:case u.a.IsDisabled:if(this.Ro[e]!==t)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.Ro[e];break;default:this.ko.removeMessageHandler(e)}},t.prototype.RegisterErrorHandler=function(e){this.Ec=e},t.prototype.RemoveErrorHandler=function(e){if(this.Ec!==e)throw new Error("The handler requested to be removed does not exist");delete this.Ec},t}(a.a);function l(e,t,n,i,o){return new f(e,t,n,i,o)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return me}));var i=n(83),o=n(0),r=n(8),s=n(52),c=n(1),a=n(2),u=function(e,t,n,i,u){return e!==r.a.Rt?Promise.reject("Wrong flow"):new Promise((function(e){n.pendingReboot=!0;var i=void 0;if(t.queryOverrides)try{i=JSON.parse(t.queryOverrides)}catch(e){n.logger.ULS.vo(592217694,c.a.$,a.a.Error,"Failed to parse queryOverrides: ".concat(i))}n.raiseEvent(s.a.Reboot,Object(o.a)(Object(o.a)({},t),{previousSessionId:n.sessionId,queryOverrides:i})),e({completion:"success"})}))},d=n(40),f=n(17);function l(e){return!(!(e&&e.source&&e.accessToken)||!e.expiry&&0!==e.expiry)}var h=n(86),p=n(29),v=n(56),b=n(21),m=n(43),w=n(57),O=n(7),g=n(11),j=n(19),S=n(9);function I(e,t,n){var i=Object(o.a)(Object(o.a)(Object(o.a)({},Object(O.r)(e.appUrl)),function(e){var t={};Object(O.a)(t,"jsapi","1"),Object(O.a)(t,"jsapiver","v2"),Object(O.a)(t,"corrid",e.sessionId),Object(O.a)(t,"usid",e.sessionId),Object(O.a)(t,"newsession","1"),Object(O.a)(t,"sftc","1"),e.hostSessionId&&Object(O.a)(t,"hid",encodeURIComponent(e.hostSessionId));var n=e.host;n.uiHostName&&Object(O.a)(t,"uih",n.uiHostName),n.uiHostIntegrationType&&Object(O.a)(t,"uihit",encodeURIComponent(n.uiHostIntegrationType)),n.metaUiHostVersion&&Object(O.a)(t,"muv",encodeURIComponent(n.metaUiHostVersion));var i=n.capabilities;i&&(i.accessibilityLoop&&Object(O.a)(t,"accloop","1"),i.rebootDoc&&Object(O.a)(t,"sdr",i.rebootDoc.toString()),i.createNewDoc&&Object(O.a)(t,"scnd","1"),i.authToken&&Object(O.a)(t,"sat","1"),i.customAuthConfig&&Object(O.a)(t,"cac","1"),i.refreshAccessToken&&Object(O.a)(t,"rat","1"),i.atMentions&&Object(O.a)(t,"sams","1"),i.moveToFolder&&Object(O.a)(t,"mtf","1"),i.noBrowserModalDialogs&&Object(O.a)(t,"nbmd","1"),i.commonFilePicker&&Object(O.a)(t,"sfp","1"),i.directDownload&&Object(O.a)(t,"sdd","1"),i.directPrint&&Object(O.a)(t,"sdp","1"));var o=e.ui;o.language&&Object(O.a)(t,"ui",encodeURIComponent(o.language)),o.uiEmbed&&Object(O.a)(t,"uiembed","1"),(o.hideHeader||"DocGen"===o.contentAssemblyMode||"Templatization"===o.contentAssemblyMode||"ContentAssemblyEdit"===o.contentAssemblyMode||"ContentAssemblyView"===o.contentAssemblyMode)&&Object(O.a)(t,"hhdr","1"),o.highContrast&&Object(O.a)(t,"hcm",encodeURIComponent(o.highContrast)),o.hideFileLocationPicker&&Object(O.a)(t,"hodflp","1"),o.hideAppLauncherInHeader&&Object(O.a)(t,"halh","1"),o.hideChatInHeader&&Object(O.a)(t,"hch","1"),o.hideMeInHeader&&Object(O.a)(t,"hmh","1"),o.hideSearchInHeader&&Object(O.a)(t,"hsh","1"),o.hideWorkflowInHeader&&Object(O.a)(t,"hwfh","1"),o.hideSettingsInHeader&&Object(O.a)(t,"hsth","1"),o.showAppIconInHeader&&Object(O.a)(t,"sih","1"),o.useNeutralColorInHeader&&Object(O.a)(t,"unh","1"),o.openLinksInNewWindow&&Object(O.a)(t,"onw","1"),o.useDarkTheme&&Object(O.a)(t,"udt","1"),"DocGen"!==o.contentAssemblyMode&&"ContentAssemblyView"!==o.contentAssemblyMode||Object(O.a)(t,"readOnly","1");var r=e.wopi;r&&r.source&&Object(O.a)(t,"wopisrc",encodeURIComponent(r.source));var s=e.bootParams;s&&(s.dataLanguage&&Object(O.a)(t,"rs",encodeURIComponent(s.dataLanguage)),s.readOnly&&Object(O.a)(t,"readonly","1"),s.disableChat&&Object(O.a)(t,"dchat","1"),s.cookieCompliant&&Object(O.a)(t,"mscc","1"),s.isNewFile&&(Object(O.a)(t,"new","1"),s.isFromHostTemplate&&Object(O.a)(t,"wdtpl","fromhost"))),e.user.isLicensed&&Object(O.a)(t,"islicenseduser","1"),e.user.isSynthetic&&Object(O.a)(t,"syn","1"),e.actNavId&&Object(O.a)(t,"actnavid",e.actNavId),e.sessionContext&&Object(O.a)(t,"sc",encodeURIComponent(e.sessionContext));var c=e.wdParams;if(c)for(var a in c)Object(O.a)(t,a,c[a]);var u=e.preseededSession;u&&(u.key&&Object(O.a)(t,"preseededsessionkey",encodeURIComponent(u.key)),u.id&&Object(O.a)(t,"preseededwacsessionid",encodeURIComponent(u.id)));var d=e.throttling;d&&(d.protection&&Object(O.a)(t,"ctp",d.protection),d.request&&Object(O.a)(t,"rct",d.request));var f=e.hostInitDiagnostics;f&&(f.entryPoint&&Object(O.a)(t,"wdorigin",encodeURI(f.entryPoint)),f.userClickTime&&Object(O.a)(t,"wdhostclicktime",f.userClickTime.toString()));var l=e.rebootOverride;return l&&l.previousSessionId&&Object(O.a)(t,"wdprevioussession",l.previousSessionId),Object(O.q)(t,"region"),t}(e)),n),r=e.rebootOverride;return r&&r.queryOverrides&&(i=Object(o.a)(Object(o.a)({},i),r.queryOverrides)),Object(O.d)(e.appBasePath,t,i)}var _=n(16),T=n(42),y=n(55),C=n(44),A=n(45),P=n(18),E=n(58),U=n(15),W=function(e,t,n,i,s){return e!==d.a.boot?Promise.reject("Wrong flow"):new Promise((function(e){var u,d=Object(_.a)();if(n.state=p.a.Booting,n.pendingReboot=!1,function(e,t,n){if(void 0===n&&(n=!1),!e)throw new TypeError("SessionBootParams");var i=e.appUrl,o=e.appBaseUrl;if(!i&&!o)throw new TypeError("Either appUrl or appBaseUrl should exist");if(i&&"string"!=typeof i)throw new TypeError("AppUrl");if(o&&"string"!=typeof o)throw new TypeError("AppBaseUrl");var r=e.file;if(!r||!n&&!r.name)throw new TypeError("FileInfo");var s=e.container;if(!s||!(s instanceof h.a)&&!s.appendChild)throw new TypeError("Container");if(!t&&!l(e.wopi))throw new TypeError("WopiInfo")}(t,n.skipWopiValidation,n.skipFileNameCheck),n.intent=t.intent,n.file=t.file,n.customFontCatalogUrl=t.customFontCatalogUrl,n.wopi=t.wopi,n.contentBundle=t.contentBundle,n.newFileTemplate=t.newFileTemplate,n.ownerId=t.ownerId,n.sessionContext=t.sessionContext,n.actNavId=t.actNavId,n.preseededSession=t.preseededSession,n.throttling=t.throttling,n.meeting=t.meeting,n.tenantId=t.tenantId,n.wdParams=function(e){return function(e,t){var n={};return t&&Object.keys(t).forEach((function(e){n[e.toLowerCase()]=t[e]})),e.split("&").forEach((function(e){if(/^wd\w+=.+/i.test(e)){var t=e.split("=");n[t[0].toLowerCase()]=t[1]}})),n}(window.location.search.substring(1),e)}(t.wdParams),n.pinnedTarget=t.pinnedTarget,n.rebootOverride=t.rebootOverride,n.bootParams=t.bootParams||{},n.hostInitDiagnostics=Object(o.a)(Object(o.a)({},t.diagnostics),{hostInitializeCallTime:d}),n.Hn.getValue(U.a.ti,!1)&&Object(T.a)(n.hostInitDiagnostics),t.appUrl){var W=t.appUrl;n.appUrl=W;var R=n.bootParams;Object(O.p)(W,"new")&&(R.isNewFile=!0),R.dataLanguage||(F=Object(O.l)(W,"rs"))&&(R.dataLanguage=F);var F,k=n.ui;if(Object(O.p)(W,"uiembed")&&(k.uiEmbed=!0),k.language||(F=Object(O.l)(W,"ui"))&&(k.language=F),!n.hostInitDiagnostics.entryPoint){var N=Object(O.l)(W,"wdorigin");N&&(n.hostInitDiagnostics.entryPoint=N)}if(!n.host.uiHostName){var M=Object(O.l)(W,"uih");M&&(n.host.uiHostName=M)}}else n.appUrl="";n.appBaseUrl=t.appBaseUrl?t.appBaseUrl.toLowerCase():Object(O.i)(t.appUrl).toLowerCase(),n.appBaseUrl=Object(O.u)(n.appBaseUrl,Object(O.k)(n.appUrl,"region")),n.Hn.updateEnvironment(n.appBaseUrl),i.initializeAppContext(n,e,t),n.appBasePath=i.buildAppBasePath(n);var x=!1,D=n.preseededSession;n.appInfo.usePreseededSessionId&&D&&D.id&&(n.sessionId=D.id,x=!0);var V,H=!1,J=t.hostGeneratedSessionId;if(!x&&J&&(n.sessionId=J,H=!0),t.rebootOverride&&(x||H||(u=Object(y.a)(),n.sessionId=u[0],V=u[1]),n.pageStateObserver=new C.a(n.logger,!0),n.authTokenTrustValidator=new A.a(n.logger)),n.logger.ULS.vo(38580693,c.a.$,a.a.Info,"User session id: ".concat(n.sessionId,", is preseeded: ").concat(x,", is host generated: ").concat(H)),n.remoteTelemetryUrl=i.buildRemoteTelemetryUrl(n),Object(v.c)(n.remoteTelemetryUrl,n.appInfo.name,"init"),!n.isLoggerFromOwl){var B=n.Hn.getValue(U.a.ei,"").toString();B||(B=Object(O.f)(n.appBasePath)),n.logger.configure({remoteUlsEndpoint:B,sessionId:n.sessionId})}if(n.Hn.initializePeriodicFetch(n.appBasePath,n.sessionId),V&&n.logger.ULS.vo(590966790,c.a.$,a.a.Info,JSON.stringify(V)),Object(T.f)(n),i.onContextReady&&i.onContextReady(n),n.appInitDiagnostics={officeSessionId:n.sessionId,officeBootstrapperVersion:Object(j.a)(),hostName:n.hostName,documentLoadedWithTabSwitch:"hidden"===document.visibilityState},document.addEventListener("visibilitychange",(function(){n.appInitDiagnostics.documentLoadedWithTabSwitch=!0}),{once:!0}),!n.container){var L=t.container;n.container=L instanceof h.a?L:n.application.createContainer(L)}n.container.setMessageHandler(n.onMessage);var z=!!i.ignoreCompletionMessage&&i.ignoreCompletionMessage(n),G=function(e,t){n.successTime=Object(_.a)(),z||(n.container.postMessage(f.a.Ti,void 0),Object(T.b)(n.appInitDiagnostics,t.Diagnostics)),n.Hn.addSettingsChangeListener(n.logger.settingsChangeHandler),i.onSuccess&&i.onSuccess(n,t),n.logger.ULS.vo(596448985,c.a.$,a.a.Info,JSON.stringify(n.diagnostics)),Object(v.c)(n.remoteTelemetryUrl,n.application.name,"bootSuccess"),n.logger.ULS.flush(),n.container.postMessage(f.a.Wi,{HostInitializeDiagnostics:n.hostInitDiagnostics,ClientDiagnostics:n.clientDiagnostics}),n.state=p.a.Booted,K({completion:"success"}),Object(T.g)(n.appInfo.name,n.logger)},q=function(e,t){var o;n.failureTime=Object(_.a)(),i.onFailure&&i.onFailure(n,t.Error),n.logger.ULS.vo(596448986,c.a.$,a.a.Error,JSON.stringify({error:t.Error,diagnostics:n.diagnostics})),Object(v.c)(n.remoteTelemetryUrl,n.application.name,"bootFailure"),n.logger.ULS.flush(),n.state=p.a.Failed,K({completion:"failure",error:t.Error,errorSource:"app",documentLoadedWithTabSwitch:null===(o=n.appInitDiagnostics)||void 0===o?void 0:o.documentLoadedWithTabSwitch}),Object(T.g)(n.appInfo.name,n.logger)},K=function(t){z||(n.bootHeartBeat&&n.bootHeartBeat.stop(),n.removeActionHandler(r.a.Qe,G),n.removeActionHandler(r.a.Xe,q)),e(t)};s&&s.subscribe((function(){var e;K({completion:s.reason||"cancelled",documentLoadedWithTabSwitch:null===(e=n.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch})})),z||(n.addActionHandler(r.a.Qe,G),n.addActionHandler(r.a.Xe,q)),function(e){return"wdjs"in e||"wd1js"in e}(n.wdParams)&&("true"!==window.sessionStorage.getItem("sideLoadingIsEnabled")?Object(P.d)("sideLoadingIsEnabled","false",0):Object(P.a)("sideLoadingIsEnabled",!1)||Object(P.d)("sideLoadingIsEnabled","true",1));var Z=i.buildBootRequestParams(n),X=I(n,Z.appPageName,Z.queryParamsOverrides),$=function(e,t){var n=function(e){var t={};Object(O.a)(t,"highdpi",String(window.devicePixelRatio>1.24)),Object(O.a)(t,"softblockedbrowser",String(Object(g.e)())),Object(O.a)(t,"hostname",e.hostName),Object(O.a)(t,"feature_status",Object(m.b)(e.featureManager,e.wdParams)),Object(O.a)(t,"jsapibuild",Object(j.a)());var n=e.wopi;n&&(Object(O.a)(t,"access_token",n.accessToken),Object(O.a)(t,"access_token_ttl",n.expiry.toString()),n.wacToken&&Object(O.a)(t,"wac_token",n.wacToken));var i=e.customFontCatalogUrl;i&&Object(O.a)(t,"customfontcatalogurl",i);var o=e.contentBundle;if(o){if(o.url){Object(O.a)(t,"bundlesrc",o.url);var r=o.staleness,s=null!=r;s&&Object(O.a)(t,w.a.Vr,r.toString()),e.logger.ULS.vo(577783775,c.a.$,a.a.Info,"Content bundle staleness: "+(s?r:"N/A"))}o.urlNoAuth&&Object(O.a)(t,"bundleurlnoauth",o.urlNoAuth),o.bundleCode&&Object(O.a)(t,"bundlecode",o.bundleCode)}var u=e.file,d=u.name;if(d){Object(O.a)(t,"filename",d);var f=Object(S.a)(d);f&&Object(O.a)(t,"fileextension",f)}u.getUrl&&Object(O.a)(t,"filegeturl",u.getUrl),u.downloadCode&&Object(O.a)(t,"filedownloadcode",u.downloadCode),u.urlNoAuth&&Object(O.a)(t,"fileurlnoauth",u.urlNoAuth),u.size&&Object(O.a)(t,"filesize",u.size.toString()),u.eTag&&Object(O.a)(t,"etag",u.eTag),u.cTag&&Object(O.a)(t,"revid",u.cTag),u.uniqueId&&Object(O.a)(t,"docid",u.uniqueId),void 0!==u.immutableReason&&Object(O.a)(t,"immutableReason",u.immutableReason.toString()),void 0!==u.supportsZipIt&&Object(O.a)(t,"supports_zipit",u.supportsZipIt.toString());var l=e.newFileTemplate;l&&(l.getUrl&&Object(O.a)(t,"templateurl",l.getUrl),l.size&&Object(O.a)(t,"filesize",l.size.toString()),l.eTag&&Object(O.a)(t,"etag",l.eTag),l.uniqueId&&Object(O.a)(t,"docid",l.uniqueId)),e.user.id&&Object(O.a)(t,"user_id",e.user.id),e.ownerId&&Object(O.a)(t,"owner_id",e.ownerId),e.sessionContext&&Object(O.a)(t,"sc",e.sessionContext);var h=e.ui;h.controls&&Object(O.a)(t,"huictrls",JSON.stringify(h.controls)),"Templatization"!==h.contentAssemblyMode&&"DocGen"!==h.contentAssemblyMode&&"ContentAssemblyEdit"!==h.contentAssemblyMode&&"ContentAssemblyView"!==h.contentAssemblyMode||Object(O.a)(t,"caae","1"),h.contentAssemblyMode&&Object(O.a)(t,"caaemode",h.contentAssemblyMode);var p=e.meeting;p&&(p.id&&Object(O.a)(t,"meetingId",p.id),p.title&&Object(O.a)(t,"meetingTitle",p.title),p.type&&Object(O.a)(t,"meetingType",p.type),p.scheduledStartTime&&Object(O.a)(t,"scheduledStartTime",p.scheduledStartTime),p.scheduledEndTime&&Object(O.a)(t,"scheduledEndTime",p.scheduledEndTime),p.isPresenter&&Object(O.a)(t,"isPresenter",p.isPresenter.toString()),p.organizerId&&Object(O.a)(t,"meetingOrganizerId",p.organizerId),p.joinUrl&&Object(O.a)(t,"meetingJoinUrl",encodeURIComponent(p.joinUrl)),p.isMeetingTeamsRoom&&Object(O.a)(t,"isMeetingTeamsRoom",p.isMeetingTeamsRoom.toString()));var v=e.host;return v.owlVersion&&Object(O.a)(t,"owlver",v.owlVersion),v.owlRollout&&Object(O.a)(t,"owlro",v.owlRollout),t}(e);return Object.keys(t).forEach((function(e){t[e]?n[e]=t[e]:delete n[e]})),n}(n,Z.postDataOverrides);if(n.bootstrapperUrl&&n.preconnector&&n.preconnector.shouldPreconnect(n.hostName)&&n.preconnector.preconnect(n.bootstrapperUrl),n.bootstrapperUrl&&n.preloader&&n.preloader.shouldPreload(X,n.host.origin))try{i.beforePreload&&i.beforePreload(n);var Q=n.bootstrapperUrl;n.featureManager.isFeatureEnabled(b.a.jo)&&(n.logger.ULS.vo(590966791,c.a.$,a.a.Info,"HTTP2 preload enabled"),Q=Object(O.v)(Q)),n.preloader.preload(Q,n.ui.language,n.logger,n.featureManager)}catch(e){n.logger.ULS.vo(590966792,c.a.$,a.a.Error,"Error preloading")}i.beforeContainerBoot&&i.beforeContainerBoot(n,X),n.appInitDiagnostics.officeFrameCreateTime=Object(_.a)(),n.container.boot(X,$,n.logger,i.buildContainerBootParams(n)),z?G(r.a.Qe,{Diagnostics:{}}):(n.bootHeartBeat=new E.a(Object(O.n)(n.appBaseUrl),n.Hn,n.logger,(function(){var e;n.timeoutTime=Object(_.a)(),i.onTimeout&&i.onTimeout(n),Object(v.c)(n.remoteTelemetryUrl,n.application.name,"bootTimeout"),K({completion:"timeout",error:{documentLoadedWithTabSwitch:null===(e=n.appInitDiagnostics)||void 0===e?void 0:e.documentLoadedWithTabSwitch}}),s&&s.cancel()}),s&&i.overrideBootTimeout?Math.min(s.timeoutInMs,i.overrideBootTimeout(n)):s?s.timeoutInMs:i.overrideBootTimeout?i.overrideBootTimeout(n):void 0),i.beforeBootCompletionMessage&&i.beforeBootCompletionMessage(n))})).catch((function(e){throw n.failureTime=Object(_.a)(),i.onException&&i.onException(n,e),n.remoteTelemetryUrl&&Object(v.c)(n.remoteTelemetryUrl,n.application.name,"bootException"),n.bootHeartBeat&&n.bootHeartBeat.stop(),{error:e.toString(),errorStack:e.stack}}))},R=function(e,t,n){return new Promise((function(t){n.logger.ULS.vo(590111070,c.a.$,a.a.Error,"Unsupported flow: ".concat(e)),t({completion:"failure"})}))},F=n(63),k=function(e,t,n,i,s){return e!==d.a.createNew?Promise.reject("Wrong flow"):new Promise((function(u){var h={wopiPendingInitializeTime:Object(_.a)()},v=!!(i&&i.parallelizeStartSessionRequest&&i.buildStartSessionRequestParams)&&i.parallelizeStartSessionRequest(n),b=!1,m=!1,w=!1,O=!1,j=void 0,S=void 0,y=!1,C=!1;if(Object(g.d)()||i&&i.fallBackToSingleStepBootFlow&&i.fallBackToSingleStepBootFlow(n,t))!function(){n.logger.ULS.vo(578074079,c.a.$,a.a.Info,"Waiting for WOPI info to start boot");var e=function(e,r){if(b)n.logger.ULS.vo(578074080,c.a.$,a.a.Warning,"completeCreateNew already called");else{if(b=!0,h.wopiPendingCompleteTime=Object(_.a)(),"failure"===r.state)return H(r.reason),n.state=p.a.Failed,void i({completion:"failure"});N(r.newFile),n.run(d.a.boot,Object(o.a)(Object(o.a)({},t),{wopi:r.wopi}),s).then((function(e){i(e)}))}};n.addActionHandler(d.a.completeCreateNew,e);var i=function(t){n.removeActionHandler(d.a.completeCreateNew,e),u(t)};s&&s.subscribe((function(){i({completion:"cancelled"})}))}();else{var A=function(e,t){b?n.logger.ULS.vo(587236372,c.a.$,a.a.Warning,"completeCreateNew already called"):(b=!0,h.wopiPendingCompleteTime=Object(_.a)(),"failure"!==t.state?l(j=t.wopi)?(n.wopi=j,n.logger.ULS.vo(587286030,c.a.$,a.a.Info,"WOPI info received. Access token: "+JSON.stringify({length:j.accessToken.length,expiry:j.expiry})+", current state: "+JSON.stringify({parallelizeStartSessionRequest:v,wacFrameLoaded:m,wacCanAcceptStartSessionResponse:w})),!v||m&&!w?m&&k():E(),m&&n.container&&n.container.postMessage(f.a.no,void 0),N(t.newFile)):P("InvalidWopiInfo"):P(t.reason))},P=function(e){H(e),m&&n.container&&n.container.postMessage(f.a.eo,void 0)},E=function(){n.logger.ULS.vo(587233056,c.a.$,a.a.Info,"Making parallelized StartSession request");var t=i.buildStartSessionRequestParams(n,e,j),o=I(n,t.appPageName,t.queryParamsOverrides),r="access_token="+encodeURIComponent(j.accessToken)+"&access_token_ttl="+encodeURIComponent(j.expiry.toString());h.startSessionStartTime=Object(_.a)(),Object(F.a)(o,r,{"Content-Type":"application/x-www-form-urlencoded"},U)},U=function(e){var t=Object(_.a)();h.startSessionCompleteTime=t,n.logger.ULS.vo(587233057,c.a.$,a.a.Info,"StartSession request completed. Status code: ".concat(e.status,", time: ").concat(t)),S={RequestStatus:e.status,ResponseText:e.responseText},m&&w?R():n.logger.ULS.vo(587233058,c.a.$,a.a.Info,"StartSession response not yet sent: "+JSON.stringify({wacFrameLoaded:m,wacCanAcceptStartSessionResponse:w,wopiInfoSent:y,startSessionResponseSent:C}))},W=function(e,t){h.readyMessageReceiveTime=Object(_.a)(),n.container&&n.container.postMessage(f.a.ji,void 0),m||(m=!0,w=t.CanAcceptStartSessionComplete,n.logger.ULS.vo(587321567,c.a.$,a.a.Info,"App ready: "+JSON.stringify({parallelizeStartSessionRequest:v,wacCanAcceptStartSessionResponse:w,startSessionResponseAvailable:!!S,wopiInfoAvailable:!!j})),b&&n.container&&n.container.postMessage(j?f.a.no:f.a.eo,void 0),v&&w?R():k(),Object(T.b)(n.appInitDiagnostics,t.Diagnostics))},R=function(){C||y||!S||(200===S.RequestStatus?(C=!0,h.completeMessageCreateTime=Object(_.a)(),M(f.a.yi,{StartSessionResponse:S,Diagnostics:h},3)):k())},k=function(){C||y||!j||(y=!0,h.completeMessageCreateTime=Object(_.a)(),i&&i.sendCreateNewWopiInfo?i.sendCreateNewWopiInfo(n):M(f.a.Ci,{WopiDetails:{WopiSrc:j.source,AccessToken:j.accessToken,AccessTokenTtl:j.expiry.toString()},Diagnostics:h},3))},M=function(e,t,i){var o=Object(_.a)();i<=0?n.logger.ULS.vo(587233165,c.a.$,a.a.Error,"Attempted to complete but no ack. Time: ".concat(o)):(n.logger.ULS.vo(587233166,c.a.$,a.a.Info,"Sending complete message. Retries left: ".concat(i-1,", Time: ").concat(o)),h.completeMessageSendTime=o,n.container&&n.container.postMessage(e,t),window.setTimeout(x,1e3,e,t,i-1))},x=function(e,t,i){O||(n.logger.ULS.vo(587233167,c.a.$,a.a.Info,"Timeout session complete ack. Retries left: ".concat(i)),M(e,t,i))},D=function(e,t){O=!0},V=function(e){n.removeActionHandler(d.a.completeCreateNew,A),n.removeActionHandler(r.a.Ze,W),n.removeActionHandler(r.a.Vt,D),u(e)};n.addActionHandler(d.a.completeCreateNew,A),n.addActionHandler(r.a.Ze,W),n.addActionHandler(r.a.Vt,D),s&&s.subscribe((function(){V({completion:"cancelled"})})),n.skipWopiValidation=!0,n.skipFileNameCheck=!0,n.wopi=void 0,n.run(d.a.boot,t,s).then((function(e){n.skipWopiValidation=!1,n.wopi=j,V(e)}))}function H(e){n.logger.ULS.vo(596444188,c.a.$,a.a.Warning,"Fail with reason: "+(e?JSON.stringify(e):"N/A"))}}))};function N(e){e&&(e.path&&history.replaceState({},"",e.path),e.title&&(document.title=e.title))}var M=n(53),x=function(e,t,n,i,o){return e!==d.a.dispose?Promise.reject("Wrong flow"):new Promise((function(e){n.logger.ULS.vo(595714433,c.a.$,a.a.Info,"start disposing the application");var s=n.host.requireExplicitUnload,u={disposeStartTime:Object(_.a)(),forceAppUnload:s};n.state=p.a.Disposing;var d=function(){n.state=p.a.Disposed,e({completion:"success"})},l=function(e){i&&i.disposeAppSpecificResources&&i.disposeAppSpecificResources(n,t),n.dispose(),u.disposeEndTime=Object(_.a)(),function(e,t,n){if(n){var i=Number(n.hostMessageReceived);t.appUnloadStartTime&&!isNaN(i)&&(t.hostToAppPostMessageLatency=i-t.appUnloadStartTime);var o=Number(n.appMessageSent);!isNaN(o)&&t.appUnloadEndTime&&(t.appToHostPostMessageLatency=t.appUnloadEndTime-o);var r=Number(n.appUnloadStart),s=Number(n.appUnloadEnd);if(isNaN(r)||isNaN(s)||(t.appUnloadLatency=s-r),n.serverTimings){var u=n.serverTimings;for(var d in u)t["st-"+d.toString()]=u[d]}}e.logger.ULS.vo(592524822,c.a.$,a.a.Info,"App disposed: "+JSON.stringify(t)),e.logger.ULS.flushOnClose()}(n,u,e),n.container?n.container.dispose(n.pendingReboot,s).then(d):d()};s?(u.appUnloadStartTime=Object(_.a)(),n.addActionHandler(r.a.Gt,(function(e,t){u.appUnloadEndTime=Object(_.a)(),l(t)})),(o||new M.a(5e3)).subscribe((function(){n.state===p.a.Disposing&&(u.appUnloadTimedOut=!0,l())})),n.container&&n.container.postMessage(f.a.oo,void 0)):l()}))},D=function(e,t,n,i,o){return e!==r.a.bt?Promise.reject("Wrong flow"):new Promise((function(e){if(n.host.capabilities&&n.host.capabilities.frameTrustCheck)n.raiseEvent(s.a.FrameTrust,t);else{var i=!!n.container&&n.container.isTopFrameTrusted;n.logger.ULS.vo(592445957,c.a.$,a.a.Info,"Top frame is trusted: ".concat(i)),n.container&&n.container.postMessage(f.a.bt,{isTopFrameTrusted:i})}e({completion:"success"})}))},V=function(e,t,n,i,o){return e!==r.a.Ot?Promise.reject("Wrong flow"):new Promise((function(e){n.authTokenTrustValidator.isResourceTrustedForMessage(t).then((function(i){i?n.raiseEvent(s.a.GetAuthToken,t):(n.container.postMessage(f.a.Li,{AuthToken:"",Error:"accessDenied",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"success"}))}),(function(i){n.container.postMessage(f.a.Li,{AuthToken:"",Error:"Exception encountered in AuthTokenTrustValidator.isResourceTrustedForMessage",RequestId:t.RequestId,IdentityType:t.IdentityType}),e({completion:"failure",error:i})}))}))},H=n(61),J=function(e,t,n,i,o){return e!==r.a.$e?Promise.reject("Wrong flow"):new Promise((function(e){var o=t&&t.state?t.state:"Unknown";n.logger.ULS.vo(592839750,c.a.$,a.a.Info,"Boot state: [".concat(o,"]")),i&&i.beforeComplete&&i.beforeComplete(o),e({completion:"success"})}))},B=function(e,t,n,i,o){if(e!==d.a.postWacToken)return Promise.reject("Wrong flow");var s=Object(_.b)();return n.logger.ULS.vo(507774685,c.a.$,a.a.Important,"postWacToken flow initiated"),new Promise((function(e){var i=function(e,t){n.logger.ULS.vo(507597017,c.a.$,a.a.Info,"postWacToken flow completed in ".concat(Object(_.b)()-s," ms")),window.clearInterval(d),window.clearTimeout(l);var i={completion:"success"};t&&void 0!==t.TokenAlreadySet&&(i.data={TokenAlreadySet:t.TokenAlreadySet}),o(i)},o=function(t){n.removeActionHandler(r.a.Mn,i),e(t)},u=function(){var e;return null===(e=n.container)||void 0===e?void 0:e.postMessage(f.a.po,t)};n.addActionHandler(r.a.Mn,i),u();var d=window.setInterval(u,100),l=window.setTimeout((function(){window.clearInterval(d),n.logger.ULS.vo(507844190,c.a.$,a.a.Warning,"postWacToken flow timed out after ".concat(6e4," milliseconds")),o({completion:"timeout"})}),6e4)}))},L=function(e,t,n,i,o){return e!==d.a.rename?Promise.reject("Wrong flow"):new Promise((function(e){var i=function(e,n){var i={completion:n.NewName===t.NewName?"success":"failure"};c(i)},s=function(e,t){c({completion:"failure"})},c=function(t){n.removeActionHandler(r.a.lt,i),n.removeActionHandler(r.a.ht,s),e(t)};n.addActionHandler(r.a.lt,i),n.addActionHandler(r.a.ht,s),(o||new M.a(5e3)).subscribe((function(){c({completion:"cancelled"})})),n.container&&n.container.postMessage(f.a.Ji,t)}))},z=n(60),G=n(59),q=n(62),K=function(e,t,n,i,o){return e!==d.a.switchMode?Promise.reject("Wrong flow"):new Promise((function(e){var i=function(e,t){s({completion:"success"})},s=function(t){n.removeActionHandler(r.a.Tt,i),e(t)};n.addActionHandler(r.a.Tt,i),(o||new M.a(5e3)).subscribe((function(){s({completion:"cancelled"})})),n.container&&n.container.postMessage(f.a.io,t)}))};function Z(e){var t=e.appContext;t.canSupportConsumption=!1,t.isUnifiedRead=!1}var X=n(4),$=n(24);function Q(e){var t=Object(X.b)(e.appUrl),n=e.rebootOverride;if(n){var i=n.mode;i&&("view"===(i=i.toLowerCase())&&t?e.appBaseUrl=Object(X.d)(e.appBaseUrl):"edit"!==i||t||(e.appBaseUrl=Object(X.e)(e.appBaseUrl)))}else{var o=!(!e.ui||!e.ui.uiEmbed),r=o&&!(!e.bootParams||!e.bootParams.readOnly),u=Object(O.p)(e.appUrl,"embed"),d=e.Hn.getValue(U.a.Qn,!1)&&e.featureManager.isFeatureEnabled(b.a.Eo)&&!u&&(e.bootParams&&e.bootParams.isNewFile&&!e.wopi||e.file&&"docx"===Object(S.a)(e.file.name))&&Object(T.d)(e.host.storageHostName)&&!o&&!(e.wdParams&&"1"===e.wdParams.wdembedfs);e.appContext.canSupportConsumption=d,!d||t||Object(P.a)($.a.Wo,!1)||Object(T.e)(e.throttling?e.throttling.request:void 0,e.Hn.getValue(U.a.Yn,"Major"))?(t&&!r||e.raiseEvent(s.a.ModeSwitched,{NewMode:"view"}),t&&r&&(e.appBaseUrl=Object(X.d)(e.appBaseUrl))):(e.appBaseUrl=Object(X.e)(e.appBaseUrl),e.appContext.isUnifiedRead=!0,e.logger.ULS.vo(559285716,c.a.$,a.a.Info,"Redirecting Viewer request to unified read"))}return t=Object(X.b)(e.appUrl),e.appBaseUrl+(t?X.f:X.i)}function Y(e){return Object(O.e)(e.appBasePath,e.sessionId)}function ee(e){var t;if(e.Hn.getValue(U.a.li,!1))try{if(e.hostInitDiagnostics&&e.hostInitDiagnostics.hostPageNavigationType&&window&&window.localStorage)if(null===(t=e.file)||void 0===t?void 0:t.uniqueId){var n="sessionRefreshDocId_"+e.file.uniqueId;switch(e.hostInitDiagnostics.hostPageNavigationType){case"RELOAD":null!=window.localStorage.getItem(n)?e.logger.ULS.vo(507352900,c.a.$,a.a.Warning,"sessionRefreshDiagnostics: "+JSON.stringify(window.localStorage.getItem(n))):e.logger.ULS.vo(507324560,c.a.$,a.a.Warning,"sessionRefreshDiagnostics: Successful previous session");var i={previousSessionId:e.sessionId,previousHostSessionId:e.hostSessionId,navigationType:e.hostInitDiagnostics.hostPageNavigationType};window.localStorage.setItem(n,JSON.stringify(i));break;default:if(null==window.localStorage.getItem(n)){var o={previousSessionId:e.sessionId,previousHostSessionId:e.hostSessionId,navigationType:e.hostInitDiagnostics.hostPageNavigationType};window.localStorage.setItem(n,JSON.stringify(o))}}}else e.logger.ULS.vo(507274849,c.a.$,a.a.Warning,"No fileId provided");else e.logger.ULS.vo(507274848,c.a.$,a.a.Warning,"hostPageNavigationType not available")}catch(t){e.logger.ULS.vo(507340190,c.a.$,a.a.Warning,"Error Thrown during logSessionRefreshDiagnostics with error "+t)}}function te(e,t,n){var i=Object(X.b)(e.appUrl),o=i?t===d.a.createNew?X.h:X.g:X.j,r={},s=e.viewMode;s&&(s.hideToolbar&&Object(O.a)(r,i?"hvt":"core","1"),s.hideBreadCrumb&&Object(O.a)(r,"hbcv","1"),s.hideTitle&&Object(O.a)(r,"htv","1"),s.disableFocusOnBoot&&Object(O.a)(r,"disablefocusonboot","1"),s.forceAccessibilityMode&&!s.hideToolbar&&Object(O.a)(r,"wdaccpdf","1"));var c=e.ui;c&&c.inAppDocPreview&&Object(O.a)(r,"inappdocpreview","1");var a=e.wopi,u=e.bootParams;return i&&(a?u&&u.isNewFile||(e.appContext.canSupportConsumption&&Object(O.a)(r,"csc","1"),e.appContext.isUnifiedRead?(Object(O.a)(r,"cons","1"),Object(O.a)(r,"readonly","1")):Object(O.a)(r,"instantedit","1"),Object(O.a)(r,"wopicomplete","1")):(Object(O.a)(r,"instantedit","1"),Object(O.a)(r,"filesrc",encodeURIComponent(e.hostName)),Object(O.a)(r,"pmorigin",encodeURIComponent(Object(O.i)(window.location.href)))),t===d.a.createNew&&(Object(O.q)(r,"newsession"),Object(O.a)(r,"build",encodeURIComponent(Object(j.a)())),Object(O.a)(r,"wacusertype","WOPI"),e.file.getUrl&&Object(O.a)(r,"filegeturlpresent","1"),n&&Object(O.a)(r,"wopisrc",encodeURIComponent(n.source)))),a&&Object(O.a)(r,"wdredirectionreason",function(e,t,n,i){return e?"Unified_SingleFlush":t?"Unified_IrmEnabled":n&&i?"Unified_UiEmbedReadOnly":"Unified_ViewActionUrl"}(i,!(!u||!u.irmEnabled),!(!c||!c.uiEmbed),!(!u||!u.readOnly))),{appPageName:o,queryParamsOverrides:r,postDataOverrides:{}}}function ne(e,t,n,i,r){if(e.Hn.getValue(U.a.di,!1)){var s=function(e,t,n,i,r){var s,c,a=function(e){var t,n,i,o,r,s,c,a,u,d,f,l,h=Object(X.a)(e),p=Object(T.d)(e.hostName)||(null===(t=e.wopi)||void 0===t?void 0:t.source)&&Object(T.d)(null===(n=e.wopi)||void 0===n?void 0:n.source)?"SharePoint Online":(null===(i=e.wopi)||void 0===i?void 0:i.source)&&function(e){return/\.microsoftpersonalcontent(ppe)?\./i.test(e)}(null===(o=e.wopi)||void 0===o?void 0:o.source)?"SharePoint Online Consumer":e.host.storageHostName;return"OneDrive"===p&&(p="OneDriveWOPI"),{a:e.appInfo.name||"Unknown",b:e.ui.language||"Unknown",c:h.AppMode||"Unknown",d:h.AppModeExtended||"Unknown",e:"",f:e.clientDiagnostics.browser||"Unknown",g:"",h:"",i:"",j:"",k:(null===(r=e.appInitDiagnostics)||void 0===r?void 0:r.officeAppEndpoint)||"Unknown",l:"",m:"",n:p||"Unknown",o:!1,p:e.user.isLicensed||!1,q:!1,r:e.user.isSynthetic||!1,s:e.ownerId||e.user.id||"Unknown",t:e.tenantId||"Unknown",u:(null!==(a=null===(c=null===(s=e.wdParams)||void 0===s?void 0:s.wdjs)||void 0===c?void 0:c.length)&&void 0!==a?a:0)>0?"-5":"",v:"",w:e.sessionId||"Unknown",x:(null===(u=e.hostInitDiagnostics)||void 0===u?void 0:u.entryPoint)||"Unknown",y:e.tenantId||"Unknown",z:e.host.uiHostName||"Unknown",aa:(null===(d=e.appInitDiagnostics)||void 0===d?void 0:d.officeServerVersion)||"Unknown",ab:(null===(f=e.file)||void 0===f?void 0:f.name)?Object(S.a)(null===(l=e.file)||void 0===l?void 0:l.name):"Unknown",ac:e.host.uiHostIntegrationType||"Unknown",ad:"",ae:!1,af:e.clientDiagnostics.netDownlink,ag:e.clientDiagnostics.netDownlinkMax,ah:e.clientDiagnostics.netEffectiveType||"Unknown",ai:e.clientDiagnostics.netRtt,aj:e.clientDiagnostics.netSaveData,ak:e.clientDiagnostics.netType||"Unknown",al:""}}(e),u=function(e,t,n,i,r,s,c,a){var u={AreaName:"Boot",FeatureName:"JSAPI",SkipAria:"True"};return s&&!isNaN(Number(s))&&(u.BsqmErrorCode=s),{n:"Boot",e:i,t:oe.FailureBased,a:!0,f:"wordwebsxfc",k:s?{n:s}:void 0,p:Object(o.a)(Object(o.a)({},u),c),d:a?Math.round(a):void 0}}(0,0,0,t,0,n,i,r),d={},f=e.appBaseUrl?null===(s=Object(O.m)(e.appBaseUrl))||void 0===s?void 0:s.toUpperCase():void 0;f&&(d.ComplianceRegion=f);var l=function(e){if(e){var t=ce.exec(e);return t&&t.length>1?t[1]:void 0}}(null===(c=e.wopi)||void 0===c?void 0:c.source);return l&&(d.HostDatacenterHint=l),{d:a,k:[u],a:d}}(e,t,n,i,r);Object(v.b)(e.remoteTelemetryUrl,v.a.H_V2,s)}}var ie,oe,re,se,ce=new RegExp("^[a-z+.-]+://([^/:]*(:[0-9]{1,5})?)","i");function ae(e){var t,n,i=(null===(t=e.hostInitDiagnostics)||void 0===t?void 0:t.hostInitializeCallTime)?e.successTime-(null===(n=e.hostInitDiagnostics)||void 0===n?void 0:n.hostInitializeCallTime):0;if(ne(e,ie.Success,void 0,void 0,i),e.Hn.getValue(U.a.li,!1)&&function(e){var t;try{localStorage&&(null===(t=e.file)||void 0===t?void 0:t.uniqueId)&&null!=localStorage.getItem("sessionRefreshDocId_"+e.file.uniqueId)&&localStorage.removeItem("sessionRefreshDocId_"+e.file.uniqueId)}catch(t){e.logger.ULS.vo(507340188,c.a.$,a.a.Warning,"Error Thrown during removeEntryFromLocalStorage with error "+t)}}(e),ue(),se){e.container&&e.container.postMessage(f.a.Ei,{HostCacheLoadTime:se});var o=e.appInitDiagnostics;o.documentLoadedTime?se<o.documentLoadedTime?(o.documentLoadedTime=se,o.documentLoadedFromWopiPrecheckInfo=!0,e.logger.ULS.vo(577843782,c.a.$,a.a.Info,"First page loaded from cache was faster")):o.documentLoadedFromWopiPrecheckInfo=!1:o.documentLoadedTime=se}}function ue(){re&&re.parentElement&&re.parentElement.removeChild(re)}function de(e,t){!function(e,t){var n={storageHost:e.host.storageHostName||"",uiHost:e.host.uiHostName||Object(O.k)(t,"uih"),wdOrigin:e.hostInitDiagnostics.entryPoint||Object(O.k)(t,"wdorigin")};e.logger.ULS.vo(561629318,c.a.$,a.a.Info,JSON.stringify(n))}(e,t),function(e){if(!Object(X.b)(e.appUrl)){e.logger.ULS.vo(577843778,c.a.$,a.a.Info,"Boot Word viewer");var t=window.navigator.userAgent;if(!(t.indexOf("Mobi")>=0&&t.indexOf("iPad")<0)){var n=e.rebootOverride;if(!n||!n.reason||"translate"!==n.reason.toLowerCase()){var i=e.viewMode;if(!i||!i.forceAccessibilityMode){var o=e.contentBundle;if(o&&o.url){var r=e.container;if(r){var s=r.element,u=s.ownerDocument;if(u){e.logger.ULS.vo(577843779,c.a.$,a.a.Info,"Kick off first page optimization"),(re=u.createElement("div")).id="FirstPageContainer",re.style.top=i&&i.hideToolbar?"0":"90px",re.style.left="0",re.style.textAlign="center",re.style.width="1px",re.style.bottom="0",re.style.zIndex="900",re.style.height="1px",re.style.position="absolute",re.style.padding="0 29px",re.style.right="0",re.style.overflow="auto",re.style.marginLeft="auto",re.style.marginRight="auto",re.style.maxWidth="100%",s.appendChild(re);var d=u.createElement("img");d.id="FirstPageImage",d.style.marginTop="11px",d.style.marginBottom="11px",d.style.maxWidth="100%",d.style.border="solid 1px #d2d5d8",d.draggable=!1,d.onload=function(){e.logger.ULS.vo(577843780,c.a.$,a.a.Info,"First page optimization loaded"),re.style.width="",re.style.height="",se=Object(_.a)()},d.onerror=function(t){ue(),e.logger.ULS.vo(577843781,c.a.$,a.a.Warning,"Cannot load first page from cache"),e.appInitDiagnostics.errorObject={errorType:"CannotLoadFirstPage",errorObject:"string"==typeof t?t:t.returnValue}},d.src=o.url.replace("{0}","p1.img"),re.appendChild(d)}}}}}}}}(e),ne(e,ie.Usage)}function fe(e){var t=e.appBaseUrl,n=Object(X.b)(e.appUrl),i=Object(g.b)()===g.a.Firefox&&"OneDrive"===e.hostName&&e.host.origin&&"https://onedrive.live.com"===e.host.origin.toLowerCase();return n&&i&&(t+=" "+(e.host.origin&&e.host.origin.toLowerCase())),{permissionsPolicy:"microphone ".concat(t,"; autoplay ").concat(e.appBaseUrl,"; camera ").concat(e.appBaseUrl,"; clipboard-read ").concat(e.appBaseUrl,"; clipboard-write ").concat(e.appBaseUrl,"; keyboard-map ").concat(e.appBaseUrl,"; display-capture ").concat(e.appBaseUrl)}}function le(e){return!(!e||void 0===e.indexOf||!(e.indexOf("Failed to load resource")>-1||e.indexOf("Resource failed to load")>-1))}function he(e,t){var n,i,o={WacFailed:"True"};t.errorObject&&(o.ErrorObject=Object(S.b)(t.errorObject));var r=(null===(n=e.hostInitDiagnostics)||void 0===n?void 0:n.hostInitializeCallTime)?e.failureTime-(null===(i=e.hostInitDiagnostics)||void 0===i?void 0:i.hostInitializeCallTime):0;ne(e,ie.Failure,function(e){var t=e,n="JsApiUnknownError";return void 0!==e.errorObject&&null!==e.errorObject&&void 0!==e.errorObject.errorCode?n=e.errorObject.errorCode:t.errorCode?n=t.errorCode:void 0!==e.errorObject&&null!==e.errorObject&&void 0!==e.errorObject.errorType?n=e.errorObject.errorType:e.errorType?n=le(e.errorObject)?"JsApiResourceLoadError":e.errorType:le(t)&&(n="JsApiResourceLoadError"),n}(t),o,r),e.Hn.getValue(U.a.li,!1)&&function(e,t){var n,i;try{if(localStorage&&(null===(n=e.file)||void 0===n?void 0:n.uniqueId)){var o="sessionRefreshDocId_"+(null===(i=e.file)||void 0===i?void 0:i.uniqueId),r=localStorage.getItem(o);if(r){var s=JSON.parse(r);s.failureInfo=JSON.stringify(t),localStorage.setItem(o,JSON.stringify(s))}}}catch(t){e.logger.ULS.vo(507340189,c.a.$,a.a.Warning,"Error Thrown during logSessionRefreshFailure with error "+t)}}(e,t)}function pe(e){var t,n=(null===(t=e.hostInitDiagnostics)||void 0===t?void 0:t.hostInitializeCallTime)?e.timeoutTime-e.hostInitDiagnostics.hostInitializeCallTime:0;ne(e,ie.Failure,"JsApiTimeout",{TimeoutTime:n},n),e.Hn.getValue(U.a.li,!1)&&function(e,t){var n,i;try{if(localStorage&&window.localStorage&&(null===(n=e.file)||void 0===n?void 0:n.uniqueId)){var o="sessionRefreshDocId_"+(null===(i=e.file)||void 0===i?void 0:i.uniqueId),r=localStorage.getItem(o);if(r){var s=JSON.parse(r);s.timeoutInfo=t,localStorage.setItem(o,JSON.stringify(s))}}}catch(t){e.logger.ULS.vo(507274847,c.a.$,a.a.Warning,"Error Thrown during logSessionTimeout with error "+t)}}(e,n)}function ve(e,t){var n,i,o=t instanceof Error?t.name:"JsApiException",r={ErrorObject:Object(S.b)(t)};t instanceof Error&&(r.ErrorMessage=t.message);var s=(null===(n=e.hostInitDiagnostics)||void 0===n?void 0:n.hostInitializeCallTime)?e.failureTime-(null===(i=e.hostInitDiagnostics)||void 0===i?void 0:i.hostInitializeCallTime):0;ne(e,ie.Failure,o,r,s)}function be(){return!0}!function(e){e[e.Failure=0]="Failure",e[e.ImpliedUsageFailure=1]="ImpliedUsageFailure",e[e.ImpliedUsageSuccess=2]="ImpliedUsageSuccess",e[e.Success=3]="Success",e[e.Usage=4]="Usage"}(ie||(ie={})),function(e){e[e.FailureBased=0]="FailureBased",e[e.SuccessBased=1]="SuccessBased"}(oe||(oe={}));var me=function(){var e,t;return[(e={},e[i.a.appReboot]=u,e[i.a.boot]=W,e[i.a.closeTab]=R,e[i.a.createNew]=k,e[i.a.dispose]=x,e[i.a.frameTrust]=D,e[i.a.getAuthToken]=V,e[i.a.getHostKeyValue]=H.a,e[i.a.handleBootState]=J,e[i.a.postWacToken]=B,e[i.a.rename]=L,e[i.a.setOverlayContent]=z.a,e[i.a.setWacFlightValue]=G.a,e[i.a.storeHostKeyValue]=q.a,e[i.a.switchMode]=K,e[i.a.updateBootComplete]=R,e),(t={},t[i.a.boot]={initializeAppContext:Z,buildAppBasePath:Q,buildRemoteTelemetryUrl:Y,onContextReady:ee,buildBootRequestParams:te,beforeContainerBoot:de,buildContainerBootParams:fe,onSuccess:ae,onFailure:he,onTimeout:pe,onException:ve},t[i.a.createNew]={parallelizeStartSessionRequest:be,buildStartSessionRequestParams:te},t)]}},function(e,t,n){"use strict";function i(e,t,n){if(t){var i=window.navigator;if(i&&i.sendBeacon)try{return void i.sendBeacon(t,e)}catch(e){}!function(e,t,n){var i=new XMLHttpRequest;i.readyState!==XMLHttpRequest.UNSENT&&i.readyState!==XMLHttpRequest.DONE||(i.open("POST",t,n),i.send(e))}(e,t,n)}}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var i=function(){function e(){this.xc=[]}return e.prototype.add=function(e){e&&this.xc.push(e)},e.prototype.remove=function(e){if(e){var t=this.xc.indexOf(e);t>-1&&this.xc.splice(t,1)}},e.prototype.removeAll=function(){this.xc=[]},e.prototype.dispatch=function(e,t){this.xc.forEach((function(n){try{n(e)}catch(e){t&&t(e)}}))},e}()},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.blurFocus="blurFocus",e.boot="boot",e.completeCreateNew="completeCreateNew",e.continueAccessibilityLoop="continueAccessibilityLoop",e.createNew="createNew",e.dispose="dispose",e.grabFocus="grabFocus",e.moveToFolder="moveToFolder",e.popState="popState",e.sendChannelId="sendChannelId",e.sendConvId="sendConvId",e.teamsUsersReply="teamsUsersReply",e.teamsUserMentionReply="teamsUserMentionReply",e.backButtonPressed="backButtonPressed",e.getClientUrl="getClientUrl",e.getWebUrl="getWebUrl",e.rename="rename",e.completeSharedFilePicker="completeSharedFilePicker",e.sendAccessToken="sendAccessToken",e.sendAuthToken="sendAuthToken",e.sendCustomAuthConfig="sendCustomAuthConfig",e.sendEmbeddedViewUrl="sendEmbeddedViewUrl",e.sendFrameTrustResult="sendFrameTrustResult",e.sendHWRTelemetry="sendHWRTelemetry",e.sendSessionInfo="sendSessionInfo",e.sendUserAccessAndPermissions="sendUserAccessAndPermissions",e.sendWopiInfo="sendWopiInfo",e.sendDavUrl="sendDavUrl",e.switchMode="switchMode",e.signalShared="signalShared",e.postWacToken="postWacToken"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(1),o=n(2),r=n(15),s=n(9),c=n(39),a=n(7),u=n(19),d=function(){function e(e,t){var n=this;this.Dc=0,this.Vc=function(){try{if(!window||!window.localStorage)return;var e=window.localStorage.getItem(n.Hc);if(!e)return;var t=JSON.parse(e);n.Jc(t)}catch(e){n.zo.ULS.vo(592836768,i.a.$,o.a.Warning,"Failed to get settings from localStorage: "+Object(s.b)(e))}},this.Jc=function(e){return!!n.Bc(e)&&(n.Lc=e,n.zc.dispatch({Hn:n},(function(e){n.zo.ULS.vo(592836769,i.a.$,o.a.Error,"Settings listener error: "+Object(s.b)(e))})),!0)},this.Bc=function(e){if(e&&"object"==typeof e){if(e.hasOwnProperty(r.a.Kn)&&!isNaN(e.timestamp))return!0;n.zo.ULS.vo(592836770,i.a.$,o.a.Error,"Received invalid settings")}return!1},this.Gc=function(){if(n.qc){var e=new XMLHttpRequest;window.location.href.indexOf("wdkestrelrouting=true")>-1?e.setRequestHeader("X-KestrelRouting","true"):window.location.href.indexOf("wdkestrelrouting=false")>-1&&e.setRequestHeader("X-KestrelRouting","false"),e.open("GET",n.qc),e.responseType="json",e.timeout=5e3,e.send(),e.onload=function(){if(200===e.status&&e.response?(n.Kc(e.response),n.Dc=0):(n.zo.ULS.vo(592836771,i.a.$,o.a.Error,"Fetch settings error. Status: ".concat(e.status,", curErrors: ").concat(n.Dc)),n.Dc+=1),!(n.Dc>7)){var t=n.getValue(r.a.qn,3e5);n.Dc>3&&(t+=(n.Dc-3+1)*(t/2)),n.Zc=window.setTimeout(n.Gc,t)}}}},this.Kc=function(e){"requestIdleCallback"in window?(n.Xc&&self.cancelIdleCallback(n.Xc),n.Xc=window.requestIdleCallback((function(){return n.$c(e)}),{timeout:1e4})):window.setTimeout((function(){return n.$c(e)}),0)},this.$c=function(e){if(n.Jc(e)&&window&&window.localStorage){var t=JSON.stringify(e);try{window.localStorage.setItem(n.Hc,t)}catch(e){n.zo.ULS.vo(592836800,i.a.$,o.a.Warning,"Failed to set localStorage: "+Object(s.b)(e))}}},this.Qc=e,this.Hc="Prod"+e+"Settings",this.zo=t,this.zc=new c.a,this.Vc()}return e.prototype.updateEnvironment=function(e){this.Hc=(Object(a.n)(e)?"FF":"Prod")+this.Qc+"Settings",this.Vc()},e.prototype.initializePeriodicFetch=function(e,t){this.Hc=(Object(a.n)(e)?"FF":"Prod")+this.Qc+"Settings",this.Vc(),this.qc=e+a.c+"?app="+this.Qc+"&usid="+t+"&build="+Object(u.a)(),this.Zc||(this.Zc=window.setTimeout(this.Gc,3e4))},e.prototype.getValue=function(e,t){if(this.Lc||this.Vc(),!this.Lc||!this.Lc.hasOwnProperty(e))return t;var n=this.Lc[e],i=typeof t;if(typeof n===i)return n;if("string"==typeof n){if("number"===i)return parseInt(n,10);if("boolean"===i)return"true"===n}return t},e.prototype.addSettingsChangeListener=function(e){this.zc.add(e)},e.prototype.removeSettingsChangeListener=function(e){this.zc.remove(e)},e.prototype.dispose=function(){this.Zc&&window.clearTimeout(this.Zc),this.Xc&&self.cancelIdleCallback(this.Xc),this.Zc=void 0,this.Xc=void 0,this.Lc=void 0,this.zc.removeAll()},e}()},function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"f",(function(){return v})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return w}));var i,o=n(0),r=n(1),s=n(2),c=n(11),a=n(19),u=(n(16),n(9)),d=n(7);function f(e,t){t&&Object.keys(t).forEach((function(n){e[n]=t[n]}))}function l(e,t){try{if(void 0===window.performance)return void t.ULS.vo(595948609,r.a.$,s.a.Info,"Performance not supported");var n=window.performance.getEntriesByType("resource");if(void 0===n||n.length<=0)return void t.ULS.vo(595948610,r.a.$,s.a.Info,"No resources under performance");for(var i=new RegExp(e+"(-boot\\.min|(\\.(app|preview))?\\.boot)(\\.[0-9a-f]{20})?\\.js","i"),o=n.length-1;o>=0;o-=1){var c=n[o],a=c.name.match(i);if(a){var d=JSON.stringify(c);return d=d.replace(new RegExp(c.name,"g"),a[0]),void t.ULS.vo(595948616,r.a.$,s.a.Info,d)}}t.ULS.vo(595948484,r.a.$,s.a.Info,"Could not find JSAPI resource timing entry")}catch(e){t.ULS.vo(595948617,r.a.$,s.a.Info,"Could not trace the resource timing: ".concat(Object(u.b)(e)))}}function h(e){var t,n,i=Object(o.a)(Object(o.a)({},e.host),{sessionId:e.hostSessionId,domain:location?location.host:void 0});delete i.siteId,delete i.webId,delete i.uiHostTabId;var r={};if(e.wdParams){var s=JSON.parse(JSON.stringify(e.wdParams).toLowerCase());["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(e){s[e]&&(r[e]=s[e])}));var c=/^\w{8}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{4}(-|%2d)\w{12}$/i;r.wdprevioussession&&!c.test(r.wdprevioussession)&&delete r.wdprevioussession,r.wdpreviouscorrelation&&!c.test(r.wdpreviouscorrelation)&&delete r.wdpreviouscorrelation}var u=Object(o.a)({},e.rebootOverride);delete u.ackExpected,delete u["ui-language"],delete u.wdUserSession,delete u.rebootMode,delete u.documentUrl;var f=e.wopi;return{accessToken:f?{length:f.accessToken.length,expiry:f.expiry}:"N/A",wacToken:f&&f.wacToken?{length:f.wacToken.length}:void 0,bootParams:e.bootParams,build:Object(a.a)(),host:i,intent:e.intent,jsApiVersion:"v2",rebootOverride:u,region:Object(d.m)(e.appBaseUrl),sessionOrigin:e.hostInitDiagnostics?e.hostInitDiagnostics.entryPoint:void 0,sessionContext:e.sessionContext,throttling:e.throttling,ui:e.ui,viewMode:e.viewMode,meeting:e.meeting?{id:null===(t=e.meeting)||void 0===t?void 0:t.id,isPresenter:null===(n=e.meeting)||void 0===n?void 0:n.isPresenter}:void 0,wdParams:r}}function p(){var e={perfNowSupported:!0,browser:c.a[Object(c.b)()],touchMode:Object(c.f)(),highContrast:Object(c.c)(),windows10x:Object(c.g)()};try{var t=window.navigator,n=t.connection||t.mozConnection||t.webkitConnection;n&&(e.netDownlink=n.downlink,e.netDownlinkMax=n.downlinkMax,e.netEffectiveType=n.effectiveType,e.netRtt=n.rtt,e.netSaveData=n.saveData,e.netType=n.type),e.deviceMemory=t.deviceMemory,e.logicalProcessors=t.hardwareConcurrency}catch(e){}return e}function v(e){try{var t=e.hostInitDiagnostics;e.logger.ULS.vo(558155803,r.a.$,s.a.Info,"HostInitDiagnostics: "+(t?JSON.stringify(t):"N/A")),e.logger.ULS.vo(596444237,r.a.$,s.a.Info,JSON.stringify({session:h(e),client:e.clientDiagnostics}))}catch(t){e.logger.ULS.vo(558155804,r.a.$,s.a.Error,"Failed to log init info: ".concat(Object(u.b)(t)))}}function b(e){return/sharepoint/i.test(e)}function m(e,t){var n=e;return n&&Object.keys(i).includes(n)||(n="Normal"),i[n]>=i[t]}function w(e){var t=window.performance.timing;t&&(e.hostPageNavigationStartTime||(e.hostPageNavigationStartTime=t.navigationStart),e.hostPageFetchStartTime||(e.hostPageFetchStartTime=t.fetchStart),e.hostPageRequestStartTime||(e.hostPageRequestStartTime=t.requestStart),e.hostPageResponseStartTime||(e.hostPageResponseStartTime=t.responseStart),e.hostPageResponseEndTime||(e.hostPageResponseEndTime=t.responseEnd),e.hostPageDomCompleteTime||(e.hostPageDomCompleteTime=t.domComplete));var n=window.performance.navigation;if(n&&(void 0===e.hostPageRedirectCount&&(e.hostPageRedirectCount=n.redirectCount),!e.hostPageNavigationType)){var i="UNKNOWN";switch(n.type){case 0:i="NAVIGATE";break;case 1:i="RELOAD";break;case 2:i="BACK_FORWARD";break;case 255:i="RESERVED"}e.hostPageNavigationType=i}}!function(e){e[e.Unknown=0]="Unknown",e[e.Normal=1]="Normal",e[e.Minor=2]="Minor",e[e.Medium=3]="Medium",e[e.Major=4]="Major",e[e.Critical=5]="Critical"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}));var i=n(1),o=n(2),r=n(9),s=n(21);function c(e,t){return{isFeatureEnabled:function(n){return function(e,t,n){if(t)try{return t(e)}catch(e){n&&n.ULS.vo(594883024,i.a.$,o.a.Error,"IsFeatureEnabled callback error: "+Object(r.b)(e))}}(n,e,t)}}}function a(e,t){var n={};if(Object.keys(s.a).forEach((function(t){var i=e.isFeatureEnabled(s.a[t]);void 0!==i&&(n[s.a[t]]=i?"1":"0")})),t&&t.wdFlights)for(var i=0,o=t.wdFlights.toLowerCase().split(",");i<o.length;i++){var r=o[i];"et-treatment"!==r&&"et-control"!==r||(n[s.a.bo]="et-treatment"===r?"1":"0")}return JSON.stringify(n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(1),o=n(2),r=function(){function e(e,t){this.Yc=function(){return s(e,"OnBeforeUnload",t)},this.ea=function(){return s(e,"OnPageHide",t)},this.ta=function(){return s(e,"VisibilityChange_"+document.visibilityState,t)},this.na=function(){return s(e,"OnUnload",t)},window.addEventListener("beforeunload",this.Yc,{capture:!0,once:!0}),window.addEventListener("pagehide",this.ea,{capture:!0}),window.addEventListener("visibilitychange",this.ta,{capture:!0}),window.addEventListener("unload",this.na,{capture:!0,once:!0})}return e.prototype.dispose=function(){window.removeEventListener("beforeunload",this.Yc,{capture:!0}),window.removeEventListener("pagehide",this.ea,{capture:!0}),window.removeEventListener("visibilitychange",this.ta,{capture:!0}),window.removeEventListener("unload",this.na,{capture:!0})},e}();function s(e,t,n){e.ULS.vo(595957843,i.a.$,o.a.Info,"Page lifecycle: ".concat(t," fired")+(n?", flushing logger":"")),n&&e.ULS.flush()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(0),o=n(1),r=n(2),s=["https://augloop.office.com/v2","api://visio.officeapps.live.com/va/00695ed2-3202-4156-8da1-69f60065e255","394866fc-eedb-4f01-8536-3ff84b16be2a","https://officescripting.microsoft.com","https://officescripting-int.microsoft.com","https://nleditor.osi.office.net/nleditor","e03a13ee-9730-4cae-8525-47559c8cf18a","https://powerquery.microsoft.com","api://app.powerbi.com/00000009-0000-0000-c000-000000000000"],c=function(){function e(e){var t=this;this.ia={},this.oa=[],this.ra=function(e){if(e&&e.origin)try{var n=e.data;if("string"==typeof n&&n.includes("AddinTrustedOrigin")){var i=JSON.parse(n),s=i.AddinTrustId;s&&"AddinTrustedOrigin"===i.MessageId&&(t.zo.ULS.vo(560754784,o.a.$,r.a.Info,"didReceiveMessage addinTrustId ".concat(s)),t.ia[s]=e.origin,t.oa.forEach((function(t){t(s,e.origin)})))}}catch(e){t.zo.ULS.vo(560754785,o.a.$,r.a.Error,"AuthTokenTrustValidator didReceiveMessage failed")}},this.zo=e,window.addEventListener("message",this.ra)}return e.prototype.isResourceTrustedForMessage=function(e){return Object(i.b)(this,void 0,void 0,(function(){var t,n,c,u,d,f,l,h,p=this;return Object(i.d)(this,(function(i){switch(i.label){case 0:return e&&e.Resource?(t=e.Resource,n=e.AddinTrustId,(c=function(e){if(!e)return!1;for(var t=e.toLowerCase(),n=0,i=s;n<i.length;n++){var o=i[n];if(o===t||"".concat(o,"/")===t)return!0}return!1}(t))||!n?[2,c]:this.ia[n]?[2,a(t,this.ia[n])]:(d=new Promise((function(e){u=function(i,o){n===i&&e(a(t,o))},p.oa.push(u)})),f=-1,l=new Promise((function(e){f=window.setTimeout((function(){p.zo.ULS.vo(560754786,o.a.$,r.a.Warning,"isResourceTrustedForMessage - timeout waiting for addinTrustId: ".concat(n)),e(!1)}),2e3)})),[4,Promise.race([d,l])])):[2,!1];case 1:return h=i.sent(),this.oa=this.oa.filter((function(e){return e!==u})),window.clearTimeout(f),[2,h]}}))}))},e.prototype.dispose=function(){this.ia={},this.oa=[],window.removeEventListener("message",this.ra)},e}();function a(e,t){try{if(!e||!t)return!1;for(var n=/[?&#%\\]/,i=0;i<e.length;i+=1){var o=e.charCodeAt(i);if(o<33||o>126)return!1;var r=e.charAt(i);if(n.test(r))return!1}var s=e;"api:"===s.substring(0,"api:".length).toLowerCase()&&(s="".concat("https:").concat(s.substring("api:".length)));var c=new URL(s);return"https:"===c.protocol&&t.toLowerCase()===c.origin.toLowerCase()}catch(e){return!1}}},,,,,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.NotSupported=0]="NotSupported",e[e.SameDocOnly=1]="SameDocOnly",e[e.AnyDoc=2]="AnyDoc",e[e.OtherMode=4]="OtherMode"}(i||(i={}))},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.AccessibilityLoopCompleted="AccessibilityLoopCompleted",e.ActionCompleted="ActionCompleted",e.BrowserEvent="BrowserEvent",e.CAAEMessage="CAAEMessage",e.Close="Close",e.InitEnd="InitEnd",e.Conversation="Conversation",e.CopyAndEdit="CopyAndEdit",e.CreateNewDocument="CreateNewDocument",e.Download="Download",e.Edit="Edit",e.Error="Error",e.FileEmbed="FileEmbed",e.FileProperties="FileProperties",e.FileRenamed="FileRenamed",e.FileVersions="FileVersions",e.FrameStateChanged="FrameStateChanged",e.FrameTrust="FrameTrust",e.GetAccessToken="GetAccessToken",e.GetAuthToken="GetAuthToken",e.GetCustomAuthConfig="GetCustomAuthConfig",e.GetWopiInfoFromUrl="GetWopiInfoFromUrl",e.GetDavUrlFromIds="GetDavUrlFromIds",e.ModeSwitched="ModeSwitched",e.MoveToFolder="MoveToFolder",e.OpenInMobileApp="OpenInMobileApp",e.OpenInBrowser="OpenInBrowser",e.OpenInClient="OpenInClient",e.PageChanged="PageChanged",e.PushState="PushState",e.Reboot="Reboot",e.RedeemForCommenting="RedeemForCommenting",e.RefreshSessionInfo="RefreshSessionInfo",e.ReplyWithChanges="ReplyWithChanges",e.ReportAbuse="ReportAbuse",e.SharedFilePicker="SharedFilePicker",e.SaveStatus="SaveStatus",e.Share="Share",e.ShareForm="ShareForm",e.SignIn="SignIn",e.SplashScreenShown="SplashScreenShown",e.UserAccessAndPermissions="UserAccessAndPermissions",e.UserActivity="UserActivity",e.UserEditActivity="UserEditActivity",e.Workflow="Workflow",e.ZoomChanged="ZoomChanged",e.AcquireOAuthTokenTeams="AcquireOAuthTokenTeams",e.LoadingStatus="LoadingStatus",e.SwitchNotebook="SwitchNotebook",e.FailedBootCheckFileInfo="FailedBootCheckFileInfo",e.GetTeamsUsers="GetTeamsUsers",e.SendTeamsUserMention="SendTeamsUserMention",e.NavigateBackToHost="NavigateBackToHost",e.GetClientUrlComplete="GetClientUrlComplete",e.GetWebUrlComplete="GetWebUrlComplete",e.CopyLinkComplete="CopyLinkComplete",e.SendConversationId="SendConversationId",e.CloseTeamsConversation="CloseTeamsConversation",e.PageLoaded="PageLoaded",e.FrameChanged="FrameChanged"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i=function(){function e(e){var t=this;this.sa=!1,this.ca="",this.ua=[],this.da=function(e){t.sa||(t.sa=!0,t.ca=e?"timeout":"cancelled",t.ua.map((function(e){return e()})),t.ua=[])},this.fa=e,window.setTimeout((function(){return t.da(!0)}),e)}return Object.defineProperty(e.prototype,"isCancelled",{get:function(){return this.sa},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timeoutInMs",{get:function(){return this.fa},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reason",{get:function(){return this.ca},enumerable:!1,configurable:!0}),e.prototype.cancel=function(){this.da(!1)},e.prototype.subscribe=function(e){this.sa?e():this.ua.push(e)},e}();function o(e){return new i(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var i,o=n(29),r=n(1),s=n(2),c=n(56),a=n(64),u=n(43),d=n(41),f=n(83),l=n(40),h=n(8),p=n(17),v=n(52),b=((i={})[l.a.boot]={la:f.a.boot},i[l.a.createNew]={la:f.a.createNew},i[l.a.dispose]={la:f.a.dispose},i[l.a.postWacToken]={la:f.a.postWacToken},i[l.a.rename]={la:f.a.rename},i[l.a.switchMode]={la:f.a.switchMode},i[h.a.$e]={la:f.a.handleBootState},i[h.a.tt]={la:f.a.closeTab},i[h.a.bt]={la:f.a.frameTrust},i[h.a.Ot]={la:f.a.getAuthToken},i[h.a.jt]={la:f.a.getHostKeyValue},i[h.a.Rt]={la:f.a.appReboot},i[h.a.Vn]={la:f.a.setWacFlightValue},i[h.a.Ht]={la:f.a.setOverlayContent},i[h.a.zt]={la:f.a.storeHostKeyValue},i[h.a.Zt]={la:f.a.updateBootComplete},i[l.a.blurFocus]={ha:p.a.Ii},i[l.a.continueAccessibilityLoop]={ha:p.a.Ai},i[l.a.grabFocus]={ha:p.a.Pi},i[l.a.moveToFolder]={ha:p.a.yt},i[l.a.popState]={ha:p.a.Fi},i[l.a.sendChannelId]={ha:p.a.ki},i[l.a.sendConvId]={ha:p.a.Ni},i[l.a.teamsUsersReply]={ha:p.a.Mi},i[l.a.teamsUserMentionReply]={ha:p.a.xi},i[l.a.backButtonPressed]={ha:p.a.Di},i[l.a.getClientUrl]={ha:p.a.Vi},i[l.a.getWebUrl]={ha:p.a.Hi},i[l.a.sendAccessToken]={ha:p.a.Bi},i[l.a.sendAuthToken]={ha:p.a.Li},i[l.a.sendHWRTelemetry]={ha:p.a.ao},i[l.a.sendCustomAuthConfig]={ha:p.a.zi},i[l.a.sendDavUrl]={ha:p.a.$i},i[l.a.sendEmbeddedViewUrl]={ha:p.a.qi},i[l.a.sendFrameTrustResult]={ha:p.a.bt},i[l.a.sendSessionInfo]={ha:p.a.Ki},i[l.a.sendUserAccessAndPermissions]={ha:p.a.Zi},i[l.a.sendWopiInfo]={ha:p.a.Xi},i[l.a.signalShared]={ha:p.a.co},i[l.a.completeSharedFilePicker]={ha:p.a.xt},i[h.a.qe]={pa:v.a.AccessibilityLoopCompleted},i[h.a.Ke]={pa:v.a.ActionCompleted},i[h.a.Ye]={pa:v.a.BrowserEvent},i[h.a.nn]={pa:v.a.CAAEMessage},i[h.a.et]={pa:v.a.Close},i[h.a.nt]={pa:v.a.Conversation},i[h.a.it]={pa:v.a.CopyAndEdit},i[h.a.ot]={pa:v.a.CreateNewDocument},i[h.a.st]={pa:v.a.Download},i[h.a.ct]={pa:v.a.Edit},i[h.a.ut]={pa:v.a.Error},i[h.a.dt]={pa:v.a.FileEmbed},i[h.a.ft]={pa:v.a.FileProperties},i[h.a.lt]={pa:v.a.FileRenamed},i[h.a.pt]={pa:v.a.FileVersions},i[h.a.wt]={pa:v.a.GetAccessToken},i[h.a.It]={pa:v.a.GetDavUrlFromIds},i[h.a.gt]={pa:v.a.GetCustomAuthConfig},i[h.a.St]={pa:v.a.GetWopiInfoFromUrl},i[h.a.vt]={pa:v.a.FrameStateChanged},i[h.a.Tt]={pa:v.a.ModeSwitched},i[h.a.yt]={pa:v.a.MoveToFolder},i[h.a.Ct]={pa:v.a.OpenInMobileApp},i[h.a.At]={pa:v.a.OpenInBrowser},i[h.a.Pt]={pa:v.a.OpenInClient},i[h.a.Et]={pa:v.a.PageChanged},i[h.a.Wt]={pa:v.a.PushState},i[h.a.Ft]={pa:v.a.RedeemForCommenting},i[h.a.kt]={pa:v.a.RefreshSessionInfo},i[h.a.Nt]={pa:v.a.ReplyWithChanges},i[h.a.xt]={pa:v.a.SharedFilePicker},i[h.a.Mt]={pa:v.a.ReportAbuse},i[h.a.Dt]={pa:v.a.SaveStatus},i[h.a.Jt]={pa:v.a.Share},i[h.a.Bt]={pa:v.a.ShareForm},i[h.a.Lt]={pa:v.a.SignIn},i[h.a.$t]={pa:v.a.UserAccessAndPermissions},i[h.a.Qt]={pa:v.a.UserActivity},i[h.a.Yt]={pa:v.a.UserEditActivity},i[h.a.en]={pa:v.a.Workflow},i[h.a.tn]={pa:v.a.ZoomChanged},i[h.a.fn]={pa:v.a.AcquireOAuthTokenTeams},i[h.a._t]={pa:v.a.LoadingStatus},i[h.a.ln]={pa:v.a.SwitchNotebook},i[h.a.hn]={pa:v.a.FailedBootCheckFileInfo},i[h.a.pn]={pa:v.a.GetTeamsUsers},i[h.a.vn]={pa:v.a.SendTeamsUserMention},i[h.a.bn]={pa:v.a.NavigateBackToHost},i[h.a.mn]={pa:v.a.GetClientUrlComplete},i[h.a.wn]={pa:v.a.GetWebUrlComplete},i[h.a.On]={pa:v.a.CopyLinkComplete},i[h.a.gn]={pa:v.a.SendConversationId},i[h.a.jn]={pa:v.a.CloseTeamsConversation},i[h.a.Sn]={pa:v.a.PageLoaded},i[h.a.xn]={pa:v.a.InitEnd},i[h.a.Dn]={pa:v.a.SplashScreenShown},i),m=n(9),w=n(55),O=n(42),g=n(44),j=n(45),S=function(){function e(e,t,n,i,f,l,h){var p,S,I=this;this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.pendingReboot=!1,this.skipWopiValidation=!1,this.skipFileNameCheck=!1,this.appContext={},this.isLoggerFromOwl=!1,this.appUrl="",this.appBaseUrl="",this.appBasePath="",this.remoteTelemetryUrl="",this.va={},this.onMessage=function(e){var t=e.MessageId,n=e.Values||{},i=I.va[t];if(i&&i.length>0)I.ba(t,n);else{var o=b[t];if(o){var c=o.la,a=o.pa;c?(I.logger.ULS.vo(574654543,r.a.$,s.a.Info,"Running flow: ".concat(c)),I.ma[c](t,n,I,I.wa[c]).catch((function(e){I.Oa(c,e)}))):a&&(a===v.a.Share&&(n.sendTimeAsClickTime=e.SendTime),I.raiseEvent(a,n))}}},this.Oa=function(e,t){I.logger.ULS.vo(596459925,r.a.$,s.a.Error,"".concat(e," flow error: ").concat(Object(m.b)(t))),I.remoteTelemetryUrl&&Object(c.c)(I.remoteTelemetryUrl,I.appInfo.name,"flowException")},this.ba=function(e,t){I.logger.ULS.vo(574654544,r.a.$,s.a.Info,"Dispatching action: ".concat(e));for(var n=I.va[e].slice().reverse(),i=n.length-1;i>-1;i-=1)try{n[i](e,t)}catch(t){I.logger.ULS.vo(596444186,r.a.$,s.a.Error,"".concat(e," action handler error: ").concat(Object(m.b)(t)))}return Promise.resolve({completion:"success"})},this.state=o.a.Unknown;var _=Object(w.a)(),T=_[0],y=_[1];this.isLoggerFromOwl=!!n.logger,this.logger=null!==(S=n.logger)&&void 0!==S?S:Object(a.a)(),this.logger.ULS.vo(593506837,r.a.$,s.a.Info,JSON.stringify(y)),this.sessionId=T,this.hostSessionId=n.hostSessionId,this.host=e.host,this.hostName=this.host.uiHostName||this.host.storageHostName,this.user=e.user,this.bootstrapperUrl=e.bootstrapperUrl,this.ui=e.ui||{},this.viewMode=e.viewMode,this.application=i,this.appInfo=t,this.session=f,this.featureManager=Object(u.a)(e.host.capabilities&&e.host.capabilities.isFeatureEnabledCallback,this.logger),this.Hn=new d.a(t.name,this.logger),this.preloader=t.preloader,p=l(this.featureManager),this.ma=p[0],this.wa=p[1],this.ga=h,this.clientDiagnostics=Object(O.c)(),this.pageStateObserver=new g.a(this.logger,!0),this.authTokenTrustValidator=new j.a(this.logger)}return Object.defineProperty(e.prototype,"diagnostics",{get:function(){return{hostInitDiagnostics:this.hostInitDiagnostics,appInitDiagnostics:this.appInitDiagnostics}},enumerable:!1,configurable:!0}),e.prototype.raiseEvent=function(e,t){this.logger.ULS.vo(574654541,r.a.$,s.a.Info,"Raising event: ".concat(e));try{this.ga(e,t)}catch(e){this.logger.ULS.vo(593506838,r.a.$,s.a.Error,"Event handler error: ".concat(Object(m.b)(e)))}},e.prototype.addActionHandler=function(e,t){this.va[e]||(this.va[e]=[]),this.va[e].push(t)},e.prototype.removeActionHandler=function(e,t){var n=this.va[e];if(n&&n.length>0){var i=n.indexOf(t);i>-1&&n.splice(i,1)}},e.prototype.run=function(e,t,n){var i=this;if(this.state===o.a.Disposed&&this.backgroundSession)return this.logger.ULS.vo(525203609,r.a.$,s.a.Info,"Redirecting to background session: ".concat(e)),this.backgroundSession.run(e,t,n);var c=[],a=this.va[e];if(a&&a.length>0)c.push(this.ba(e,t));else{var u=b[e];if(u){var d=u.la,f=u.ha;if(d){this.logger.ULS.vo(574654542,r.a.$,s.a.Info,"Running flow: ".concat(d));var l=this.ma[d](e,t,this,this.wa[d],n).catch((function(e){return i.Oa(d,e),{completion:"failure",errorSource:"jsapi",error:e}}));c.push(l)}else f&&(this.container&&this.container.postMessage(f,t),c.push(Promise.resolve({completion:"success"})))}else c.push(Promise.resolve({completion:"failure"})),this.logger.ULS.vo(593500189,r.a.$,s.a.Warning,"Unhandled command: ".concat(e))}return Promise.race(c)},e.prototype.dispose=function(){if(this.successTime=0,this.failureTime=0,this.timeoutTime=0,this.Hn.dispose(),this.pageStateObserver.dispose(),this.authTokenTrustValidator.dispose(),this.va={},!this.pendingReboot){var e=this.application.sessions,t=e.indexOf(this.session);t>-1&&e.splice(t,1)}},e}(),I=function(){function e(e,t,n,i,r,s){var c=this;!function(e){if(!e)throw new TypeError("SessionInitParams");if(!e.hostSessionId)throw new TypeError("HostSessionId")}(n),this.ja=new S(e,t,n,i,this,s,(function(e,t){return r({type:e,data:t,session:c})})),this.ja.state=o.a.Initialized}return Object.defineProperty(e.prototype,"id",{get:function(){return this.ja.sessionId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"diagnostics",{get:function(){return this.ja.diagnostics},enumerable:!1,configurable:!0}),e.prototype.run=function(e,t,n){return this.ja.run(e,t,n)},e.prototype.boot=function(e,t){return this.ja.run(l.a.boot,e,t)},e.prototype.dispose=function(e){return this.ja.run(l.a.dispose,void 0,e)},e}(),_=n(86),T=n(39),y=n(19),C=function(){function e(e,t,n){var i=this;this.sessions=[],this.containers=[],this.Sa=function(e){i.Ia.dispatch(e)},function(e){if(!e)throw new TypeError("ApplicationInitParams");var t=e.host;if(!t||!t.storageHostName)throw new TypeError("HostInfo");var n=e.user;if(!n||null==n.id)throw new TypeError("UserInfo")}(e),this._a=e,this.Ta=t,this.ya=n,this.Ia=new T.a,Object(y.b)(e.host.owlVersion)}return Object.defineProperty(e.prototype,"name",{get:function(){return this.Ta.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return Object(y.a)()},enumerable:!1,configurable:!0}),e.prototype.addEventListener=function(e){this.Ia.add(e)},e.prototype.removeEventListener=function(e){this.Ia.remove(e)},e.prototype.createContainer=function(e){var t="WacFrame_".concat(this.Ta.name,"_").concat(this.containers.length),n=new _.a(e,t);return this.containers.push(n),n},e.prototype.createSession=function(e){var t=new I(this._a,this.Ta,e,this,this.Sa,this.ya);return this.sessions.push(t),t},e.prototype.dispose=function(e){var t=this,n=this.sessions.map((function(t){return t.dispose(e).catch((function(e){}))}));return Promise.all(n).then((function(e){return t.Ia.removeAll(),t.sessions=[],t.containers=[],{completion:"success"}}))},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(9);function o(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},n=window.crypto||window.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(Object(i.b)(e)))}}t.perfNow=!0;for(var o=0;o<e.length;o+=1){try{var r=Math.floor(100*window.performance.now())%10;(r<0||r>9)&&(r=0);for(var s=0;s<r;s+=1)Math.random()}catch(e){t.exceptions.push("Math.random: ".concat(Object(i.b)(e)))}e[o]=Math.floor(16*Math.random())}return t}(e),n=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=15&e[n];return n+=1,("x"===t?i:3&i|8).toString(16)})),t]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var i,o=n(38),r=n(19);function s(e,t,n,i){void 0===i&&(i=!0);var r={type:t.toString(),payloadJson:JSON.stringify(n)};Object(o.a)(JSON.stringify(r),e,i)}function c(e,t,n){s(e,i.JSAPI_STATE,{application:t,build:Object(r.a)(),state:n})}!function(e){e.JSAPI_STATE="JSAPI_STATE",e.H_V2="H_V2"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return h}));var i,o=n(1),r=n(2),s=n(11),c=n(7),a=n(9);function u(e,t,n,i,o,r,s,c){e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.height="100%",e.style.width="100%";var a=e.ownerDocument,u=a.createElement("iframe");if(u.id=t,u.name=t,u.src="",u.title="Office on the web Frame",u.marginWidth="0",u.marginHeight="0",u.style.top="0",u.style.bottom="0",u.style.left="0",u.style.right="0",u.style.height="100%",u.style.width="100%",u.style.display="block",u.style.position="absolute",u.style.backgroundColor="transparent",u.style.border="none",u.frameBorder="0",u.setAttribute("allowfullscreen","true"),u.setAttribute("allowTransparency","true"),u.setAttribute("allow",n),d(u,s),i&&(e.style.minHeight=i,u.style.minHeight=i),o&&(e.style.minWidth=o,u.style.minWidth=o),c&&u.setAttribute("role","none"),r){var f=a.createElement("div");f.style.top="0",f.style.bottom="0",f.style.left="0",f.style.right="0",f.style.height="100%",f.style.width="100%",f.style.backgroundColor="#393a3d",f.style.backfaceVisibility="hidden",i&&(f.style.minHeight=i),o&&(f.style.minWidth=o),f.appendChild(u),e.appendChild(f)}else e.appendChild(u);return u}function d(e,t){Object(s.b)()===s.a.Safari?e.style.display=t?"none":"block":e.style.visibility=t?"hidden":"visible"}function f(e,t,n,i,o){var r=e.ownerDocument,s=r.createElement("form");for(var c in s.id=n,s.name=n,s.action=i,s.target=t,s.method="POST",o){var a=r.createElement("input");a.type="hidden",a.name=c,a.value=o[c],s.appendChild(a)}return e.appendChild(s),s}function l(e,t,n){Object(c.a)(t,i.Ca,String(n?window.outerHeight:e.offsetHeight)),Object(c.a)(t,i.Aa,String(n?window.outerWidth:e.offsetWidth)),Object(c.a)(t,i.Pa,String(Object(s.f)())),Object(c.a)(t,i.Ea,String(Object(s.c)())),Object(c.a)(t,i.Ua,String(Object(s.g)())),Object(c.a)(t,i.Wa,String(Object(s.h)()))}function h(e){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(t){return e&&e.ULS.vo(591525084,o.a.$,r.a.Info,"Trust check error: ".concat(Object(a.b)(t))),!1}}!function(e){e.Nr="access_token",e.Mr="access_token_ttl",e.xr="wac_token",e.Dr="bundleSrc",e.Vr="bundleStaleness",e.os="DocID",e.Ra="SiteID",e.Fa="WebID",e.ss="ETag",e.$r="feature_status",e.Br="fileExtension",e.Hr="fileGetUrl",e.Jr="customFontCatalogUrl",e.Lr="fileName",e.zr="fileSize",e.Ua="forceSLR",e.Ca="frameHeightPx",e.Aa="frameWidthtPx",e.Ea="highContrast",e.Yr="highDpi",e.Xr="host_diagnostics",e.ts="hostName",e.Qr="huictrls",e.qr="owner_id",e.Kr="sc",e.es="softBlockedBrowser",e.ns="templateUrl",e.Pa="touchMode",e.Gr="user_id",e.ka="hfck",e.Na="hfcv",e.Ma="timeZoneId",e.Wa="darkCssMedia",e.cs="caae",e.us="meetingId",e.ds="meetingTitle",e.fs="meetingType",e.xa="scheduledStartTime",e.ls="scheduledEndTime",e.vs="isPresenter",e.ps="meetingOrganizerId",e.hs="meetingJoinUrl",e.bs="isMeetingTeamsRoom",e.Os="jsapibuild",e.ms="owlver",e.ws="owlro",e.as="caaemode",e.gs="traceparent",e.js="tracestate",e.Zr="supports_zipit"}(i||(i={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n(1),o=n(2),r=n(15),s=n(16),c=function(){function e(e,t,n,i,o){this.Da=0,this.Va=[],this.er=!1,this.er=e,this.Ha=t,this.zo=n,this.Ja=i,this.Ba=o,this.restart()}return e.prototype.restart=function(){var e=this,t=this.Ha.getValue(r.a.Xn,!1);this.Da=Object(s.b)()+(this.Ba?this.Ba:this.Ha.getValue(r.a.Jn,6e5));var n=this.er?3e3:5e3;this.La=window.setInterval((function(){t&&e.zo.ULS.vo(595724178,i.a.$,o.a.Info,"Boot_HeartBeat"),Object(s.b)()>e.Da&&(e.stop(),a(e.zo),e.Ja&&e.Ja())}),this.Ha.getValue(r.a.Zn,n)),this.Va.push(window.setTimeout(a,this.Ha.getValue(r.a.Bn,6e4),this.zo,1)),this.Va.push(window.setTimeout(a,this.Ha.getValue(r.a.Ln,18e4),this.zo,2))},e.prototype.stop=function(){this.Da=0,this.La&&(window.clearInterval(this.La),this.La=void 0),this.Va.forEach((function(e){window.clearTimeout(e)})),this.Va=[]},e}();function a(e,t){e.ULS.vo(594901218,i.a.$,o.a.Warning,"Boot_NotComplete_".concat(t||"Final")),e.ULS.flush()}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var i=n(8),o=n(1),r=n(2);function s(e){localStorage.setItem(e.flightKey,e.flightValue.toString())}var c=function(e,t,n,c,a){return e!==i.a.Vn?Promise.reject("Wrong flow"):new Promise((function(e){var i=t.flightKey,c=t.flightValue;n.logger.ULS.vo(507343134,o.a.Ae,r.a.Info,"setWacFlightValue ".concat(i,": ").concat(c)),s(t),e({completion:"success"})}))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var i=n(8),o=n(17);function r(e){var t=window.navigator;if(t&&t.virtualKeyboard&&void 0!==t.virtualKeyboard.overlaysContent&&window===top)return t.virtualKeyboard.overlaysContent=e}var s=function(e,t,n,s,c){return e!==i.a.Ht?Promise.reject("Wrong flow"):new Promise((function(e){r(t.overlayContent),n.container&&n.container.postMessage(o.a.to,void 0),e({completion:"success"})}))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var i=n(8),o=n(17),r=n(1),s=n(2),c=n(18);function a(e){return Object(c.b)(e.hostKey)}var u=function(e,t,n,c,u){return e!==i.a.jt?Promise.reject("Wrong flow"):new Promise((function(e){var i=t.hostKey;n.logger.ULS.vo(574408915,r.a.$,s.a.Info,"getHostKeyValue ".concat(i));var c=a(t);n.container&&c&&n.container.postMessage(o.a.Ui,{hostKey:i,hostValue:c}),e({completion:"success"})}))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a}));var i=n(8),o=n(1),r=n(2),s=n(18);function c(e){Object(s.d)(e.hostKey,e.hostValue,s.c)}var a=function(e,t,n,s,a){return e!==i.a.zt?Promise.reject("Wrong flow"):new Promise((function(e){var i=t.hostKey,s=t.hostValue;n.logger.ULS.vo(574408914,o.a.$,r.a.Info,"storeHostKeyValue ".concat(i,": ").concat(s)),c(t),e({completion:"success"})}))}},function(e,t,n){"use strict";function i(e,t,n,i){var o=new XMLHttpRequest;for(var r in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{i&&i(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",e),n)o.setRequestHeader(r,n[r]);o.send(t)}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return l})),function(e){e[e.Trace=0]="Trace",e[e.Assert=1]="Assert"}(i||(i={}));var o=n(2);var r,s=n(38),c=n(16),a=n(19),u=function(){function e(e){var t=this;this.za=3e4,this.Ga=30,this.qa=0,this.Ka=[],this.Za=Object(c.a)(),this.Xa=[],this.$a="",this.Qa=0,this.flushOnClose=function(){t.Ya(!1,!1)},this.flush=function(){t.eu()},this.flushAndSetNewEndpoint=function(e,n){var i,o=t.tu(e);o.localeCompare(null!==(i=t.nu)&&void 0!==i?i:"",void 0,{sensitivity:"accent"})&&(t.Xa.push((function(){t.nu=o,n&&n()})),t.Ya(!0,!0))},this.tu=function(e){return e+"?usid="+t.$a+"&officeserverversion="+Object(a.a)()},this.eu=function(){window.setTimeout((function(){return t.Ya(!0,!0)}),0)},this.Ya=function(e,n){var i,o,r,a,u,d,f,l=Object(c.b)();if(window.clearTimeout(t.gr),t.nu){if(t.Ka.length>0){t.qa+=1;var h=(i=t.Ka.splice(0,e?t.Ga:t.Ka.length),o=t.$a,r=t.qa,a=t.Za,u=[],d=i.map((function(e){return function(e,t,n){var i={};if(i.G=e.tag,i.T=e.timestamp-t,i.M=e.message,i.C=e.category,e.correlationId){var o=n.findIndex((function(t){return t===e.correlationId}));o<0&&(o=n.push(e.correlationId)-1),i.I=o}var r=1e3*e.type+e.level;return i.D=r,i}(e,a,u)})),f=function(e,t,n,i,o){var r={};return r.T=e,r.L=t,r.S=n,r.I=i,o&&o.length>0&&(r.W=o),r.V=1,r}(a,d,o,r,u),JSON.stringify(f));Object(s.a)(h,t.nu,n),t.Za=Object(c.a)()}0===t.Ka.length&&t.Xa.length>0&&(t.Xa.forEach((function(e){"requestIdleCallback"in window?window.requestIdleCallback(e):window.setTimeout(e,0)})),t.Xa=[]),e&&(t.gr=window.setTimeout((function(){t.eu()}),t.Ka.length>t.Ga||t.Xa.length>0?1e3:t.za)),t.Qa+=Object(c.b)()-l}},e&&this.configure(e)}return e.prototype.getTimeSpentLogging=function(){return this.Qa},e.prototype.addLoggingTime=function(e){this.Qa+=e},e.prototype.configure=function(e){var t=Object(c.b)();if(e.uploadCadenceInMs&&(this.za=e.uploadCadenceInMs),e.uploadTriggerSize&&(this.Ga=e.uploadTriggerSize),e.sessionId&&(this.$a=e.sessionId),e.remoteUlsEndpoint){if(!e.sessionId&&this.nu)throw new Error("Remote ULS endpoint is already set");this.nu=this.tu(e.remoteUlsEndpoint),this.Za=Object(c.a)(),this.eu()}this.Qa+=Object(c.b)()-t},e.prototype.handleTrace=function(e){var t=Object(c.b)();e.message.length>3072&&(e.message=e.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.Ka.push(e),(this.Ka.length>this.Ga||e.level===o.a.Error)&&this.eu(),this.Qa+=Object(c.b)()-t},e.prototype.getUserSessionId=function(){return this.$a},e}(),d=[],f=n(15);function l(e){var t=new u(e);function n(e,n,o,r){var s=Object(c.b)();if(!function(e){return 1===d[e]}(e)){var a={timestamp:Object(c.a)(),category:n,tag:e,level:o,type:i.Trace,message:r,correlationId:""};t.addLoggingTime(Object(c.b)()-s),t.handleTrace(a)}}return{ULS:{vo:function(e,t,i,o){n(e,t,i,o)},shipAssertTag:function(e,t,i,r){i&&n(e,t,o.a.Error,r)},debugAssertTag:function(e,t,n,i){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:t.flush,flushOnClose:t.flushOnClose,setCorrelationId:function(){}},configure:function(e){t.configure(e)},settingsChangeHandler:function(e){var n,i;n=e.Hn.getValue(f.a.Gn,""),i=e.Hn.getValue(f.a.zn,""),r&&i===r||(d=[],r=i,n&&n.split(",").forEach((function(e){var t=parseInt(e,10);t&&(d[t]=1)}))),t.configure({uploadCadenceInMs:e.Hn.getValue(f.a.$n,6e4)});var o=e.Hn.getValue(f.a.ei,"").toString();""!==o&&t.flushAndSetNewEndpoint(o)},getTimeSpentLogging:function(){return t.getTimeSpentLogging()},getUserSessionId:function(){return t.getUserSessionId()},flushAndSetNewEndpoint:function(e,n){t.flushAndSetNewEndpoint(e,n)}}}},,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"Application",(function(){return p})),n.d(t,"Viewer",(function(){return v})),n.d(t,"createApplication",(function(){return b}));var i=n(30),o=n(54),r=n(31),s=n(28),c=n(36),a=n(37),u=n(3);n.d(t,"ApplicationEvents",(function(){return u.a}));var d=n(51);n.d(t,"DocRebootSupportMode",(function(){return d.a}));var f=n(40);n.d(t,"CommandIds",(function(){return f.a}));var l=n(52);n.d(t,"EventIds",(function(){return l.a}));var h=n(53);n.d(t,"createCancellationToken",(function(){return h.b}));var p=new r.a(s.b,{forceSingleStepBoot:!1,preconnector:Object(i.a)(!0)}),v=new r.a(c.a,{forceSingleStepBoot:!0,useViewerInitializer:!0,preconnector:Object(i.a)(!0)}),b=function(e){var t={name:"Word",preconnector:Object(i.a)(!0)};return new o.a(e,t,a.a)}},,,function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e.appReboot="appReboot",e.boot="boot",e.closeTab="closeTab",e.createNew="createNew",e.dispose="dispose",e.frameTrust="frameTrust",e.getAuthToken="getAuthToken",e.getHostKeyValue="getHostKeyValue",e.handleBootState="handleBootState",e.postWacToken="postWacToken",e.rename="rename",e.setOverlayContent="setOverlayContent",e.storeHostKeyValue="storeHostKeyValue",e.switchMode="switchMode",e.updateBootComplete="updateBootComplete",e.setWacFlightValue="setWacFlightValue"}(i||(i={}))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(1),o=n(2),r=n(8),s=n(7),c=n(9),a=n(18),u=n(16),d=n(17),f=function(){function e(e,t,n,u){var f,l,h=this;this.$o="",this.Qo="",this.er=!1,this.tr=!1,this.Yo=!1,this.nr=!1,this.iu=function(e){var t,n=!1,a=!0,u="",f=!1;if(h.ou&&h.ou.contentWindow&&(n=!0,a=e.source===h.ou.contentWindow),e.origin&&!(f=(u=Object(s.h)(e.origin,2).toLowerCase())===h.Qo)&&h.cr&&(u=Object(s.h)(e.origin).toLowerCase(),f=h.cr.includes(u)),!h.er&&(!h.tr||f&&a)||h.zo.ULS.vo(593232850,i.a.$,o.a.Info,"Window: available["+n+"] valid["+a+"]; Origin: valid["+f+"] expected["+h.Qo+"] actual["+u+"]"),f&&(!h.Yo||a)){var l;try{l=JSON.parse(e.data)}catch(e){return void h.zo.ULS.vo(593232851,i.a.$,o.a.Info,"Failed to parse event data: ".concat(Object(c.b)(e)))}var p=l.MessageId;if(p){if(h.zo.ULS.vo(593232854,i.a.$,o.a.Info,"Received message: ".concat(p,", correlation: ").concat(l.CorrelationId)),p!==r.a.Qe&&p!==r.a._t||h.setTargetOrigin(e.origin),l.Values&&l.Values.ackExpected&&h.postMessage(d.a.gi,void 0,l.CorrelationId),h.nr&&p===r.a.kn)return window._pageTimings=null!==(t=window._pageTimings)&&void 0!==t?t:{},void(window._pageTimings[l.Values.name]=l.Values.time);if(h.ru)try{h.ru(l)}catch(e){h.zo.ULS.vo(594556386,i.a.$,o.a.Error,"Message handler error: ".concat(Object(c.b)(e)))}else h.zo.ULS.vo(591933923,i.a.$,o.a.Error,"No message handler")}else(h.er||h.tr)&&h.zo.ULS.vo(593232853,i.a.$,o.a.Info,"Missing message id")}},this.zo=t,this.setTargetOrigin(e),this.cr=u,n&&this.setMessageHandler(n),this.nr=!!(null===(l=null===(f=window.location)||void 0===f?void 0:f.search)||void 0===l?void 0:l.match(/wdpa=1/gi))||"1"===Object(a.b)("EnableMetricLogging"),window.addEventListener("message",this.iu,!1)}return e.prototype.setTargetOrigin=function(e){var t=Object(s.i)(e).toLowerCase();this.$o&&this.$o!==t&&this.zo.ULS.vo(593232847,i.a.$,o.a.Warning,"Updating origin: [".concat(Object(s.g)(this.$o),"]->[").concat(Object(s.g)(t),"]")),this.$o=t,this.Qo=Object(s.h)(t,2),this.er=Object(s.n)(t),this.tr=Object(s.o)(t)},e.prototype.setTargetFrame=function(e,t){this.ou=e,this.Yo=!!t},e.prototype.setMessageHandler=function(e){this.ru=e},e.prototype.removeMessageHandler=function(){this.ru=void 0},e.prototype.postMessage=function(e,t,n){if(this.ou&&this.ou.contentWindow){this.zo.ULS.vo(593232849,i.a.$,o.a.Info,"Sending message: "+e);var r={MessageId:e,SendTime:Object(u.a)(),CorrelationId:n,Values:t};this.ou.contentWindow.postMessage(JSON.stringify(r),this.$o)}else this.zo.ULS.vo(593232848,i.a.$,o.a.Error,"Missing target to send message: "+e)},e.prototype.dispose=function(){window.removeEventListener("message",this.iu,!1),this.ru=void 0},e}(),l=n(57),h=function(){function e(e,t){!function(e){if(!e||!e.appendChild)throw TypeError("Container")}(e),this.su=e,this.cu=t,this.au=t+"_Form",this.uu=Object(l.f)()}return Object.defineProperty(e.prototype,"element",{get:function(){return this.su},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frameId",{get:function(){return this.cu},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formId",{get:function(){return this.au},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTopFrameTrusted",{get:function(){return this.uu},enumerable:!1,configurable:!0}),e.prototype.boot=function(e,t,n,r){var s=this;this.zo=n,this.du=new f(e,n,this.ru,r.additionalReceivingDomainList);var a=r.useAdditionalDiv,u=r.permissionsPolicy;this.fu&&!a?(this.fu.setAttribute("allow",u),this.zo.ULS.vo(588793045,i.a.$,o.a.Info,"Wac frame reused")):(this.fu=Object(l.d)(this.su,this.cu,u,r.minHeight,r.minWidth,a,r.isInvisible,r.setNoneRole),this.zo.ULS.vo(588793046,i.a.$,o.a.Info,"Wac frame created")),this.du.setTargetFrame(this.fu,r.enforceSameWindow),a&&(this.lu=this.fu.parentElement),r.useFrameFixForTeams&&n.ULS.vo(509143245,i.a.$,o.a.Info,"Frame fix enabled for teams uiHost"),Object(l.b)(this.fu,t,r.useFrameFixForTeams),this.hu=Object(l.c)(this.su,this.cu,this.au,e,t);try{this.hu.submit()}catch(e){this.zo.ULS.vo(507909977,i.a.$,o.a.Warning,"WAC frame failed to submit, will retry. Error: ".concat(Object(c.b)(e))),new Promise((function(e){window.setTimeout(e,10)})).then((function(){s.hu.submit()})).catch((function(e){throw s.zo.ULS.vo(507909976,i.a.$,o.a.Error,"WAC frame failed to submit on retry. Error: ".concat(Object(c.b)(e))),e}))}},e.prototype.setVisibility=function(e){this.fu&&Object(l.e)(this.fu,e)},e.prototype.setMessageHandler=function(e){this.ru=e,this.du&&this.du.setMessageHandler(e)},e.prototype.setWrapperPostMessage=function(e){this.pu=e},e.prototype.removeMessageHandler=function(){this.ru=void 0,this.du&&this.du.removeMessageHandler()},e.prototype.postMessage=function(e,t){this.pu?this.pu(e,t):this.du&&this.du.postMessage(e,t)},e.prototype.dispose=function(e,t){var n=this;return new Promise((function(i){if(n.hu&&(n.su.removeChild(n.hu),n.hu=void 0),n.du&&(n.du.dispose(),n.du=void 0,n.ru=void 0),n.pu&&(n.pu=void 0),n.zo=void 0,!n.fu||!n.lu&&e)i();else{var o=function(){n.lu?(n.lu.removeChild(n.fu),n.su.removeChild(n.lu)):n.su.removeChild(n.fu),n.fu=void 0,n.lu=void 0,i()};t?o():(n.fu.src="about:blank",window.setTimeout(o,0))}}))},e}()}]);
//# sourceMappingURL=word.boot.js.map